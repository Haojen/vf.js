{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./packages/player/src/core/actionTask/core/BaseTask.ts","webpack:///./packages/player/src/utils/VFUtil.ts","webpack:///./packages/player/src/core/transition/filters/AbstractFilter.ts","webpack:///./packages/player/src/core/actionTask/core/ContainerTask.ts","webpack:///./packages/player/src/core/animation/Frame.ts","webpack:///./packages/player/src/core/VariableManager.ts","webpack:///./packages/player/src/core/model/IVFData.ts","webpack:///./packages/player/src/core/actionTask/CallFunctionTask.ts","webpack:///./packages/player/src/core/BaseInfo.ts","webpack:///./packages/player/src/Player.ts","webpack:///./packages/player/src/display/VFComponent.ts","webpack:///./packages/player/src/core/actionTask/AddListenerTask.ts","webpack:///./packages/player/src/core/actionTask/core/QueueTask.ts","webpack:///./packages/player/src/core/actionTask/SetPropertyTask.ts","webpack:///./packages/player/src/core/actionTask/ExpressTask.ts","webpack:///./packages/player/src/core/actionTask/IfTask.ts","webpack:///./packages/player/src/core/actionTask/core/ActionListUtils.ts","webpack:///./packages/player/src/core/actionTask/PlayAnimationTask.ts","webpack:///./packages/player/src/core/actionTask/PlaySoundTask.ts","webpack:///./packages/player/src/core/actionTask/PrintTask.ts","webpack:///./packages/player/src/core/actionTask/ForTask.ts","webpack:///./packages/player/src/core/actionTask/CallProtoFunctionTask.ts","webpack:///./packages/player/src/core/actionTask/AddListenerCallTask.ts","webpack:///./packages/player/src/core/actionTask/RemoveListenerTask.ts","webpack:///./packages/player/src/core/actionTask/EmitEventTask.ts","webpack:///./packages/player/src/core/animation/EventTimeline.ts","webpack:///./packages/player/src/core/animation/Timeline.ts","webpack:///./packages/assets/Assets.ts","webpack:///./packages/player/src/utils/ImportScript.ts","webpack:///./packages/player/src/utils/getUrl.ts","webpack:///./packages/player/src/display/plugs/Plug.ts","webpack:///./packages/player/src/utils/readFileSync.ts","webpack:///./packages/player/src/index.ts","webpack:///./packages/player/src/display/VFStage.ts","webpack:///./packages/player/src/core/transition/Tranistion.ts","webpack:///./packages/player/src/core/transition/filters/CrossFadeFilter.ts","webpack:///./packages/player/src/core/transition/filters/CircleFadeFilter.ts","webpack:///./packages/player/src/core/transition/filters/CrossZoomFilter.ts","webpack:///./packages/player/src/core/transition/filters/DoomScreenFilter.ts","webpack:///./packages/player/src/core/transition/filters/HeartWipeFilter.ts","webpack:///./packages/player/src/core/transition/filters/LinearBlurFilter.ts","webpack:///./packages/player/src/core/transition/filters/PageCurlFilter.ts","webpack:///./packages/player/src/core/transition/filters/ToTearFilter.ts","webpack:///./packages/player/src/core/transition/filters/WindFilter.ts","webpack:///./packages/player/src/core/transition/filters/PageFlipLeftFilter.ts","webpack:///./packages/player/src/core/transition/filters/PageFlipRightFilter.ts","webpack:///./packages/player/src/core/transition/trans/FadeoutTran.ts","webpack:///./packages/player/src/sound/SoundManager.ts","webpack:///./assets/empty-audio.mp3","webpack:///./packages/player/src/core/RES.ts","webpack:///./packages/player/src/display/VFScene.ts","webpack:///./packages/player/src/core/actionTask/ActionList.ts","webpack:///./packages/player/src/core/actionTask/DefineFunctionTask.ts","webpack:///./packages/player/src/core/actionTask/FunctionTask.ts","webpack:///./packages/player/src/utils/Trace.ts","webpack:///./packages/player/src/core/actionTask/JumpToNextSceneTask.ts","webpack:///./packages/player/src/core/actionTask/JumpToPrevSceneTask.ts","webpack:///./packages/player/src/core/actionTask/JumpToSceneTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayPopTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayPushTask.ts","webpack:///./packages/player/src/core/actionTask/ArraySpliceTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayRandomTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayInitTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayConcatTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayShiftTask.ts","webpack:///./packages/player/src/core/actionTask/ArrayUnshiftTask.ts","webpack:///./packages/player/src/core/actionTask/DefineVariableTask.ts","webpack:///./packages/player/src/core/actionTask/PauseSoundTask.ts","webpack:///./packages/player/src/core/actionTask/ResumeSoundTask.ts","webpack:///./packages/player/src/core/actionTask/BreakTask.ts","webpack:///./packages/player/src/core/actionTask/WaitTask.ts","webpack:///./packages/player/src/core/actionTask/SetTimeoutTask.ts","webpack:///./packages/player/src/core/actionTask/SetIntervalTask.ts","webpack:///./packages/player/src/core/actionTask/EnterFrameTask.ts","webpack:///./packages/player/src/core/animation/Animation.ts","webpack:///./packages/player/src/core/animation/AnimationClip.ts","webpack:///./packages/player/src/core/animation/NumberFrame.ts","webpack:///./packages/player/src/core/animation/BooleanFrame.ts","webpack:///./packages/player/src/core/animation/StringFrame.ts","webpack:///./packages/player/src/core/animation/ColorFrame.ts","webpack:///./packages/player/src/core/animation/EventFrame.ts","webpack:///./packages/player/src/utils/getFileExtension.ts","webpack:///./packages/player/src/display/plugs/PlugIndex.ts","webpack:///./packages/player/src/display/plugs/BoardDrawPlug.ts","webpack:///./packages/player/src/display/plugs/SliderEditorPlug.ts","webpack:///./packages/player/src/utils/CalculatePlayerSize.ts","webpack:///./packages/player/src/core/Config.ts","webpack:///./packages/player/src/event/StateEvent.ts","webpack:///./node_modules/eventemitter3/index.js","webpack:///./packages/player/src/core/I18N.ts","webpack:///./packages/player/src/core/System.ts","webpack:///./packages/player/src/error/ErrorDisplay.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","TaskEvent","_isRunning","_isPaused","_isCompleted","_isFailed","_asynchronous","run","this","stop","pause","resume","break","emit","EVENT_BREAK","complete","EVENT_COMPLETE","fail","type","data","EVENT_FAIL","vf","utils","EventEmitter","BaseTask","getParentByTargetComponent","component","targets","com","length","childId","shift","VFComponent","getChildById","getComponentOrChild","targetData","concat","vfStage","curCom","curScene","getCurScene","rootComID","len","uiChildren","id","undefined","getRootByTargetComponent","getCanvasColor","app","container","x","y","texture","RenderTexture","width","height","scaleMode","SCALE_MODES","LINEAR","renderer","render","extract","pixels","Array","isArray","ExpressItemType","VARIABLE","PROPERTY","ARRAY_VALUE","PARAM_VALUE","OBJECT_VALUE","COMPONENT","variableManager","comp","getExpressItemValue","gui","DisplayObject","pos","Math","pow","cos","PI","sin","sqrt","exp","prevTexture","Transition","w","view","h","console","log","obj","toString","isNaN","str","rest","args","replace","RegExp","vertexSrc","fragmentSrc","uniforms","AbstractFilter","crossFadeUniforms","apply","filterManager","input","output","maskMatrix","Matrix","calculateNormalizedScreenSpaceMatrix","filterMatrix","resolution","settings","RESOLUTION","applyFilter","setPreviousTexture","previousTexture","progress","min","max","applyTranisition","target","filters","dispose","TEMP_MATRIX","Filter","loopTask","QueueTask","on","onBreak","addSubTask","task","addTask","asynchronous","off","ContainerTask","time","curve","getValue","Frame","variableConfig","variableMap","runFunctionId","functionMap","shuffle","arr","randomIndex","floor","random","itemAtIndex","clear","getFunctionId","getFunctionTask","setFunctionTask","addVariableConfig","variableData","normalConfig","normalizeVariableConfig","v","varV","createIVariableData","addVariableToGlobal","globalId","VariableManager","GLOBAL_ID","deepCopy","variables","addVariableToComponent","libId","addVariableDataToComponent","varId","compId","addVariable","addVariableDataToGlobal","targetId","variable2","globalVarConfig","globalVarMap","getGlobalVariable","getVariable","hasCode","varData","getVariableByData","expressItem","varComponent","getTargetComponent","hashCode","caculateExpress","express","stackOut","stackOperate","CONST","STSTEN","RANDOM","ARRAY_LEN","ARRAY_FUNCTION","push","OPERATION","pop","operateStr","curPriority","OPERATE_PRIORITY","emitError","topOperate","topOperatePriority","caculateExpressValue","result","varItem","join","curDate","Date","systemValue","SystemValueType","TIME","getTime","YEAR","getFullYear","MONTH","getMonth","DAY","getDay","DATE","getDate","randomValue","round","targetArr0","targetArr","targetProperty","targetComponent","arrItem","arrItem1","index","indexVar","isNumber","arrItem2","targetArray","pushTarget","unshiftTarget","unshift","concatTarget","startValue","splice","deleteCount","addValue","objItem","stackExpress","expres","expItem0","expItem1","resultItem","caculateOneExpress","result0","result1","targetProp","prop","JSON","stringify","parse","isIVariableData","isObject","isBoolean","isString","code","params","level","Error","systemEvent","compontent","funName","runId","paramIds","_component","funId","paramValues","param","paramValue","paramId","fun","injectParams","FUNCTION_RUN_COMPLETE","onRunComplete","runWithId","stopWithId","breakWithId","CallFunctionTask","PROPERTY_CHANGE","PROPERTY_SET_ERROR","event","fn","context","addListener","removeListener","once","createRandomId","specialChars","createRandomIdentifier","randomIntegerWithinRange","getSessionId","date","String","getMilliseconds","propertyChange","propertyName","getClassName","propertyError","setValue","ttl","groupCollapsed","groupEnd","radix","characters","results","exec","constructor","options","onError","err","onInit","onReady","onSceneCreate","onMessage","msg","onDispose","Player","system","getInstance","config","_errpanel","initSystemEvent","_readyState","src","play","reload","loadData","stage","reset","message","runtimeLog","switchToNextScene","transition","switchToPrevScene","switchToSceneId","sceneId","removeView","readyState","removeAllListeners","destroy","children","baseTexture","sendMessage","onStatus","start","_data","skipHello","backgroundColor","parseInt","bgcolor","transparent","wmode","antialias","Application","style","zIndex","appendChild","VFStage","addChild","i18n","load","cdns","default","responseType","catch","conversion","version","split","conversionPath","substr","lastIndexOf","e","VFConversion","analysis","conversionData","onSystemCheck","evt","onConfigCheck","setMessage","getText","maxHashCode","childrenMap","pauseData","interactabled","_vfStage","child","animation","getPauseData","actionList","gotoPlay","frame","times","playDefaultAnimation","gotoStop","getVariableValue","variable","setVariableValue","addChildAt","item","cid","removeChild","UIObject","runAction","onRemoved","emitAddToChildBefore","emitAddToChild","emitRemoveToChild","emitRemoveToChildBefore","releaseAll","Container","_loopComplete","eventName","global","onLoopComplete","onTriger","onSystemTriger","AddListenerTask","_tasks","_currentTask","_curTaskIndex","isRunning","_nextTask","clearEvent","Number","MAX_VALUE","indexOf","prevTask","onOneTaskComplete","onOneTaskFail","onOneTaskBreak","SetPropertyTask","ExpressTask","conditions","conditionsRun","addCondition","condition","addElse","elseRun","curRun","findTask","onTaskComplete","onTaskBreak","IfTask","injectParamsToQueueTask","queue","tasks","injectParamsToTask","modifyParamValue","j","jlen","conditionRun","modiyExpressItemParamValue","PlayAnimationTask","PlaySoundTask","soundId","PrintTask","ForTask","AddListenerCallTask","RemoveListenerTask","EmitEventTask","CallProtoFunctionTask","paramIndex","getTimes","trackId","soundManager","soundIdVar","playSound","debug","_totalTimes","_curTimes","_paramId","_paramIds","getforin","addParams","runFor","removeParams","paramI","forin","runTarget","funParam","callfunData","callfunctionTask","callfun","eventData","emitEventData","getEmitEventData","nextFrameIndex","skipEmit","_curValue","skipNextEmit","lastTime","nextFrame","getProgress","cur","updateCurFrame","frames","updateCurValue","curTime","findEvents","startIndex","turnBack","addEvent","Timeline","EventTimeline","loop","totalTime","_defaultValue","_globalTime","_lastGlobalTime","_lastFrame","_curFrame","_nextFrame","_times","tick","lineProgress","curveProgress","curveType","getCurveProgress","extensionName","url","moduleName","loadCompleteCallBack","require","_namespace","errorUrls","Promise","resolve","reject","errorLoadCount","loadScript","document","createElement","async","getUrl","addEventListener","loadComplete","loadError","body","removeEvent","thisObj","parentNode","removeEventListener","getCdnUrl","cdn","getAssetType","getFileExtension","image","media","baseUrl","className","parent","status","onLoad","plugs","set","release","onRelease","delete","Plug","geXHRtData","xhr","response","responseText","text","parseJson","error","responseURL","listener","forEach","onload","onerror","onreadystatechange","readFileSync","errorCount","XMLHttpRequest","method","timeout","currentTarget","abort","open","send","player","STAGE_STATUS","fps","Map","NONE","Utils","res","RES","SoundManager","tween","Tween","Plugs","PlugIndex","inputLog","ticker","add","onGUITickerUpdata","LOADING","loadAssetCompleted","loadProgress","PAUSED","PLAYING","createScene","remove","curSceneId","nextScene","createNextScene","switchToScene","prevScene","createPrevScene","scene","transitionData","renderTexture","applyTransition","READY","createPlugs","PlugsClass","createFirstScene","deltaTime","TickerShared","update","elapsedMS","Stage","getTransition","setObject","Event","to","duration","scaleX","scaleY","webGLVersion","FadeoutTran","CrossFadeFilter","CircleFadeFilter","CrossZoomFilter","DoomScreenFilter","HeartWipeFilter","LinearBlurFilter","PageCurlFilter","ToTearFilter","WindFilter","PageFlipLeftFilter","PageFlipRightFilter","linearBlurUniforms","strength","linearblurUniforms","padding","CLEAR_MODES","NO","setProgress","barWidth","amplitude","noise","frequency","intensity","size","_progress","prevSprite","alpha","Sprite","from","trackMap","vfvars","useNativeAudio","track","sound","isPlaying","paused","pauseSound","assetId","asset","getAsset","nativeEmit","weixinEmit","getSoundAsset","trackMedia","resumeSound","audio","createSoundTrackMedia","soundTrackMedia","autoPlay","audioM","emitExt","isWeixin","ua","navigator","userAgent","toLowerCase","test","testAutoPlay","autoplay","then","typeTag","useNative","pixiResources","vfActions","_resources","_sceneMap","_loadNum","_assetFails","setSourcePath","getImageAsset","setDisplayObjectPath","getDisplayObject","resource","destroyTextureCache","clearTextureCache","_loader","addResource","assets","loadAllScript","loadAllAsset","initGlobalVariable","scenes","curId","nextSceneData","getNextSceneData","getPrevSceneData","sceneData","getSceneData","vfScene","VFScene","createComponent","addComponent","spritesheet","childIds","creategui","assetData","assetsItem","cls","isFilter","list","loadResources","action","defAction","variableType","componentData","components","createCustomComponent","ui","getGuiClass","libName","customData","vfComponent","props","childData","childComponentData","applyDisplayComponentProperty","ActionList","actions","getVfsByComponentId","animations","Animation","display","filterKey","filterKeys","curkey","Loader","loader","urls","progressId","completeId","errorId","onProgress","onComplete","loader2","resources","loadFailResources","detach","loaderResource","assetFail","count","extension","execute","removeComponent","_actionList","parseData","parseAST","addGlobalVariable","parseAction","parseAddToStageBefore","parseAddToStage","parseSetProperty","parseClick","parseExpress","parseIf","parseDefineFunction","parseCallFunction","parsePrint","parseAddEventListener","parseRemoveEventListener","parseEmitEvent","parsePlaySound","parsePauseSound","parseResumeSound","parsePlayAnimation","parseJumpToNextScene","parseJumpToPrevScene","parseJumpToScene","ArrayInitTask","ArrayPopTask","ArrayPushTask","ArraySpliceTask","ArrayRandomTask","ArrayConcatTask","ArrayShiftTask","ArrayUnshiftTask","parseAddEventListenerCall","DefineVariableTask","gotoData0","gotoPlayData","gotoData1","gotoStopData","parseFor","BreakTask","WaitTask","parseSetTimeout","parseSetInterval","parseEnterFrame","parseSubTask","taskData","subTask","addlistenerAction","ifPart","conditionQue","funTask","FunctionTask","DefineFunctionTask","PauseSoundTask","ResumeSoundTask","JumpToNextSceneTask","JumpToPrevSceneTask","JumpToSceneTask","SetTimeoutTask","SetIntervalTask","EnterFrameTask","subComponent","callTargets","callId","title","concatItem","concatArr","timeoutHandler","Scheduler","setTimeout","lastTimes","loopTaskComplete","intervalComplete","_timeout","runOnce","checkComplete","restart","animationMap","animationConfig","curAnimationClips","realFPS","curPlayTime","startTime","passedTime","minDeltaT","deltaT","curAnimatinName","curAnimatinDuration","curAnimatinDurationTime","curAnimationTimes","curAnimationTotalTime","_curPlayTimes","ceil","addAnimationClip","clip","frameIndex","setCurTime","Ticker","shared","warn","skipNextEvent","dt","curPlayTimes","parseAnimation","anim","ac","parseAnimationClip","componentId","animName","subAnimation","animClip","AnimationClip","timelines","timelineData","timeline","parseTimeline","parseFrames","NumberFrame","BooleanFrame","StringFrame","ColorFrame","EventFrame","frameClass","frameData","_curTime","globalTime","applyTimeline","targetDisplay","curValue","rotation","visible","enabled","filterBlur","events","rgbData","changeColor2RGB","rgbValue","resultArr","changeRGB2Color","color","rgb","ext","slashIndex","substring","queryStart","hashStart","BoardDrawPlug","SliderEditorPlug","followLine","FollowLine","role","Interaction","ComponentEvent","COMPLETE","onReceipt","offAll","val","setData","isErasing","lineColor","element","getElementById","canvasContainer","getElementsByClassName","dom","MutationObserver","WebKitMutationObserver","MozMutationObserver","observer","mutations","mutation","node","currentCursorMode","plugins","interaction","dataset","cursor","observe","attributes","attributeFilter","defaultCursor","setTargetElement","cursorStyles","disconnect","canvas","appParentDivName","canvasScaleFactor","isWebGl","parentWidth","innerWidth","parentHeight","innerHeight","offsetWidth","offsetHeight","boundingClientWidth","boundingClientHeight","stageSize","screenWidth","screenHeight","contentWidth","contentHeight","displayWidth","displayHeight","stageWidth","stageHeight","calculateStageSize","transformOrigin","top","left","scalex","scaley","canvasScaleX","canvasScaleY","identity","scale","rotate","position","transform","b","tx","ty","_vfvars","_plugs","_container","_id","_src","_play","Boolean","_loop","_menu","menu","_scaleMode","_align","align","_wmode","_bgcolor","_frameRate","frameRate","_width","_height","_orientation","orientation","_maxTouches","maxTouches","_showFPS","showFPS","_showLog","showLog","_conversionData","_debug","_logAdvancedTrace","logAdvancedTrace","wx","_language","language","_i18n","info","_observers","_target","errorCode","has","prefix","Events","EE","emitter","TypeError","_events","_eventsCount","__proto__","eventNames","names","slice","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","a1","a2","a3","a4","a5","arguments","prefixed","lang","toLocaleLowerCase","stringFormat","readFileSyncExt","lock","_pageUrl","_pageReferrer","_resolution","_ua","_device","_os","_browser","ConstructorLock","SyntaxError","initialize","System","instance","decodeURIComponent","pageUrl","pageReferrer","device","os","browser","screen","checkDevice","checkBrowser","location","href","referrer","match","platform","_config","_showCode","_errPanel","background","_span","verticalAlign","textAlign","onChange","hasChildNodes","childNodes","_text","createTextNode","close"],"mappings":"CAAA,SAA2CA,EAAMC,GAChD,GAAsB,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,SACb,GAAqB,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,OACP,CACJ,IAAIK,EAAIL,IACR,IAAI,IAAIM,KAAKD,GAAuB,iBAAZJ,QAAuBA,QAAUF,GAAMO,GAAKD,EAAEC,IAPxE,CASGC,QAAQ,WACX,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUT,QAGnC,IAAIC,EAASM,EAAiBE,GAAY,CACzCJ,EAAGI,EACHC,GAAG,EACHV,QAAS,IAUV,OANAW,EAAQF,GAAUG,KAAKX,EAAOD,QAASC,EAAQA,EAAOD,QAASQ,GAG/DP,EAAOS,GAAI,EAGJT,EAAOD,QA0Df,OArDAQ,EAAoBK,EAAIF,EAGxBH,EAAoBM,EAAIP,EAGxBC,EAAoBO,EAAI,SAASf,EAASgB,EAAMC,GAC3CT,EAAoBU,EAAElB,EAASgB,IAClCG,OAAOC,eAAepB,EAASgB,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhET,EAAoBe,EAAI,SAASvB,GACX,oBAAXwB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAepB,EAASwB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAepB,EAAS,aAAc,CAAE0B,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBO,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAASjC,GAChC,IAAIgB,EAAShB,GAAUA,EAAO4B,WAC7B,WAAwB,OAAO5B,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAO,EAAoBO,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRT,EAAoBU,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG5B,EAAoB+B,EAAI,GAIjB/B,EAAoBA,EAAoBgC,EAAI,I,qCClFzCC,E,2XAAZ,SAAYA,GACR,kCACA,0BACA,4BACA,gDAJJ,CAAYA,EAAA,EAAAA,YAAA,EAAAA,UAAS,KAMrB,kBAQI,mBACI,cAAO,K,OAPD,EAAAC,YAAsB,EACtB,EAAAC,WAAqB,EACrB,EAAAC,cAAwB,EACxB,EAAAC,WAAqB,EACrB,EAAAC,eAAyB,E,EA0DvC,OAhE8B,OAYnB,YAAAC,IAAP,WACIC,KAAKN,YAAa,EAClBM,KAAKJ,cAAe,EACpBI,KAAKH,WAAY,GAGd,YAAAI,KAAP,WACID,KAAKN,YAAa,GAGf,YAAAQ,MAAP,WACIF,KAAKL,WAAY,GAGd,YAAAQ,OAAP,WACIH,KAAKL,WAAY,GAEd,YAAAS,MAAP,WACIJ,KAAKN,YAAa,EAClBM,KAAKK,KAAKZ,EAAUa,cAGjB,YAAAC,SAAP,WACIP,KAAKN,YAAa,EAClBM,KAAKJ,cAAe,EACpBI,KAAKK,KAAKZ,EAAUe,iBAGjB,YAAAC,KAAP,SAAYC,EAAcC,QAAA,IAAAA,MAAA,MACtBX,KAAKN,YAAa,EAClBM,KAAKH,WAAY,EACjBG,KAAKK,KAAKZ,EAAUmB,WAAYD,IAGpC,sBAAW,2BAAY,C,IAAvB,WACI,OAAOX,KAAKF,e,gCAGhB,sBAAW,wBAAS,C,IAApB,WACI,OAAOE,KAAKN,Y,gCAGhB,sBAAW,0BAAW,C,IAAtB,WACI,OAAOM,KAAKJ,c,gCAEhB,sBAAW,uBAAQ,C,IAAnB,WACI,OAAOI,KAAKH,W,gCAGhB,sBAAW,uBAAQ,C,IAAnB,WACI,OAAOG,KAAKL,W,gCAEpB,EAhEA,CAA8BkB,GAAGC,MAAMC,cAA1B,EAAAC,Y,8ECNb,WACA,QAcA,QAKA,SAASC,EAA2BC,EAAwBC,GAExD,IADA,IAAIC,EAA4BF,EACzBC,EAAQE,OAAS,GAAG,CACvB,IAAMC,EAAUH,EAAQI,QACxB,KAAIH,GAAOA,aAAe,EAAAI,aAAeF,GAGrC,OAFAF,EAAOA,EAAoBK,aAAaH,GAKhD,OAAOF,EAuDX,SAAgBM,EAAoBR,EACAS,GAChC,GAAKA,EAEE,IAAIA,EAAWN,QAAU,EAC5B,OAAOH,EAEP,IAAMC,EAAUQ,EAAWC,SAC3B,MAAmB,OAAfT,EAAQ,GAvDpB,SAAkCD,EAAwBC,GAEtD,GADAA,EAAQI,QACHL,EAAUW,QAAf,CAGA,IACIC,EADEC,EAAWb,EAAUW,QAAQG,cAE7BC,EAAYd,EAAQI,QAC1B,GAAKQ,EAAL,CAGA,IAAK,IAAI1E,EAAI,EAAG6E,EAAMH,EAASI,WAAWd,OAAQhE,EAAI6E,MAClDJ,EAASC,EAASI,WAAW9E,cACP,EAAAmE,aAAeM,EAAOM,KAAOH,GAFI5E,KAM3D,QAAegF,IAAXP,EAGJ,OAAOb,EAA2Ba,EAAQX,KAoC3BmB,CAAyBpB,EAAWC,GAEpCF,EAA2BC,EAAWC,GARjD,OAAOD,EAmMf,SAAgBqB,EAAeC,EAAqBC,EAChDC,EAAWC,GAOX,IAAMC,EAAU/B,GAAGgC,cAAc9D,OAAO,CACpC+D,MAAO,EACPC,OAAQ,EACRC,UAAWnC,GAAGoC,YAAYC,SAI9B,OAFAV,EAAIW,SAASC,OAAOX,EAAWG,GAChBJ,EAAIW,SAASE,QAAQC,OAAOV,GA3O/C,8BAAmC1B,EACAS,GAE/B,GAAIT,GAAaqC,MAAMC,QAAQ7B,IAAeA,EAAWN,OAAS,IAC1DM,EAAW,KAAO,EAAA8B,gBAAgBC,UAClC/B,EAAW,KAAO,EAAA8B,gBAAgBE,UAClChC,EAAW,KAAO,EAAA8B,gBAAgBG,aAClCjC,EAAW,KAAO,EAAA8B,gBAAgBI,aAClClC,EAAW,KAAO,EAAA8B,gBAAgBK,cAClCnC,EAAW,KAAO,EAAA8B,gBAAgBM,WAAW,CAC7C,IAAMlC,EAAUX,EAAUW,QAC1B,GAAIA,GAAWA,EAAQmC,gBAAiB,CACpC,IACMC,EADkBpC,EAAQmC,gBACHE,oBAAoBhD,EAAWS,GAC5D,GAAIsC,GAAQA,aAAgBpD,GAAGsD,IAAIC,cAC/B,OAAOH,GAKvB,OAAOvC,EAAoBR,EAAWS,IAG1C,wBAgBA,4BAAiCjB,EAAiB2D,GAC9C,IAAI7E,EAAY,EAChB,OAAQkB,GACJ,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO2D,EACX,KAAK,EACD,QAASC,KAAKC,IAAKF,EAAM,EAAI,GAAK,GACtC,KAAK,EACD,OAAOC,KAAKC,IAAIF,EAAK,GACzB,KAAK,EAED,OAAKA,GAAO,IAAO,EACR,GAAMC,KAAKC,IAAIF,EAAK,IAEvB,KAAQA,GAAO,GAAKA,EAAM,GACtC,KAAK,EACD,OAAOC,KAAKC,IAAIF,EAAK,GACzB,KAAK,EACD,OAAQC,KAAKC,IAAKF,EAAM,EAAI,GAAK,EACrC,KAAK,EAED,OAAKA,GAAO,IAAO,EACR,GAAMC,KAAKC,IAAIF,EAAK,GAExB,IAAOC,KAAKC,IAAKF,EAAM,EAAI,GAAK,GAC3C,KAAK,EACD,OAAOC,KAAKC,IAAIF,EAAK,GACzB,KAAK,EACD,QAASC,KAAKC,IAAKF,EAAM,EAAI,GAAK,GACtC,KAAK,GAED,OAAKA,GAAO,IAAO,EACR,GAAMC,KAAKC,IAAIF,EAAK,IAEvB,KAAQA,GAAO,GAAKC,KAAKC,IAAIF,EAAK,GAAK,GACnD,KAAK,GACD,OAAOC,KAAKC,IAAIF,EAAK,GACzB,KAAK,GACD,OAAQC,KAAKC,IAAKF,EAAM,EAAI,GAAK,EACrC,KAAK,GAED,OAAKA,GAAO,IAAO,EACR,GAAMC,KAAKC,IAAIF,EAAK,GAExB,IAAOC,KAAKC,IAAKF,EAAM,EAAI,GAAK,GAC3C,KAAK,GACD,OAAwC,EAAhCC,KAAKE,IAAIH,GAAOC,KAAKG,GAAK,IACtC,KAAK,GACD,OAAOH,KAAKI,IAAIL,GAAOC,KAAKG,GAAK,IACrC,KAAK,GACD,OAAS,IAAMH,KAAKE,IAAIF,KAAKG,GAAKJ,GAAO,GAC7C,KAAK,GACD,OAAgB,IAARA,EAAa,EAAIC,KAAKC,IAAI,EAAG,IAAMF,EAAM,IACrD,KAAK,GACD,OAAgB,IAARA,EAAa,EAA8B,EAAzBC,KAAKC,IAAI,GAAI,GAAKF,GAChD,KAAK,GACD,OAAY,IAARA,EACO,EAEC,IAARA,EACO,GAGNA,GAAO,IAAO,EACR,GAAMC,KAAKC,IAAI,EAAG,IAAMF,EAAM,IAElC,IAAmC,EAA3BC,KAAKC,IAAI,GAAI,KAAOF,IACvC,KAAK,GACD,QAASC,KAAKK,KAAK,EAAKN,EAAMA,GAAQ,GAC1C,KAAK,GACD,OAAOC,KAAKK,KAAK,EAAIL,KAAKC,IAAKF,EAAM,EAAI,IAC7C,KAAK,GAED,OAAKA,GAAO,IAAO,GACP,IAAOC,KAAKK,KAAK,EAAIN,EAAMA,GAAO,GAEvC,IAAOC,KAAKK,KAAK,GAAKN,GAAO,GAAKA,GAAO,GACpD,KAAK,GACD,OAAI,EAAS,EAAI,KACL,OAASA,EAAMA,EAChBA,EAAO,EAAI,KACV,QAAUA,GAAQ,IAAM,MAASA,EAAM,IACxCA,EAAO,IAAM,KACZ,QAAUA,GAAQ,KAAO,MAASA,EAAM,MAExC,QAAUA,GAAQ,MAAQ,MAASA,EAAM,QAEzD,KAAK,GAED,OAAO,EAAQA,KADf7E,EAAI,SACuB,GAAK6E,EAAM7E,GAC1C,KAAK,GAED,OAAQ6E,GAAY,GAAKA,KADzB7E,EAAI,SACiC,GAAK6E,EAAM7E,GAAK,EACzD,KAAK,GAGD,OAFAA,EAAI,SAEC6E,GAAO,IAAO,EACDA,EAAMA,IAAyB,GAAhB7E,GAAK,QAAgB6E,EAAM7E,GAAjD,GAEJ,KAAQ6E,GAAO,GAAKA,IAAyB,GAAhB7E,GAAK,QAAgB6E,EAAM7E,GAAK,GACxE,KAAK,GACL,KAAK,GACD,OAAQ,EAAI8E,KAAKC,IAAI,GAAI,EAAIF,GAAOC,KAAKI,KAAW,EAANL,EAAU,IAAM,EAAIC,KAAKG,IAAM,GAAK,EACtF,KAAK,GACD,OAAQ,EAAIH,KAAKC,IAAI,GAAI,EAAIF,GAAOC,KAAKI,KAAW,EAANL,EAAU,IAAM,EAAIC,KAAKG,IAAM,GAAK,EACtF,KAAK,GAGD,OAFAjF,EAAI,SAEK6E,GAAO,IAAO,EAAYA,EAAMA,IAAyB,GAAhB7E,GAAK,QAAgB6E,EAAM7E,GAAjD,GACxB,KAAQ6E,GAAO,GAAKA,IAAyB,GAAhB7E,GAAK,QAAgB6E,EAAM7E,GAAK,GACrE,KAAK,GAED,OAAO6E,EAAMA,KADb7E,EAAI,SACqB,GAAK6E,EAAM7E,GACxC,KAAK,GAED,OAAQ6E,GAAO,GAAKA,KADpB7E,EAAI,SAC4B,GAAK6E,EAAM7E,GAAK,EACpD,KAAK,GACD,OAAI6E,EAAO,EAAI,KACH,OAASA,EAAMA,EAChBA,EAAO,EAAI,KACV,QAAUA,GAAQ,IAAM,MAASA,EAAM,IACxCA,EAAO,IAAM,KACZ,QAAUA,GAAQ,KAAO,MAASA,EAAM,MAExC,QAAUA,GAAQ,MAAQ,MAASA,EAAM,QAEzD,KAAK,GACD,OAAIA,EAAO,EAAI,KACH,OAASA,EAAMA,EAChBA,EAAO,EAAI,KACX,GAAK,QAAUA,GAAQ,IAAM,MAASA,EAAM,KAC5CA,EAAO,IAAM,KACb,GAAK,QAAUA,GAAQ,KAAO,MAASA,EAAM,OAE7C,GAAK,QAAUA,GAAQ,MAAQ,MAASA,EAAM,SAE7D,KAAK,GAED,OAAKA,GAAO,IAAO,EACR,GAAMC,KAAKC,IAAIF,EAAK,IAEvB,KAAQA,GAAO,GAAKC,KAAKC,IAAIF,EAAK,GAAK,GACnD,KAAK,GACD,OAAOC,KAAKC,IAAIF,EAAK,GACzB,KAAK,GACD,OAAOC,KAAKC,IAAIF,EAAK,KACzB,KAAK,GACD,OAASC,KAAKE,IAAIH,EAAMC,KAAKG,IAAM,EAAK,GAC5C,KAAK,GACD,OAAO,EAAIJ,EACf,KAAK,GACD,OAASC,KAAKE,IAAIH,EAAMC,KAAKG,IAAM,EAAIJ,IAAQ,EAAK,GACxD,KAAK,GACD,OAAO,EAAKC,KAAKE,IAAU,IAANH,EAAYC,KAAKG,IAAMH,KAAKM,IAAW,GAANP,GAC1D,QACI,OAAOA,IAInB,2BAAgCxC,EAAkBgD,EAA+BlE,GAC1D,IAAI,EAAAmE,WAAWjD,EAASgD,EAAalE,GAC7CZ,OAGf,yBAA8ByC,EAC1BC,EACAK,EACAC,GAEA,IAAMgC,EAAYjC,GAASN,EAAIwC,KAAKlC,MAC9BmC,EAAYlC,GAAUP,EAAIwC,KAAKjC,OAE/BH,EAAU/B,GAAGgC,cAAc9D,OAAO,CACpC+D,MAAOiC,EACPhC,OAAQkC,EACRjC,UAAWnC,GAAGoC,YAAYC,SAG9B,OADAV,EAAIW,SAASC,OAAOX,EAAWG,GACxBA,GAEX,mBAkBA,sBAA2BJ,EAAqBC,GAC5C,IAAM3E,EAAIyE,EAAeC,EAAKC,GAE9ByC,QAAQC,IAAI,sBAAuB,KAAMrH,EAAE,GAAK,IAAK,KAAMA,EAAE,GAAI,KAAMA,EAAE,GAAIA,IAGjF,oBAAyBsH,GACrB,MAA+C,oBAAxCjH,OAAOkB,UAAUgG,SAASzH,KAAKwH,IAE1C,oBAAyBA,GACrB,MAAsB,iBAARA,IAAqBE,MAAMF,IAE7C,oBAAyBA,GACrB,MAAsB,iBAARA,GAElB,qBAA0BA,GACtB,MAAsB,kBAARA,GAElB,mBAAwBA,GACpB,OAAO7B,MAAMC,QAAQ4B,IASzB,wBAA6BG,G,IAAa,wDACtC,GAAW,MAAPA,EAAa,MAAO,GACxB,QAAYlD,IAATmD,EAAoB,OAAOD,EAE9B,IACIE,EADAvD,EAAcsD,EAAKnE,OAEZ,GAAPa,GAAYqB,MAAMC,QAAQgC,EAAK,IAE/BtD,GADAuD,EAAOD,EAAK,IACDnE,OAGXoE,EAAOD,EAGX,IAAK,IAAInI,EAAI,EAAGA,EAAI6E,EAAK7E,IACrBkI,EAAMA,EAAIG,QAAQ,IAAIC,OAAO,OAAStI,EAAI,MAAO,KAAMoI,EAAKpI,IAGhE,OAAOkI,I,8ZCjVX,kBAoCQ,WAAYK,EAAoBC,EAAsBC,G,OAClD,YACIF,GAAeG,EAAeH,UAC9BC,EACAC,GAAeC,EAAeC,oBACjC,KAkCT,OA3EgC,OA4CrB,YAAAC,MAAP,SAAaC,EAAwCC,EAAyBC,GAC1E,IAAMC,EAAa,IAAIxF,GAAGyF,OACzBJ,EAAsBK,qCAAqCF,GAC5DrG,KAAK8F,SAASU,aAAeH,EAC7BrG,KAAK8F,SAASW,WAAa5F,GAAG6F,SAASC,WAEvCT,EAAcU,YAAY5G,KAAMmG,EAAOC,OAAQ/D,IAG5C,YAAAwE,mBAAP,SAA0BnI,GACtBsB,KAAK8F,SAASgB,gBAAkBpI,GAGpC,sBAAW,uBAAQ,C,IAKnB,WACI,OAAOsB,KAAK8F,SAASiB,U,IANzB,SAAoBrI,GAChBA,EAAQ4F,KAAK0C,IAAI,EAAGtI,GACpBA,EAAQ4F,KAAK2C,IAAI,EAAGvI,GACpBsB,KAAK8F,SAASiB,SAAWrI,G,gCAMtB,YAAAwI,iBAAP,SAAwBC,GACpBnH,KAAKmH,OAASA,EACdnH,KAAKmH,OAAOC,QAAU,CAACpH,OAEpB,YAAAqH,QAAP,WACQrH,KAAKmH,SACLnH,KAAKmH,OAAOC,QAAU,KAtEP,EAAAxB,UAAoB,6gCAyBnB,EAAAI,kBAAoB,CACxCQ,aAAc3F,GAAGyF,OAAOgB,YACxBb,WAAY5F,GAAG6F,SAASC,WACxBG,gBAAkB,KAClBC,SAAU,GA4ClB,EA3EJ,CAAoClG,GAAG0G,QAA1B,EAAAxB,kB,8ZCVb,WACA,QAEA,cAIQ,mBACI,cAAO,K,OACP,EAAKyB,SAAW,IAAI,EAAAC,UACpB,EAAKD,SAASE,GAAG,EAAAjI,UAAUa,YAAa,EAAKqH,QAAS,G,EA6C9D,OApD+B,OAUpB,YAAAC,WAAP,SAAkBC,GACV7H,KAAKwH,WACLxH,KAAKwH,SAASM,QAAQD,GAClB7H,KAAKwH,SAASO,eACd/H,KAAKF,eAAgB,KAK1B,YAAAG,KAAP,WACI,YAAMA,KAAI,WACND,KAAKwH,WACLxH,KAAKwH,SAASQ,IAAI,EAAAvI,UAAUa,aAC5BN,KAAKwH,SAASvH,SAIf,YAAAG,MAAP,WACI,YAAMA,MAAK,WACPJ,KAAKwH,WACLxH,KAAKwH,SAASQ,IAAI,EAAAvI,UAAUa,aAC5BN,KAAKwH,SAASpH,UAIf,YAAAF,MAAP,WACI,YAAMA,MAAK,WACPF,KAAKwH,UACLxH,KAAKwH,SAAStH,SAIf,YAAAC,OAAP,WACI,YAAMA,OAAM,WACRH,KAAKwH,UACLxH,KAAKwH,SAASrH,UAIZ,YAAAwH,QAAV,SAAkBhH,GACdX,KAAKI,SAEb,EApDJ,CAAmC,EAAAY,UAAtB,EAAAiH,iB,8ECFT,iBAMI,aAJO,KAAAC,MAAgB,EAChB,KAAAC,MAAmB,GACnB,KAAAzJ,MAAY,KASvB,OAHW,YAAA0J,SAAP,SAAgBrB,EAAkBrI,GAC9B,OAAO,MAEf,EAbA,GAAa,EAAA2J,S,8ECDjB,WAIA,OAGA,aA8BQ,aANO,KAAAC,eAAiE,GACjE,KAAAC,YAA8D,GAE7D,KAAAC,cAAwB,EACxB,KAAAC,YAA8C,GAsqB1D,OA3pBW,YAAAC,QAAP,SAAeC,GACX,IAAK,IAAItL,EAAIsL,EAAItH,OAAS,EAAGhE,GAAK,EAAGA,IAAK,CACtC,IAAMuL,EAActE,KAAKuE,MAAMvE,KAAKwE,UAAYzL,EAAI,IAC9C0L,EAAcJ,EAAIC,GACxBD,EAAIC,GAAeD,EAAItL,GACvBsL,EAAItL,GAAK0L,IAGV,YAAAC,MAAP,WACIhJ,KAAKuI,YAAc,GACnBvI,KAAKyI,YAAc,IAEhB,YAAAQ,cAAP,WACI,QAASjJ,KAAKwI,eAGX,YAAAU,gBAAP,SAAuBlL,GACnB,OAAOgC,KAAKyI,YAAYzK,IAGrB,YAAAmL,gBAAP,SAAuBnL,EAAc6J,GACjC7H,KAAKyI,YAAYzK,GAAQ6J,GAGtB,YAAAuB,kBAAP,SAAyBhH,EAAYiH,GACjC,IAAKrJ,KAAKsI,eAAelG,GAAK,CAC1B,IAAMkH,EAAetJ,KAAKuJ,wBAAwBF,GAClDrJ,KAAKsI,eAAelG,GAAMkH,IAI3B,YAAAC,wBAAP,SAA+BF,GAC3B,IAAK,IAAMjH,KAAMiH,EACb,GAAIA,EAAa/J,eAAe8C,GAAK,CACjC,IAAMoH,EAAIH,EAAajH,GACjBqH,EAAOzJ,KAAK0J,oBAAoBtH,EAAIoH,GAC1CH,EAAajH,GAAMqH,EAG3B,OAAOJ,GAGJ,YAAAM,oBAAP,SAA2BN,GACvB,IAAMO,EAAmBC,EAAgBC,UAGzC,GAFA9J,KAAKuI,YAAYqB,GAAY5J,KAAK+J,SAASV,GAEvCrJ,KAAKsI,eAAesB,GAAW,CAC/B,IAAMI,EAAYhK,KAAKsI,eAAesB,GACtC5J,KAAKuI,YAAYqB,GAAY5J,KAAK+J,SAASC,QAG3C,GADAhK,KAAKoJ,kBAAkBQ,EAAUP,GAC7BrJ,KAAKsI,eAAesB,GAAW,CACzBI,EAAYhK,KAAKsI,eAAesB,GACtC5J,KAAKuI,YAAYqB,GAAY5J,KAAK+J,SAASC,KAKhD,YAAAC,uBAAP,SAA8B/I,GAC1B,IAAMgJ,EAAQhJ,EAAUgJ,MACxB,GAAIA,GACIlK,KAAKsI,eAAe4B,EAAM7E,YAAa,CACvC,IAAM2E,EAAYhK,KAAKsI,eAAe4B,EAAM7E,YAC5CrF,KAAKuI,YAAYrH,EAAUkB,GAAGiD,YAAcrF,KAAK+J,SAASC,KAK/D,YAAAG,2BAAP,SAAkCjJ,EAAwBkJ,EAAe1J,EAAoBC,GACzF,IAAMuJ,EAAQhJ,EAAUgJ,MAClBG,EAASnJ,EAAUkB,GACzBpC,KAAKsK,YAAYJ,EAAOG,EAAQD,EAAO1J,EAAMC,IAE1C,YAAA4J,wBAAP,SAA+BH,EAAe1J,EAAoBC,GAC9DX,KAAKsK,YAAYT,EAAgBC,UAAWD,EAAgBC,UAAWM,EAAO1J,EAAMC,IAGjF,YAAA2J,YAAP,SAAmBJ,EAAeM,EAAkBJ,EAAe1J,EAAoBC,GACnF,IAAM0I,EAA8B,CAChCjH,GAAIgI,EACJ1J,KAAI,EACJhC,MAAOiC,GAEL8J,EAA2B,CAC7BrI,GAAIgI,EACJ1J,KAAI,EACJhC,MAAOiC,GAGP+J,EAAkB1K,KAAKsI,eAAe4B,GACrCQ,IACDA,EAAkB,GAClB1K,KAAKsI,eAAe4B,GAASQ,GAEjCA,EAAgBN,GAASf,EAEzB,IAAIsB,EAAe3K,KAAKuI,YAAYiC,GAC/BG,IACDA,EAAe,GACf3K,KAAKuI,YAAYiC,GAAYG,GAEjCA,EAAaP,GAASK,GAGnB,YAAAG,kBAAP,SAAyBxI,GACrB,OAAOpC,KAAK6K,YAAYhB,EAAgBC,UAAW1H,IAEhD,YAAAyI,YAAP,SAAmBC,EAAiB1I,GAChC,IAAM2I,EAAyC/K,KAAKuI,YAAYuC,GAChE,GAAIC,GAAWA,EAAQ3I,GACnB,OAAO2I,EAAQ3I,IAGhB,YAAA4I,kBAAP,SAAyB9J,EAAwB+J,GAC7C,GAAIA,EAAY,KAAO,EAAAxH,gBAAgBI,YACnC,OAAO7D,KAAK6K,YAAYhB,EAAgBC,UAAWmB,EAAY,IAEnE,IAAMC,EAA6B,EAAAC,mBAAmBjK,EAAW+J,EAAY,IACvEG,EAAWF,EAAeA,EAAa9I,GAAGiD,WAAawE,EAAgBC,UAE7E,OADgB9J,KAAK6K,YAAYO,EAAUH,EAAY,KAIpD,YAAAI,gBAAP,SAAuBnK,EAAwBoK,GAG3C,IAFA,IAAMC,EAAwB,GACxBC,EAA4B,GACzBnO,EAAY,EAAG6E,EAAcoJ,EAAQjK,OAAQhE,EAAI6E,EAAK7E,IAAK,CAChE,IAAM4N,EAAcK,EAAQjO,GAC5B,OAAQ4N,EAAY,IAChB,KAAK,EAAAxH,gBAAgBgI,MACrB,KAAK,EAAAhI,gBAAgBC,SACrB,KAAK,EAAAD,gBAAgBiI,OACrB,KAAK,EAAAjI,gBAAgBkI,OACrB,KAAK,EAAAlI,gBAAgBE,SACrB,KAAK,EAAAF,gBAAgBmI,UACrB,KAAK,EAAAnI,gBAAgBG,YACrB,KAAK,EAAAH,gBAAgBK,aACrB,KAAK,EAAAL,gBAAgBI,YACrB,KAAK,EAAAJ,gBAAgBoI,eACrB,KAAK,EAAApI,gBAAgBM,UACjBwH,EAASO,KAAKb,GACd,MACJ,KAAK,EAAAxH,gBAAgBsI,UACjB,OAAQd,EAAY,IAChB,IAAK,IACDO,EAAaM,KAAKb,GAClB,MACJ,IAAK,IAED,IADA,IAAIzB,EAAIgC,EAAaQ,MACbxC,GAAc,MAATA,EAAE,IACX+B,EAASO,KAAKtC,GACdA,EAAIgC,EAAaQ,MAErB,MACJ,QACI,IAAMC,EAAahB,EAAY,GACzBiB,EAAerC,EAAgBsC,iBAAyBF,GAC9D,IAAKC,EAGD,OADAlM,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+K,GAAa,WAC1C,EAEP,GAAIT,EAAanK,OAAS,EAAG,CACzB,IAAIgL,EAAab,EAAaA,EAAanK,OAAS,GAChDiL,EACCzC,EAAgBsC,iBAAyBE,EAAW,IACzD,GAAIH,EAAcI,EACdd,EAAaM,KAAKb,OACf,CACH,KAAOiB,EAAcI,IACjBf,EAASO,KAAKO,GACdb,EAAaQ,MACTR,EAAanK,OAAS,IACtBgL,EAAab,EAAaA,EAAanK,OAAS,GAChDiL,EACKzC,EAAgBsC,iBAAyBE,EAAW,IAKjEb,EAAaM,KAAKb,SAGtBO,EAAaM,KAAKb,KAU9C,GAAIO,EAAanK,OAAS,EACtB,KAAOmK,EAAanK,OAAS,GAAG,EACtB4K,EAAaT,EAAaQ,QAE5BT,EAASO,KAAKG,GAK1B,OADcjM,KAAKuM,qBAAqBrL,EAAWqK,IAGhD,YAAArH,oBAAP,SAA2BhD,EAAwB+J,GAC/C,IAAIuB,EACJ,OAAQvB,EAAY,IAChB,KAAK,EAAAxH,gBAAgBgI,MACjBe,EAAUvB,EAAY,GACtB,MACJ,KAAK,EAAAxH,gBAAgBC,SAEjB,IAAM+I,EAAUzM,KAAKgL,kBAAkB9J,EAAW+J,GAC9CwB,EACAD,EAAUC,EAAa,MAEvBzM,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+J,EAAYyB,KAAK,MAAO,WAIhE,MACJ,KAAK,EAAAjJ,gBAAgBiI,OACjB,IAAMiB,EAAU,IAAIC,KAChBC,EAAc,EAClB,OAAQ5B,EAAY,IAChB,KAAK,EAAA6B,gBAAgBC,KACjBF,EAAcF,EAAQK,UACtB,MACJ,KAAK,EAAAF,gBAAgBG,KACjBJ,EAAcF,EAAQO,cACtB,MACJ,KAAK,EAAAJ,gBAAgBK,MACjBN,EAAcF,EAAQS,WACtB,MACJ,KAAK,EAAAN,gBAAgBO,IACjBR,EAAcF,EAAQW,SACtB,MACJ,KAAK,EAAAR,gBAAgBS,KACjBV,EAAcF,EAAQa,UAK9BhB,EAAS,EACT,MACJ,KAAK,EAAA/I,gBAAgBkI,OACjB,IAAI8B,EAAc,EAClB,GAAIxC,EAAY5J,QAAU,EAAG,CACzB,IAAM2F,EAAMiE,EAAY,GAClBhE,EAAMgE,EAAY,GACxBwC,EAAcnJ,KAAKoJ,MAAMpJ,KAAKwE,UAAY7B,EAAMD,IAAQA,OAExDyG,EAAcnJ,KAAKwE,SAEvB0D,EAAS,EACT,MACJ,KAAK,EAAA/I,gBAAgBM,UACjB,IAAM4J,EAAa1C,EAAY,GAE/BuB,EADyB,EAAArB,mBAAmBjK,EAAWyM,GAEvD,MACJ,KAAK,EAAAlK,gBAAgBE,SACjB,IAAMiK,EAAY3C,EAAY,GACxB4C,EAAiB5C,EAAY,GAC7B6C,EAAkB,EAAA3C,mBAAmBjK,EAAW0M,GAClDE,IACAtB,EAAUsB,EAAwBD,IAEtC,MACJ,KAAK,EAAApK,gBAAgBmI,UACjB,IAAMmC,EAAU/N,KAAKgL,kBAAkB9J,EAAW+J,GAC9C8C,EACAvB,EAAUuB,EAAQrP,MAAY,OAE9BsB,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+J,EAAYyB,KAAK,MAAO,WAGhE,MACJ,KAAK,EAAAjJ,gBAAgBG,YAEjB,IAAMoK,EAAWhO,KAAKgL,kBAAkB9J,EAAW+J,GACnD,GAAI+C,EAAU,CACV,IAAMrF,EAAMqF,EAAStP,MACjBuP,EAAgBhD,EAAY,GAChC,GAAI1H,MAAMC,QAAQyK,GAAQ,CACtB,IAAMC,EAAWlO,KAAKkE,oBAAoBhD,EAAW+M,GACjD,EAAAE,SAASD,GACTD,EAAQC,GAGRlO,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+M,GAAQ,WAC5CA,EAAQ,GAGhBzB,EAAS7D,EAAIsF,GACThD,EAAY5J,QAAU,GAAKmL,IAC3BA,EAASA,EAAOvB,EAAY,UAGhCjL,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+J,EAAYyB,KAAK,MAAO,WAIhE,MACJ,KAAK,EAAAjJ,gBAAgBoI,eACjB,IAAMuC,EAAWpO,KAAKgL,kBAAkB9J,EAAW+J,GACnD,GAAImD,EACA,GAAI7K,MAAMC,QAAQ4K,EAAS1P,OAAQ,CAC/B,IAAM2P,EAAqBD,EAAS1P,MACpC,OAAQuM,EAAY,IAChB,IAAK,MACDuB,EAAS6B,EAAYrC,MACrB,MACJ,IAAK,OACD,GAAIf,EAAY5J,OAAS,EAAG,CACxB,IAAMiN,EAAatO,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IACnEuB,EAAS6B,EAAYvC,KAAKwC,GAE9B,MACJ,IAAK,QACD9B,EAAS6B,EAAY9M,QACrB,MACJ,IAAK,UACD,GAAI0J,EAAY5J,OAAS,EAAG,CACxB,IAAMkN,EAAgBvO,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IACtEuB,EAAS6B,EAAYG,QAAQD,GAEjC,MACJ,IAAK,SACD,GAAItD,EAAY5J,OAAS,EACrB,GAAI4J,EAAY5J,OAAS,EAAG,CACxB,IAAMoN,EAAezO,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IACrEuB,EAAS6B,EAAYzM,OAAO6M,QAE5BjC,EAAS6B,EAAYzM,SAG7B,MACJ,IAAK,SACD,GAA2B,IAAvBqJ,EAAY5J,OAAc,CAC1B,IAAMqN,EAAa1O,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IACnEuB,EAAS6B,EAAYM,OAAOD,QACzB,GAA2B,IAAvBzD,EAAY5J,OAAc,CAC3BqN,EAAa1O,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IAAnE,IACM2D,EAAc5O,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IACpEuB,EAAS6B,EAAYM,OAAOD,EAAYE,QACrC,GAAI3D,EAAY5J,OAAS,EAAG,CACzBqN,EAAa1O,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IAC7D2D,EAAc5O,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IADpE,IAEM4D,EAAW7O,KAAKkE,oBAAoBhD,EAAW+J,EAAY,IACjEuB,EAAS6B,EAAYM,OAAOD,EAAYE,EAAaC,GAEzD,MACJ,QAEI7O,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+J,EAAY,IAAK,iBAK7DjL,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+J,EAAYyB,KAAK,MAAO,gBAGhE1M,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+J,EAAYyB,KAAK,MAAO,WAGhE,MACJ,KAAK,EAAAjJ,gBAAgBK,aACrB,KAAK,EAAAL,gBAAgBI,YAEjB,IAAMiL,EAAU9O,KAAKgL,kBAAkB9J,EAAW+J,GAClD,GAAI6D,EAAS,CAET,IADA,IAAI1J,EAAM0J,EAAQpQ,MACTrB,EAAY,EAAG6E,EAAc+I,EAAY5J,OAAQhE,EAAI6E,EAAK7E,IAAK,CACpE,IAAM2B,EAAMiM,EAAY5N,GACpB+H,QAAe/C,IAARrD,IACPoG,EAAMA,EAAIpG,IAGlBwN,EAASpH,GAMrB,OAAOoH,GAGH,YAAAD,qBAAR,SAA6BrL,EAAwB6N,GACjD,IAAMxD,EAAwB,GAC9B,GAA4B,IAAxBwD,EAAa1N,OACb,OAAOrB,KAAKkE,oBAAoBhD,EAAW6N,EAAa,IAE5D,IAAK,IAAI1R,EAAY,EAAG6E,EAAc6M,EAAa1N,OAAQhE,EAAI6E,EAAK7E,IAAK,CACrE,IAAM2R,EAASD,EAAa1R,GAC5B,OAAQ2R,EAAO,IACX,KAAK,EAAAvL,gBAAgBsI,UACjB,IAAIkD,OAAQ,EACRC,OAAQ,EACM,MAAdF,EAAO,GACPC,EAAW1D,EAASS,OAEpBkD,EAAW3D,EAASS,MACpBiD,EAAW1D,EAASS,OAExB,IAAMmD,EAAanP,KAAKoP,mBAAmBlO,EAAW8N,EAAO,GAAIC,EAAUC,GAC3E3D,EAASO,KAAKqD,GACd,MACJ,QACI5D,EAASO,KAAKkD,IAI1B,OAAwB,IAApBzD,EAASlK,OACFkK,EAAS,GAAG,IAGnBvL,KAAKoM,UAAUlL,EAAW,aAASmB,EAAW,WACvC,IAIP,YAAA+M,mBAAR,SAA2BlO,EAAwB+K,EACxBgD,EAAwBC,GAC/C,IACIG,EACAC,EACA9C,EAHE2C,EAA0B,CAAC,EAAA1L,gBAAgBgI,MAAO,GAUxD,OANIwD,IACAI,EAAUrP,KAAKkE,oBAAoBhD,EAAW+N,IAE9CC,IACAI,EAAUtP,KAAKkE,oBAAoBhD,EAAWgO,IAE1CjD,GACJ,IAAK,IACDO,EAAS6C,EAAUC,EACnB,MACJ,IAAK,IACD9C,EAAS6C,EAAUC,EACnB,MACJ,IAAK,IACD9C,EAAS6C,EAAUC,EACnB,MACJ,IAAK,IACD9C,EAAS6C,EAAUC,EACnB,MACJ,IAAK,IACD9C,EAAS6C,EAAUC,EACnB,MACJ,IAAK,KACD9C,EAAS6C,GAAWC,EACpB,MACJ,IAAK,KACD9C,EAAS6C,GAAWC,EACpB,MACJ,IAAK,IACD9C,EAAS6C,EAAUC,EACnB,MACJ,IAAK,IACD9C,EAAS6C,EAAUC,EACnB,MACJ,IAAK,KAED9C,EAAS6C,GAAWC,EACpB,MACJ,IAAK,MACD9C,EAAS6C,IAAYC,EACrB,MACJ,IAAK,KAED9C,EAAS6C,GAAWC,EACxB,IAAK,MACD9C,EAAS6C,IAAYC,EACrB,MACJ,IAAK,IACD9C,GAAU6C,EACV,MACJ,IAAK,KACD7C,EAAS6C,GAAWC,EACpB,MACJ,IAAK,KACD9C,EAAS6C,GAAWC,EACpB,MACJ,IAAK,IAED,GADA9C,EAAS8C,EACLL,EACA,OAAQA,EAAS,IACb,KAAK,EAAAxL,gBAAgBC,SACjB,IAAM+I,EAAUzM,KAAKgL,kBAAkB9J,EAAW+N,GAC9CxC,EACAA,EAAQ/N,MAAQ8N,EAEhBxM,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+N,EAASvC,KAAK,MAAO,WAG7D,MACJ,KAAK,EAAAjJ,gBAAgBE,SACjB,IAAMiK,EAAYqB,EAAS,GACrBpB,EAAiBoB,EAAS,GAC1BnB,EAAkB,EAAA3C,mBAAmBjK,EAAW0M,GACtD,GAAIE,GACImB,EAAS5N,QAAU,EAAG,CAGtB,IAFA,IAAIkO,EAAkBzB,EAClB0B,EAAY3B,EACPxQ,EAAY,EAAG6E,EAAc+M,EAAS5N,OAAQhE,EAAI6E,IACvDsN,EAAOP,EAAS5R,GACZA,IAAM6E,EAAM,GAF4C7E,IAKpDkS,EACAA,EAAaA,EAAWC,GAGxBxP,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+N,EAASvC,KAAK,MAAO,WAKjE6C,GAAcC,EACdD,EAAWC,GAAQhD,EAGnBxM,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+N,EAASvC,KAAK,MAAO,WAKrE,MACJ,KAAK,EAAAjJ,gBAAgBmI,UACjB,IAAMmC,EAAU/N,KAAKgL,kBAAkB9J,EAAW+N,GAC9ClB,EACAA,EAAQrP,MAAM2C,OAASmL,EAEvBxM,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+N,EAASvC,KAAK,MAAO,WAG7D,MACJ,KAAK,EAAAjJ,gBAAgBG,YAEjB,IAAMoK,EAAWhO,KAAKgL,kBAAkB9J,EAAW+N,GACnD,GAAIjB,EAAU,CACV,IAAMrF,EAAMqF,EAAStP,MACjBuP,EAAgBgB,EAAS,IAAM,EACnC,GAAI1L,MAAMC,QAAQyK,GAAQ,CACtB,IAAMC,EAAWlO,KAAKkE,oBAAoBhD,EAAW+M,GACjD,EAAAE,SAASD,GACTD,EAAQC,GAGRlO,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+M,GAAQ,WAE5CA,EAAQ,GAGhB,GAAIgB,EAAS5N,QAAU,EAAG,CACtB,IAAI+D,EAAMuD,EAAIsF,GACVjP,OAAG,EACP,IAAS3B,EAAY,EAAG6E,EAAc+M,EAAS5N,OAAQhE,EAAI6E,EAAK7E,IAC5D2B,EAAMiQ,EAAS5R,GACXA,EAAI6E,EAAM,GAAKkD,EAAIpG,KACnBoG,EAAMA,EAAIpG,IAGdoG,QAAe/C,IAARrD,IACPoG,EAAIpG,GAAOwN,QAGf7D,EAAIsF,GAASzB,OAGjBxM,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+N,EAASvC,KAAK,MAAO,WAG7D,MACJ,KAAK,EAAAjJ,gBAAgBK,aACrB,KAAK,EAAAL,gBAAgBI,YAEjB,IAAMiL,EAAU9O,KAAKgL,kBAAkB9J,EAAW+N,GAClD,GAAIH,EAAS,CAGT,IAFI1J,EAAM0J,EAAQpQ,MACdM,OAAG,EACE3B,EAAY,EAAG6E,EAAc+M,EAAS5N,OAAQhE,EAAI6E,EAAK7E,IAC5D2B,EAAMiQ,EAAS5R,GACXA,EAAI6E,EAAM,GAAKkD,EAAIpG,KACnBoG,EAAMA,EAAIpG,IAGdoG,QAAe/C,IAARrD,EACPoG,EAAIpG,GAAOwN,EAGXsC,EAAQpQ,MAAQ8N,EAGxB,MACJ,KAAK,EAAA/I,gBAAgBgI,MAEjBzL,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+N,EAASvC,KAAK,MAAO,WAMrE,MACJ,QAEI1M,KAAKoM,UAAUlL,EAAW,QAAS,CAAC+K,GAAa,WAIzD,OADAkD,EAAW,GAAK3C,EACT2C,GAGH,YAAApF,SAAR,SAAiBV,GACT,IAAM9D,EAAMkK,KAAKC,UAAUrG,GAE3B,OADwBoG,KAAKE,MAAMpK,IAInC,YAAAqK,gBAAR,SAAwBpG,GACpB,UAAI,EAAAqG,SAASrG,IACVA,EAAElK,eAAe,SACjBkK,EAAElK,eAAe,WACJ,UAAXkK,EAAE9I,MACS,YAAX8I,EAAE9I,MACS,WAAX8I,EAAE9I,MACS,WAAX8I,EAAE9I,MACS,WAAX8I,EAAE9I,OAMH,YAAAgJ,oBAAR,SAA4BtH,EAAYoH,GACpC,GAAKxJ,KAAK4P,gBAAgBpG,GAmBtB,OAAOA,EAlBP,IAAMuB,EAAyB,CAC3B3I,GAAE,EACF1B,KAAM,SACNhC,MAAO8K,GAaX,OAXI,EAAAsG,UAAUtG,GACVuB,EAAQrK,KAAO,UACP,EAAAqP,SAASvG,GACjBuB,EAAQrK,KAAO,SACP,EAAAyN,SAAS3E,GACjBuB,EAAQrK,KAAO,SACP,EAAA8C,QAAQgG,GAChBuB,EAAQrK,KAAO,QAEfqK,EAAQrK,KAAO,SAEZqK,GAKP,YAAAqB,UAAR,SAAkBlL,EAAwB8O,EAAcC,EAAgBC,G,MACpE,QADoE,IAAAA,MAAA,UAChEhP,IAAaA,EAAUW,QAIvB,MAAM,IAAIsO,MAAOH,EAAO,MAAa,QAAT,EAAGC,SAAM,eAAEvD,KAAK,OAH5BxL,EAAUW,QAClBuO,YAAYhE,UAAU4D,EAAMC,EAAQC,IAzrBtC,EAAApG,UAAoB,SAEpB,EAAAqC,iBAAmB,CAC7B,IAAM,IACN,IAAM,GACN,IAAM,GACN,IAAM,GACN,IAAM,GACN,KAAO,GACP,KAAO,GACP,IAAM,GACN,IAAM,GACN,KAAO,GACP,MAAQ,GACR,KAAO,GACP,MAAQ,GACR,IAAM,GACN,KAAO,GACP,KAAO,GACP,IAAM,IA6qBd,EAlsBJ,GAAa,EAAAtC,mB,8ECuQb,SAAYpG,GACR,qBACA,2BACA,uBACA,uBACA,2BACA,6BACA,6BACA,iCACA,mCACA,iCACA,wCACA,8BAZJ,CAAY,EAAAA,kBAAA,EAAAA,gBAAe,KAc3B,SAAYqJ,GACR,mBACA,mBACA,qBACA,iBACA,mBALJ,CAAY,EAAAA,kBAAA,EAAAA,gBAAe,M,8ZC5R3B,WAIA,OACA,OAEA,cASQ,WAAYuD,EAAyBC,EAAiB3P,GAAtD,MACI,cAAO,K,OAJD,EAAA4P,OAAiB,EAEjB,EAAAC,SAAqB,GAG3B,EAAKtP,UAAYmP,EACjB,EAAKC,QAAUA,EACf,EAAK3P,KAAOA,E,EA4FpB,OAzGkC,OAgBvB,YAAAZ,IAAP,WAGI,GAFA,YAAMA,IAAG,WACTC,KAAKyQ,WAAa,EAAAtF,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC3DnH,KAAKyQ,YAAczQ,KAAKyQ,WAAW5O,QAAS,CAC5C,IAAMmC,EAAkBhE,KAAKyQ,WAAW5O,QAAQmC,gBAC5C0M,EAAQ1Q,KAAKsQ,QAKjB,GAJAtQ,KAAKuQ,MAAQvM,EAAgBiF,gBAC7ByH,EAAQ1Q,KAAKyQ,WAAWrF,SAAWpL,KAAKsQ,QAExCtQ,KAAKwQ,SAASnP,OAAS,EACnBrB,KAAKW,KAAKsP,OAAQ,CAElB,IADA,IAAMU,EAAqB,GACjBtT,EAAY,EAAG6E,EAAclC,KAAKW,KAAKsP,OAAO5O,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC1E,IAAMuT,EAAQ5Q,KAAKW,KAAKsP,OAAO5S,GAC3BwT,EAAaD,EACjB,GAAIrN,MAAMC,QAAQoN,GAEdC,EADiB7M,EAAgBE,oBAAoBlE,KAAKkB,UAAW0P,GAGzED,EAAY7E,KAAK+E,GAErB,IAASxT,EAAY,EAAG6E,EAAcyO,EAAYtP,OAAQhE,EAAI6E,EAAK7E,IAAK,CACpE,IAAMyT,EAAUJ,EAAQ1Q,KAAKuQ,MAAQ,SAAWlT,EAChD2C,KAAKwQ,SAAS1E,KAAKgF,GACd9M,EAAgBuE,YAAY,EAAAsB,gBAAgBC,aAC7C9F,EAAgBuE,YAAY,EAAAsB,gBAAgBC,WAAa,IAE7D9F,EAAgBuE,YAAY,EAAAsB,gBAAgBC,WAAWgH,GAAW,CAC9D1O,GAAI0O,EACJpQ,KAAM,SACNhC,MAAOiS,EAAYtT,KAI/B2C,KAAK+Q,IAAM/M,EAAgBkF,gBAAgBwH,GACvC1Q,KAAK+Q,KAED/Q,KAAKwQ,SAASnP,QACdrB,KAAK+Q,IAAIC,aAAahR,KAAKwQ,UAE/BxQ,KAAK+Q,IAAIrJ,GAAG,EAAAjI,UAAUwR,sBAAuBjR,KAAKkR,cAAelR,MACjEA,KAAK+Q,IAAII,UAAUnR,KAAKuQ,QAExBvQ,KAAKO,gBAGTP,KAAKO,YAIN,YAAAN,KAAP,WACI,YAAMA,KAAI,WACND,KAAK+Q,KACL/Q,KAAK+Q,IAAIK,WAAWpR,KAAKuQ,OAE7BvQ,KAAKO,YAGF,YAAAH,MAAP,WACI,YAAMA,MAAK,WACPJ,KAAK+Q,KACL/Q,KAAK+Q,IAAIM,YAAYrR,KAAKuQ,OAE9BvQ,KAAKO,YAGF,YAAAA,SAAP,WAMI,GALAP,KAAKuQ,MAAQ,EACTvQ,KAAK+Q,KACL/Q,KAAK+Q,IAAI/I,IAAI,EAAAvI,UAAUwR,sBAAwBjR,KAAKkR,cAAelR,MAGnEA,KAAKwQ,SAASnP,QACVrB,KAAKkB,WAAalB,KAAKkB,UAAUW,QAEjC,IADA,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACtC3G,EAAY,EAAG6E,EAAclC,KAAKwQ,SAASnP,OAAQhE,EAAI6E,EAAK7E,IAAK,CACtE,IAAMyT,EAAU9Q,KAAKwQ,SAASnT,UACvB2G,EAAgBuE,YAAY,EAAAsB,gBAAgBC,WAAWgH,GAI1E,YAAMvQ,SAAQ,YAGV,YAAA2Q,cAAR,SAAsBvQ,GACdA,IAASX,KAAKuQ,OACdvQ,KAAKO,YAGjB,EAzGJ,CAAsC,EAAAS,UAAzB,EAAAsQ,oB,8ECFb,YAIA,aAKI,aAFgB,KAAAlB,YAAc,IAAI,UAwH1B,KAAAmB,gBAA0B,oBAC1B,KAAAC,mBAA6B,qBACzC,OAjHW,YAAA9J,GAAP,SAAU+J,EAAeC,EAASC,GAEjC,OADA3R,KAAKoQ,YAAY1I,GAAG+J,EAAOC,EAAIC,GACxB3R,MAED,YAAA4R,YAAP,SAAmBH,EAAeC,EAAcC,GAC/C,OAAO3R,KAAK0H,GAAG+J,EAAOC,EAAIC,IAMpB,YAAAE,eAAP,SAAsBJ,EAAeC,EAAeC,EAAeG,GAClE,OAAO9R,KAAKgI,IAAIyJ,EAAOC,EAAIC,EAASG,IAE9B,YAAA9J,IAAP,SAAWyJ,EAAeC,EAAUC,EAAeG,GAElD,OADA9R,KAAKoQ,YAAYpI,IAAIyJ,EAAOC,EAAIC,EAASG,GAClC9R,MAQD,YAAA+R,eAAP,WAEC,IAAIC,EAA6B,IAAIzO,MAAM,IAAK,IAAK,IAAK,KAC1D,OAAOvD,KAAKiS,uBAAuB,EAAG,IAAM,IAAMjS,KAAKiS,uBAAuB,EAAG,IAAM,KAAOjS,KAAKiS,uBAAuB,EAAG,IAAM,IAAMD,EAAahS,KAAKkS,yBAAyB,EAAG,IAAMlS,KAAKiS,uBAAuB,EAAG,IAAM,IAAMjS,KAAKiS,uBAAuB,GAAI,KAQlQ,YAAAE,aAAP,WAEC,IACIC,EAAY,IAAIxF,KAEpB,OADayF,OAAOD,EAAKpF,WAAaqF,OAAO,IAAOD,EAAKE,mBAAqBD,OAAO/N,KAAKuE,MAAsB,IAAhBvE,KAAKwE,UAAmB,MAS/G,YAAAyJ,eAAV,SAAyBC,GAExBxS,KAAKoQ,YAAY/P,KAAK,QAAiB,CACtC2P,KAAMhQ,KAAKyS,aAAazS,MAAQA,KAAKuR,gBACrCrB,MAAO,SACPvP,KAAM,CAAC3C,KAAKwU,EAAc9T,MAAasB,KAAMwS,OAYrC,YAAAE,cAAV,SAAwBF,EAAsBG,GAE7C3S,KAAKoQ,YAAY/P,KAAK,QAAiB,CACtC2P,KAAMhQ,KAAKyS,aAAazS,MAAQA,KAAKwR,mBACrCtB,MAAO,QACPvP,KAAM,CAAC3C,KAAKwU,EAAc9T,MAAMiU,MAKlC,sBAAW,mBAAI,C,IAAf,WACC,MAAO,I,gCAGD,YAAAvM,OAAP,SAAcwM,EAAaxN,GAEvB,IAAI,IAAMpG,KADVkG,QAAQ2N,eAAeD,GACNxN,EACbF,QAAQC,IAAI,KAAOnG,EAAM,IAAK,iBAAkBoG,EAAIpG,IAExDkG,QAAQ4N,YAOJ,YAAAb,uBAAR,SAA+B5Q,EAAgB0R,QAAA,IAAAA,MAAA,IAC9C,IAAIC,EAA4B,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAC9U5Q,EAAoB,GAExB,IADA2Q,EAASA,EAAQ,GAAM,GAAKA,EACrB1R,KACNe,EAAG0J,KAAKkH,EAAWhT,KAAKkS,yBAAyB,EAAGa,KAErD,OAAO3Q,EAAGsK,KAAK,KAGR,YAAAwF,yBAAR,SAAiClL,EAAaC,GAC7C,OAAO3C,KAAKuE,MAAMvE,KAAKwE,UAAY,EAAI7B,EAAMD,GAAOA,IAG7C,YAAAyL,aAAR,SAAqB/T,GACpB,IACIuU,EADQ,qBACQC,KAAYxU,EAAOyU,YAAY9N,YACnD,OAAQ4N,GAAWA,EAAQ5R,OAAS,EAAK4R,EAAQ,GAAK,IAK3D,EA7HA,G,09CCRA,YACA,QACA,QAIA,QACA,QAGA,QACA,QAIA,aAkDI,WAAYG,GAqGL,KAAAC,QAAU,SAACC,KAOX,KAAAC,OAAS,aAOT,KAAAC,QAAU,aAOV,KAAAC,cAAgB,aAOhB,KAAAC,UAAY,SAACC,KAOb,KAAAC,UAAY,aArIfC,EAAOC,OAAS,UAAOC,cAKvB/T,KAAKgU,OAAS,IAAI,UAAOZ,GAGzBpT,KAAKiU,UAAY,IAAI,UAAajU,KAAKgU,QAEvChU,KAAKkU,kBAELlU,KAAKmU,YAAc,OACnBjP,QAAQC,IAAI,qCACZD,QAAQ4N,WAEJ9S,KAAKgU,OAAOI,KAAOpU,KAAKqU,KAAKrU,KAAKgU,OAAOI,KA+QrD,OAtTI,sBAAW,yBAAU,C,IAArB,WACI,OAAOpU,KAAKmU,a,IAEhB,SAAsBzV,GAClBsB,KAAKmU,YAAczV,EACnBsB,KAAKgU,OAAO5D,YAAY/P,KAAK,SAAkB,CAAE2P,KAAMtR,EAAOwR,MAAO,SAAmBvP,KAAMjC,K,gCAsCrF,YAAA2V,KAAb,SAAkBD,G,yEACW,SAArBpU,KAAKmU,aACgB,WAArBnU,KAAKmU,aACLnU,KAAKsU,SAETtU,KAAKuU,SAASH,G,WAGX,YAAAlU,MAAP,WACQF,KAAKwU,OACLxU,KAAKwU,MAAMtU,SAIZ,YAAAC,OAAP,WACQH,KAAKwU,OACLxU,KAAKwU,MAAMrU,UAIZ,YAAAsU,MAAP,WACQzU,KAAKwU,OACLxU,KAAKwU,MAAMC,SAIZ,YAAAC,QAAP,SAAef,GACX3T,KAAKgU,OAAO5D,YAAY/P,KAAK,YAAqBsT,IAG/C,YAAAgB,WAAP,SAAkBhB,GACd3T,KAAK0T,UAAUC,IAGZ,YAAAiB,kBAAP,SAAyBC,GACjB7U,KAAKwU,OACLxU,KAAKwU,MAAMI,kBAAkBC,IAI9B,YAAAC,kBAAP,SAAyBD,GACjB7U,KAAKwU,OACLxU,KAAKwU,MAAMM,kBAAkBD,IAI9B,YAAAE,gBAAP,SAAuBC,EAAiBH,GAChC7U,KAAKwU,OACLxU,KAAKwU,MAAMO,gBAAgBC,EAASH,IAIrC,YAAAxN,QAAP,SAAe4N,QAAA,IAAAA,OAAA,GAEa,aAApBjV,KAAKkV,aAOTlV,KAAKgU,OAAO5D,YAAY+E,qBAEpBnV,KAAKwU,OACLxU,KAAKwU,MAAMnN,UAGXrH,KAAKwC,KAAOxC,KAAKwC,IAAIgS,OACrBxU,KAAKwC,IAAI4S,QAAQH,EAAY,CAAEI,UAAU,EAAMzS,SAAS,EAAM0S,aAAa,IAG/EtV,KAAK4T,YACL5T,KAAKkV,WAAa,aA6Cd,YAAAhB,gBAAR,WACI,IAAMzC,EAAQzR,KAAKgU,OAAO5D,YAC1BqB,EAAM/J,GAAG,UAAmB1H,KAAKuV,YAAavV,MAC9CyR,EAAM/J,GAAG,SAAkB1H,KAAKwV,SAAUxV,OAGtC,YAAAsU,OAAR,WAEItU,KAAKgU,OAAO5D,YAAY+E,qBAEpBnV,KAAKwU,OACLxU,KAAKwU,MAAMnN,UAGXrH,KAAKwC,KACLxC,KAAKwC,IAAI4S,SAAQ,EAAM,CAAEC,UAAU,EAAMzS,SAAS,EAAM0S,aAAa,IAGzEtV,KAAKkU,mBAUK,YAAAuB,MAAd,W,yEACI,OAAKzV,KAAK0V,OAEV1V,KAAKgU,OAAOlR,MAAQ9C,KAAK0V,MAAM5S,MAC/B9C,KAAKgU,OAAOjR,OAAS/C,KAAK0V,MAAM3S,YACFV,IAA1BrC,KAAKgU,OAAOhR,YACZhD,KAAKgU,OAAOhR,UAAYhD,KAAK0V,MAAM1S,WAAa,WAIpDnC,GAAGC,MAAM6U,YAGHvC,EAAU,CACZtQ,MAAO9C,KAAKgU,OAAOlR,MACnBC,OAAQ/C,KAAKgU,OAAOjR,OACpB6S,gBAAiBC,SAAS7V,KAAKgU,OAAO8B,SAAW,IAAK,IACtDC,YAAmC,gBAAtB/V,KAAKgU,OAAOgC,MACzBC,WAAW,GAEfjW,KAAKwC,IAAM,IAAI3B,GAAGqV,YAAY9C,GAC9BpT,KAAKwC,IAAIwC,KAAKmR,MAAMC,OAAS,IAC7BpW,KAAKgU,OAAOvR,UAAU4T,YAAYrW,KAAKwC,IAAIwC,MAG3ChF,KAAKwU,MAAQ,IAAI,EAAA8B,QAAQtW,KAAK0V,MAAO1V,KAAKgU,OAAQhU,MAClDA,KAAKwU,MAAMhS,IAAMxC,KAAKwC,IACtBxC,KAAKwC,IAAIgS,MAAM+B,SAASvW,KAAKwU,MAAM/R,WAGnC,UAA0BzC,KAAKwC,IAAIwC,KAAMhF,KAAKwU,MAAOxU,KAAKgU,OAAOhR,WAGjEhD,KAAKkV,WAAa,QAGlBlV,KAAKwU,MAAMiB,Q,KAnCQ,WAsCT,YAAAlB,SAAd,SAAuBH,G,+GAMnB,OAJApU,KAAKkV,WAAa,OAEZM,EAAWxV,KAAKwV,SAASvW,KAAKe,MAEpC,GAAMA,KAAKgU,OAAOwC,KAAKC,KAAKzW,KAAKgU,OAAO0C,KAAKC,QAASnB,I,cAAtD,SAEmB,iBAARpB,EAAP,OACA,EAAApU,KAAa,GAAM,UAAaoU,EAAK,CAAEwC,aAAc,SAAUC,OAAM,SAACnY,GAAY8W,EAAS9W,Q,cAA3F,EAAKgX,MAAQ,S,aACS,iBAARtB,IACdpU,KAAK0V,MAAQtB,G,wBAGXzT,EAAOX,KAAK0V,OAEV/U,EAAKmW,WACc,iBAAR1C,EAAP,OACM2C,EAAU3C,EAAI4C,MAAM,KAAK,IAAM,MAE/BC,EAAiB7C,EAAI8C,OAAO,EAAG9C,EAAI+C,YAAY,MAAQ,IAAMxW,EAAKmW,WAAa,IAAMC,EAC3F,GAAM,UAAaE,GAAgBJ,OAAM,SAACO,GACtC,EAAK5B,SAAS4B,QANtB,MADJ,O,OAS6B,OAHrB,SAGqB,GAAM,IAAK9Z,OAAe+Z,c,OAC/C,SADqB,SACFC,SAAStX,KAAKgU,OAAOuD,eAAgBvX,KAAK0V,Q,cAA7D,S,aAEA1V,KAAKwV,SAAS,CAAExF,KAAM,QAASE,MAAO,QAAkBvP,KAAMA,EAAKmW,a,iBAI3E,OADA9W,KAAKkV,WAAa,SAClB,GAAMlV,KAAKyV,S,QAAX,S,qCAIA,YAAA+B,cAAR,SAAsBC,KAKd,YAAAC,cAAR,SAAsBD,KAUd,YAAAlC,YAAR,SAAoB5B,GAChB3T,KAAK0T,UAAUC,IAOX,YAAA6B,SAAR,SAAiB7B,GACb,GAAkB,UAAdA,EAAIzD,OAA4C,YAAdyD,EAAIzD,MAMtC,MALkB,UAAdyD,EAAIzD,OACJlQ,KAAKiU,UAAU0D,WAAWhE,EAAI3D,KAAM2D,EAAIhT,MAE5CgT,EAAIe,QAAU1U,KAAKiU,UAAU2D,QAAQjE,EAAI3D,KAAM2D,EAAIhT,WACnDX,KAAKqT,QAAQM,GAGjB,OAAQA,EAAI3D,MACZ,IAAK,OACDhQ,KAAKuT,SACL,MACJ,IAAK,QACDvT,KAAKwT,UACL,MACJ,IAAK,cACDxT,KAAKyT,gBACL,MACJ,QACIzT,KAAK0T,UAAUC,KAK3B,EApVA,GAAa,EAAAE,U,8ZCTb,kBAYQ,mBACI,cAAO,K,OAVJ,EAAAzI,WAAqB5J,EAAYqW,YAGjC,EAAA3N,MAAgB,IAChB,EAAA9H,GAAa,IACV,EAAA0V,YAAqD,GAGrD,EAAAC,eAAgE1V,EAGtE,EAAK2V,eAAgB,E,EAqOjC,OAnPiC,OAiBzB,sBAAW,sBAAO,C,IAYlB,WACI,OAAOhY,KAAKiY,U,IAbhB,SAAmBzD,GAEf,IAAM,IAAMpS,KADZpC,KAAKiY,SAAWzD,EACExU,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,IACjB0W,EAAMrW,QAAU2S,K,gCAUzB,YAAAtU,MAAP,WAEI,IAAM,IAAMkC,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAMhY,QAKdF,KAAKmY,YACLnY,KAAK+X,UAAY/X,KAAKmY,UAAUC,eAChCpY,KAAKmY,UAAUlY,QAEfD,KAAKqY,YACLrY,KAAKqY,WAAWnY,SAIjB,YAAAC,OAAP,WACI,IAAM,IAAMiC,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAM/X,SAIdH,KAAKmY,WACDnY,KAAK+X,YACL/X,KAAKmY,UAAUG,SAAStY,KAAK+X,UAAUI,UAAWnY,KAAK+X,UAAUQ,MAAOvY,KAAK+X,UAAUS,OACvFxY,KAAK+X,eAAY1V,GAGrBrC,KAAKqY,YACLrY,KAAKqY,WAAWlY,UAKjB,YAAAsY,qBAAP,WACQzY,KAAKmY,WACLnY,KAAKmY,UAAUM,wBAGhB,YAAAH,SAAP,SAAgBta,EAAcua,EAAeC,QAAA,IAAAA,MAAA,GACrCxY,KAAKmY,WACLnY,KAAKmY,UAAUG,SAASta,EAAMua,EAAOC,IAGtC,YAAAE,SAAP,SAAgB1a,EAAcua,GACtBvY,KAAKmY,WACLnY,KAAKmY,UAAUO,SAAS1a,EAAMua,IAG/B,YAAAlE,KAAP,SAAYrW,EAAcwa,QAAA,IAAAA,MAAA,GAClBxY,KAAKmY,WACLnY,KAAKmY,UAAU9D,KAAKrW,EAAMwa,IAI3B,YAAAvY,KAAP,WACQD,KAAKmY,WACLnY,KAAKmY,UAAUlY,QAIhB,YAAAwB,aAAP,SAAoBW,GAChB,OAAOpC,KAAK8X,YAAY1V,IAGrB,YAAAyI,YAAP,SAAmBzI,GACf,GAAIpC,KAAKiY,SAGL,OAFWjY,KAAKiY,SAASjU,gBACL6G,YAAY7K,KAAKoL,SAAS/F,WAAYjD,IAM3D,YAAAuW,iBAAP,SAAwBvW,GACpB,IAAMwW,EAAW5Y,KAAK6K,YAAYzI,GAClC,GAAIwW,EACA,OAAOA,EAASla,OAKjB,YAAAma,iBAAP,SAAwBzW,EAAY1D,GAChC,IAAMka,EAAW5Y,KAAK6K,YAAYzI,GAC9BwW,IACAA,EAASla,MAAQA,IAIlB,YAAAoa,WAAP,SAAmDC,EAAS9K,GAExD,IAAM+K,EAAOD,EAAiB,GAC1B/Y,KAAK8X,YAAYkB,EAAI3T,cAGrBrF,KAAK8X,YAAYkB,EAAI3T,YAAc0T,GAEnCA,aAAgBvX,IAChBuX,EAAKlX,QAAU7B,KAAK6B,SAExB,IAAMqW,EAAQ,YAAMY,WAAU,UAACC,EAAM9K,GAIrC,OAHI8K,aAAgBvX,GAChBuX,EAAKN,uBAEFP,GAGJ,YAAAe,YAAP,SAAoDC,GAGnCA,EAAqB,GAElC,OAAO,YAAMD,YAAW,UAACC,IAGtB,YAAAC,UAAP,WACI,IAAM,IAAM/W,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAMiB,YAIdnZ,KAAKqY,YACLrY,KAAKqY,WAAWtY,MAEpBC,KAAK0H,GAAG,SAAuB1H,KAAKoZ,UAAWpZ,OAG5C,YAAAqZ,qBAAP,WACI,IAAM,IAAMjX,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAMmB,uBAIlBrZ,KAAKK,KAAK,MAAoBL,OAG3B,YAAAsZ,eAAP,WACI,IAAM,IAAMlX,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAMoB,iBAIlBtZ,KAAKK,KAAK,QAAsBL,OAG7B,YAAAuZ,kBAAP,WACI,IAAM,IAAMnX,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAMqB,oBAIlBvZ,KAAKK,KAAK,UAAwBL,OAE/B,YAAAwZ,wBAAP,WACI,IAAM,IAAMpX,KAAMpC,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAMsB,0BAIlBxZ,KAAKK,KAAK,SAAuBL,OAG9B,YAAAqH,QAAP,WAOI,IAAM,IAAMjF,KANZpC,KAAKiY,cAAW5V,EAChBrC,KAAKgY,eAAgB,EACjBhY,KAAKmY,WACLnY,KAAKmY,UAAUlY,OAGDD,KAAK8X,YACnB,GAAI9X,KAAK8X,YAAY1V,GAAK,CACtB,IAAM8V,EAAQlY,KAAK8X,YAAY1V,GAC3B8V,aAAiB1W,GACjB0W,EAAM7Q,UAKlBrH,KAAKyZ,cAGD,YAAAL,UAAR,WACQpZ,KAAKqY,YACLrY,KAAKqY,WAAWpY,OAEpBD,KAAKgI,IAAI,WA9OC,EAAA6P,YAAsB,IAiP5C,EAnPA,CAAiChX,GAAGsD,IAAIuV,WAA3B,EAAAlY,e,8ZCPb,WACA,OAKA,OAEA,cASQ,WAAYN,EAAwBP,GAApC,MACI,cAAO,K,OACP,EAAKO,UAAYA,EACjB,EAAKyY,eAAgB,EACrB,EAAKhZ,KAAOA,EACZ,EAAKiZ,UAAYjZ,EAAK8Q,MACtB,EAAKqC,QAAyB,IAAhBnT,EAAKmT,OACnB,EAAK+F,QAAyB,IAAhBlZ,EAAKkZ,O,EAkF3B,OAlGiC,OAmBtB,YAAA9Z,IAAP,WAII,GAHA,YAAMA,IAAG,WAETC,KAAK2Z,eAAgB,EACjB3Z,KAAKkB,UAKL,GAJIlB,KAAKwH,UACLxH,KAAKwH,SAASE,GAAG,EAAAjI,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAGhEA,KAAK8T,QACCjS,EAAW7B,KAAKkB,UAA0BW,UAE5CA,EAAQuO,YAAY1I,GAAG1H,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAEvD,GAAIA,KAAK6Z,OAAQ,CACpB,IAAMhY,KAAW7B,KAAKkB,UAA0BW,UAE5CA,EAAQ6F,GAAG1H,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAG9CA,KAAKyQ,WAAa,EAAAtF,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC3DnH,KAAKyQ,YACLzQ,KAAKyQ,WAAW/I,GAAG1H,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,MAI9DA,KAAKO,YAIF,YAAAN,KAAP,WAGI,GAFAD,KAAKO,WAEDP,KAAKyQ,WACL,GAAIzQ,KAAK8T,QACCjS,EAAW7B,KAAKyQ,WAA2B5O,UAE7CA,EAAQuO,YAAYpI,IAAIhI,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAExD,GAAIA,KAAK6Z,OAAQ,CACpB,IAAMhY,KAAW7B,KAAKyQ,WAA2B5O,UAE7CA,EAAQmG,IAAIhI,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAG/CA,KAAKyQ,WAAWzI,IAAIhI,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,MAGvDA,KAAKwH,WACLxH,KAAKwH,SAASQ,IAAI,EAAAvI,UAAUe,eAAgBR,KAAK8Z,gBACjD9Z,KAAKwH,SAASjH,YAGlB,YAAMN,KAAI,YAEP,YAAAG,MAAP,WACIJ,KAAKO,WACL,YAAMH,MAAK,YAGL,YAAA0Z,eAAV,WACI9Z,KAAK2Z,eAAgB,GAGf,YAAAK,eAAV,SAAyBvC,GACjBA,EAAIzH,OAAShQ,KAAK4Z,WAClB5Z,KAAK+Z,YAIH,YAAAA,SAAV,WACQ/Z,KAAKL,WAGLK,KAAKwH,UAAYxH,KAAK2Z,gBACtB3Z,KAAK2Z,eAAgB,EACrB3Z,KAAKwH,SAASzH,QAG1B,EAlGJ,CAAqC,EAAAkI,eAAxB,EAAAgS,mB,8ZCRb,WAEA,cAMQ,mBACI,cAAO,K,OALH,EAAAC,OAAqB,GACrB,EAAAC,aAAyB,KACzB,EAAAC,cAAwB,E,EAmIpC,OAvI2B,OAUvB,sBAAW,oBAAK,C,IAAhB,WACI,OAAOpa,KAAKka,Q,gCAGT,YAAAna,IAAP,WACQC,KAAKqa,YAGTra,KAAKoa,cAAgB,EACrB,YAAMra,IAAG,WACTC,KAAKsa,cAGF,YAAAra,KAAP,WACI,YAAMA,KAAI,WAEND,KAAKma,eACLna,KAAKua,WAAWva,KAAKma,cACrBna,KAAKma,aAAala,OAClBD,KAAKma,aAAe,MAExBna,KAAKoa,cAAgBI,OAAOC,UAC5Bza,KAAKgI,IAAI,EAAAvI,UAAUe,gBACnBR,KAAKgI,IAAI,EAAAvI,UAAUa,aACnBN,KAAKgI,IAAI,EAAAvI,UAAUmB,YACnBZ,KAAKO,YAGF,YAAAL,MAAP,WAEI,GADA,YAAMA,MAAK,WACPF,KAAKka,OACL,IAAK,IAAI7c,EAAY,EAAG6E,EAAclC,KAAKka,OAAO7Y,OAAQhE,EAAI6E,EAAK7E,IAC/D2C,KAAKka,OAAO7c,GAAG6C,SAKpB,YAAAC,OAAP,WAEI,GADA,YAAMA,OAAM,WACRH,KAAKka,OACL,IAAK,IAAI7c,EAAY,EAAG6E,EAAclC,KAAKka,OAAO7Y,OAAQhE,EAAI6E,EAAK7E,IAC/D2C,KAAKka,OAAO7c,GAAG8C,UAKpB,YAAAC,MAAP,WACI,YAAMA,MAAK,WAEPJ,KAAKma,eACLna,KAAKua,WAAWva,KAAKma,cACrBna,KAAKma,aAAa/Z,QAClBJ,KAAKma,aAAe,MAExBna,KAAKoa,cAAgBI,OAAOC,UAC5Bza,KAAKgI,IAAI,EAAAvI,UAAUe,gBACnBR,KAAKgI,IAAI,EAAAvI,UAAUa,aACnBN,KAAKgI,IAAI,EAAAvI,UAAUmB,YACnBZ,KAAKO,YAGF,YAAAuH,QAAP,SAAeD,GACX,IAAIA,EAUA,MAAM,IAAIsI,MAAM,iBANhB,GAHItI,EAAKE,eACL/H,KAAKF,eAAgB,KAErBE,KAAKka,OAAOQ,QAAQ7S,GAAQ,GAG5B,MAAM,IAAIsI,MAAM,kBAKxB,OAPQnQ,KAAKka,OAAOpO,KAAKjE,GAOlBA,GAEH,YAAAyS,UAAR,SAAkBK,GAEd,IAAI9S,EAAiB,KACjB7H,KAAKoa,cAAgBpa,KAAKka,OAAO7Y,SACjCwG,EAAO7H,KAAKka,OAAOla,KAAKoa,gBAExBvS,GACA7H,KAAKma,aAAetS,EACpB7H,KAAKma,aAAazS,GAAG,EAAAjI,UAAUe,eAAgBR,KAAK4a,kBAAmB5a,MACvEA,KAAKma,aAAazS,GAAG,EAAAjI,UAAUmB,WAAYZ,KAAK6a,cAAe7a,MAC/DA,KAAKma,aAAazS,GAAG,EAAAjI,UAAUa,YAAaN,KAAK8a,eAAgB9a,MAEjEA,KAAKma,aAAapa,OAElBC,KAAKO,YAIL,YAAAga,WAAR,SAAmB1S,GACXA,IACAA,EAAKG,IAAI,EAAAvI,UAAUe,eAAgBR,KAAK4a,kBAAmB5a,MAC3D6H,EAAKG,IAAI,EAAAvI,UAAUmB,WAAYZ,KAAK6a,cAAe7a,MACnD6H,EAAKG,IAAI,EAAAvI,UAAUa,YAAaN,KAAK8a,eAAgB9a,QAIrD,YAAA8a,eAAR,SAAuBna,GACfX,KAAKma,eACLna,KAAKua,WAAWva,KAAKma,cACrBna,KAAKK,KAAK,EAAAZ,UAAUa,aACpBN,KAAKO,aAIL,YAAAsa,cAAR,SAAsBla,GAClB,IAAIX,KAAKma,aAKL,MAAM,IAAIhK,MAAM,WAJhBnQ,KAAKua,WAAWva,KAAKma,cACrBna,KAAKS,KAAKE,EAAKD,KAAMC,EAAKA,OAO1B,YAAAia,kBAAR,SAA0Bja,GACtBX,KAAKua,WAAWva,KAAKma,cACrBna,KAAKoa,gBACLpa,KAAKsa,UAAUta,KAAKma,eAE5B,EAvIJ,CAA+B,EAAAnZ,UAAlB,EAAAyG,a,8ZCFb,WAGA,OAEA,cAKQ,WAAY4I,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAsBpB,OA9BiC,OAWtB,YAAAZ,IAAP,WACI,YAAMA,IAAG,WACT,IAAMmB,EAAY,EAAAiK,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC3DjG,IACCA,EAAkBlB,KAAKW,KAAKvB,UAAYY,KAAKoI,YAElDpI,KAAKO,YAGD,YAAA6H,SAAR,WACI,GAAI7E,MAAMC,QAAQxD,KAAKW,KAAKjC,QACpBsB,KAAKkB,UAAUW,QAEf,OADwB7B,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKjC,OAI7E,OAAOsB,KAAKW,KAAKjC,OAEzB,EA9BJ,CAAqC,EAAAsC,UAAxB,EAAA+Z,mB,8ZCLb,IAIA,cAKQ,WAAY1K,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAWpB,OAnB6B,OAWlB,YAAAZ,IAAP,YACI,YAAMA,IAAG,WACLC,KAAKkB,WAAalB,KAAKkB,UAAUW,UACT7B,KAAKkB,UAAUW,QAAQmC,gBAC/BqH,gBAAgBrL,KAAKkB,UAAWlB,KAAKW,KAAK2K,SAE9DtL,KAAKO,YAEb,EAnBJ,CAJA,KAIiCS,UAApB,EAAAga,e,8ZCJb,WAKA,cAQQ,WAAY3K,GAAZ,MACI,cAAO,K,OANJ,EAAA4K,WAA4B,GAC5B,EAAAC,cAA6B,GAMhC,EAAKha,UAAYmP,E,EAoDzB,OA9DwB,OAab,YAAA8K,aAAP,SAAoBC,EAAwBrb,GACpCqb,GAAaA,EAAU/Z,QACvBrB,KAAKib,WAAWnP,KAAKsP,GACrBpb,KAAKkb,cAAcpP,KAAK/L,IAExBC,KAAKqb,QAAQtb,IAGd,YAAAsb,QAAP,SAAetb,GACXC,KAAKsb,QAAUvb,GAGZ,YAAAA,IAAP,WACI,YAAMA,IAAG,WACTC,KAAKub,OAASvb,KAAKwb,WACfxb,KAAKub,QACLvb,KAAKub,OAAO7T,GAAG,EAAAjI,UAAUe,eAAgBR,KAAKyb,eAAgBzb,MAC9DA,KAAKub,OAAO7T,GAAG,EAAAjI,UAAUa,YAAaN,KAAK0b,YAAa1b,MACxDA,KAAKub,OAAOxb,OAEZC,KAAKO,YAGL,YAAAib,SAAR,WACI,GAAIxb,KAAKkB,UAAUW,QAAS,CAExB,IADA,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACtC3G,EAAY,EAAG6E,EAAclC,KAAKib,WAAW5Z,OAAQhE,EAAI6E,EAAK7E,IAAK,CACxE,IAAM+d,EAAYpb,KAAKib,WAAW5d,GAElC,GADe2G,EAAgBqH,gBAAgBrL,KAAKkB,UAAWka,GAE3D,OAAOpb,KAAKkb,cAAc7d,GAGlC,GAAI2C,KAAKsb,QACL,OAAOtb,KAAKsb,UAKhB,YAAAG,eAAR,SAAuB9a,GACfX,KAAKub,QACLvb,KAAKub,OAAOvT,IAAI,EAAAvI,UAAUe,eAAgBR,KAAKyb,eAAgBzb,MAEnEA,KAAKO,YAED,YAAAmb,YAAR,SAAoB/a,GAChBX,KAAKI,QACLJ,KAAKO,YAEb,EA9DJ,CAA4B,EAAAS,UAAf,EAAA2a,U,8ECHb,YACA,QACA,QACA,QACA,QACA,OACA,QACA,OACA,QACA,QACA,QACA,QACA,QACA,QAEA,SAAgBC,EAAwBC,EAAkBrL,GACtD,IAAMsL,EAAQD,EAAMC,MACpB,GAAIA,EACA,IAAK,IAAIze,EAAY,EAAG6E,EAAc4Z,EAAMza,OAAQhE,EAAI6E,EAAK7E,IACzD0e,EAAmBD,EAAMze,GAAImT,GAIzC,SAASuL,EAAmBlU,EAAgB2I,GACxC,GAAI3I,aAAgB,EAAAmT,YAEhBgB,EADgB,EAAOrb,KAAK2K,QACFkF,QACvB,GAAI3I,aAAgB,EAAA8T,OAAQ,CAE/B,IADA,IAAMV,EAAapT,EAAKoT,WACfgB,EAAY,EAAGC,EAAejB,EAAW5Z,OAAQ4a,EAAIC,EAAMD,IAAM,CAEtED,EADYf,EAAWgB,GACDzL,GAE1B,GAAI3I,EAAKqT,cAEL,IADA,IAAMiB,EAAetU,EAAKqT,cACjB7d,EAAY,EAAG6E,EAAcia,EAAa9a,OAAQhE,EAAI6E,EAAK7E,IAAK,CAErEue,EADeO,EAAa9e,GACImT,GAGpC3I,EAAKyT,SACLM,EAAwB/T,EAAKyT,QAAS9K,QAEnC3I,aAAgB,EAAAkT,gBACnBlT,EAAKlH,KAAKjC,OAAS6E,MAAMC,QAAQqE,EAAKlH,KAAKjC,QAC3C0d,EAA2BvU,EAAKlH,KAAKjC,MAAO8R,GAEzC3I,aAAgB,EAAAwU,mBACnBxU,EAAKlH,KAAK3C,MAAQuF,MAAMC,QAAQqE,EAAKlH,KAAK3C,OAC1Coe,EAA2BvU,EAAKlH,KAAK3C,KAAawS,GAElD3I,EAAKlH,MAAQkH,EAAKlH,KAAKwG,QACvBiV,EAA2BvU,EAAKlH,KAAKwG,OAAQqJ,IAE1C3I,aAAgB,EAAAyU,cACnBzU,EAAK0U,SAAWhZ,MAAMC,QAAQqE,EAAK0U,UACnCH,EAA2BvU,EAAK0U,QAAS/L,GAErC3I,aAAgB,EAAAyJ,kBACpBzJ,EAAKlH,MAAQkH,EAAKlH,KAAKsP,QACvB+L,EAAiBnU,EAAKlH,KAAKsP,OAAQO,GAEnC3I,EAAKlH,MAAQkH,EAAKlH,KAAKwG,QACvBiV,EAA2BvU,EAAKlH,KAAKwG,OAAQqJ,IAEzC3I,aAAgB,EAAA2U,UACpB3U,EAAKlH,MAAQkH,EAAKlH,KAAKjC,OACvB0d,EAA2BvU,EAAKlH,KAAKjC,MAAO8R,GAEzC3I,aAAgB,EAAA4U,QACvB5U,EAAKmJ,aAAaR,IACX3I,aAAgB,EAAAoS,iBAChBpS,aAAgB,EAAA6U,qBAChB7U,aAAgB,EAAA8U,oBAChB9U,aAAgB,EAAA+U,eAChB/U,aAAgB,EAAAgV,wBAEnBhV,EAAKlH,MAAQkH,EAAKlH,KAAKwG,QACvBiV,EAA2BvU,EAAKlH,KAAKwG,OAAQqJ,GAIzD,SAASwL,EAAiB1Q,EAAsBkF,GAC5C,GAAKlF,GAAY/H,MAAMC,QAAQ8H,GAG/B,IAAK,IAAI2Q,EAAY,EAAGC,EAAe5Q,EAAQjK,OAAQ4a,EAAIC,EAAMD,IAAK,CAElEG,EADoB9Q,EAAQ2Q,GACYzL,IAGhD,SAAS4L,EAA2BnR,EAA0BuF,GAC1D,GAAIvF,EAAY,KAAO,EAAAxH,gBAAgBI,YAAa,CAChD,IAAMiZ,EAAa7R,EAAY,GAC3BuF,EAASnP,OAASyb,IAClB7R,EAAY,GAAKuF,EAASsM,SAEvB7R,EAAY,KAAO,EAAAxH,gBAAgBG,aAEtCL,MAAMC,QAAQyH,EAAY,KAC1BmR,EAA2BnR,EAAY,GAAIuF,GArFvD,6B,8ZCjBA,WAGA,OAEA,cAMQ,WAAYH,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAoCpB,OA7CmC,OAaxB,YAAAZ,IAAP,WACI,YAAMA,IAAG,WACTC,KAAKyQ,WAAa,EAAAtF,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC/D,IAAMnJ,EAAOgC,KAAKoI,WACZoQ,EAAQxY,KAAK+c,WACf/c,KAAKyQ,YAAczQ,KAAKyQ,WAAW5O,SACnC7B,KAAKyQ,WAAW4D,KAAKrW,EAAMwa,GAG/BxY,KAAKO,YAGD,YAAA6H,SAAR,WACI,GAAI7E,MAAMC,QAAQxD,KAAKW,KAAK3C,QACpBgC,KAAKyQ,YAAczQ,KAAKkB,UAAUW,SAElC,OADwB7B,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKyQ,WAAYzQ,KAAKW,KAAK3C,MAI9E,OAAOgC,KAAKW,KAAK3C,MAEb,YAAA+e,SAAR,WACI,GAAIxZ,MAAMC,QAAQxD,KAAKW,KAAK6X,SACpBxY,KAAKyQ,YAAczQ,KAAKkB,UAAUW,SAElC,OADwB7B,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKyQ,WAAYzQ,KAAKW,KAAK6X,OAI9E,OAAOxY,KAAKW,KAAK6X,OAEzB,EA7CJ,CAAuC,EAAAxX,UAA1B,EAAAqb,qB,8ZCLb,IAIA,cAOQ,WAAYhM,EAAyBkM,EAAyBS,EAAkBrc,GAAhF,MACI,cAAO,K,OAJJ,EAAAqc,QAAkB,KAKrB,EAAK9b,UAAYmP,EACjB,EAAKkM,QAAUA,EACf,EAAK5b,KAAOA,EACRqc,IACA,EAAKA,QAAUA,G,EA8B3B,OA3C+B,OAkBpB,YAAAjd,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,QAAS,CACxB,IAAMob,EAAejd,KAAKkB,UAAUW,QAAQob,aACtCjZ,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBAC3CuY,OAAO,EACX,GAAIhZ,MAAMC,QAAQxD,KAAKuc,SAAU,CAC7B,IAAMW,EAAalZ,EAAgBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKuc,SAExEA,EADAW,QAAmC7a,IAArB6a,EAAWxe,MACfwe,EAAWxe,MAEXwe,OAGdX,EAAUvc,KAAKuc,aAEHla,IAAZka,GACAU,EAAaE,UAAUZ,EAASvc,KAAKgd,QAAShd,KAAKW,MAEvDX,KAAKO,gBAELP,KAAKO,YAIjB,EA3CJ,CAJA,KAImCS,UAAtB,EAAAsb,iB,8ZCJb,WACA,QAIA,cAGQ,WAAYpb,EAAwBP,GAApC,MACI,cAAO,K,OACP,EAAKO,UAAYA,EACjB,EAAKP,KAAOA,E,EAmBpB,OAzB2B,OAShB,YAAAZ,IAAP,W,OAE6B,QAAzB,EAAGC,KAAKkB,UAAUW,eAAO,eAAEmS,OAAOoJ,QAAO,UAAMpd,KAAKoI,YACpDpI,KAAKO,YAGD,YAAA6H,SAAR,WACI,GAAI7E,MAAMC,QAAQxD,KAAKW,KAAKjC,QACpBsB,KAAKkB,UAAUW,QAEf,OADwB7B,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKjC,OAI7E,OAAOsB,KAAKW,KAAKjC,OAEzB,EAzBJ,CAA+B,EAAAsC,UAAlB,EAAAwb,a,8ZCLb,WAGA,OACA,OACA,QAEA,cAQI,WAAYnM,EAAyB1P,GAArC,MACI,cAAO,K,OALH,EAAA0c,YAAsB,EACtB,EAAAC,UAAoB,EACpB,EAAAC,SAAmB,GACnB,EAAAC,UAAsB,GAG1B,EAAKtc,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAgGpB,OA3G6B,OAclB,YAAAZ,IAAP,WACI,YAAMA,IAAG,WACTC,KAAKqd,YAAcrd,KAAKyd,WACxBzd,KAAKsd,WAAa,EACdtd,KAAKwH,WACLxH,KAAKwH,SAASE,GAAG,EAAAjI,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAChEA,KAAKwH,SAASE,GAAG,EAAAjI,UAAUmB,WAAYZ,KAAK8Z,eAAgB9Z,OAEhEA,KAAK0d,YACL1d,KAAK2d,UAGF,YAAAvd,MAAP,WACIJ,KAAKN,YAAa,EACdM,KAAKwH,UACLxH,KAAKwH,SAASvH,OAElBD,KAAKO,YAEF,YAAAA,SAAP,WACIP,KAAK4d,eACL,YAAMrd,SAAQ,YAGX,YAAAyQ,aAAP,SAAoBR,GACZA,GAAYA,EAASnP,SACrBrB,KAAKwd,UAAYhN,IAIjB,YAAAmN,OAAR,WACI,GAAI3d,KAAKqd,YAAc,GAAKrd,KAAKsd,UAAYtd,KAAKqd,YAAc,EAC5D,GAAIrd,KAAKwH,SAAU,CAEf,GADAxH,KAAKsd,YACDtd,KAAKkB,WAAalB,KAAKkB,UAAUW,QAAS,CAC1C,IACMgc,EADkB7d,KAAKkB,UAAUW,QAAQmC,gBAChB4G,kBAAkB5K,KAAKud,UAClDM,IACAA,EAAOnf,MAAQsB,KAAKsd,WAG5Btd,KAAKwH,SAASzH,WAEdC,KAAKO,gBAGTP,KAAKO,YAGL,YAAAkd,SAAR,WACI,GAAIzd,KAAKkB,UAAUW,QAAS,CACxB,IACMic,EADkB9d,KAAKkB,UAAUW,QAAQmC,gBACjBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKmd,OAC5E,OAAIva,MAAMC,QAAQsa,GACPA,EAAMzc,OAENwU,SAASiI,EAAO,IAG/B,OAAO,GAEH,YAAAhE,eAAR,WACI9Z,KAAK2d,UAED,YAAAD,UAAR,WACI,GAAI1d,KAAKkB,WAAalB,KAAKkB,UAAUW,QAAS,CAC1C,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBAGzC8M,EADQ9M,EAAgBiF,gBACN,OAWxB,GAVAjJ,KAAKud,SAAWzM,EACX9M,EAAgBuE,YAAY,EAAAsB,gBAAgBC,aAC7C9F,EAAgBuE,YAAY,EAAAsB,gBAAgBC,WAAa,IAE7D9F,EAAgBuE,YAAY,EAAAsB,gBAAgBC,WAAWgH,GAAW,CAC9D1O,GAAI0O,EACJpQ,KAAM,SACNhC,MAAO,GAGPsB,KAAKwH,SAAU,CACf,IAAMgJ,EAAqBxQ,KAAKwd,UAAU5b,OAAO,CAAC5B,KAAKud,WACvD,EAAA3B,wBAAwB5b,KAAKwH,SAAUgJ,MAI3C,YAAAoN,aAAR,WACI,GAAI5d,KAAKkB,WAAalB,KAAKkB,UAAUW,QAAS,CAC1C,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACzC8M,EAAU9Q,KAAKud,gBACdvZ,EAAgBuE,YAAY,EAAAsB,gBAAgBC,WAAWgH,KAG1E,EA3GA,CAA6B,EAAA7I,eAAhB,EAAAwU,W,8ZCPb,WAGA,OAEA,cAKQ,WAAYpM,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAgCpB,OAxCuC,OAYnC,sBAAW,qBAAM,C,IAAjB,WACI,OAAO,EAAAwK,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,S,gCAEjD,YAAApH,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,QAAS,CACxB,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACzC+Z,EAAY/d,KAAKmH,OAClBmJ,EAAUtQ,KAAKW,KAAK3C,KACrBuF,MAAMC,QAAQ8M,KACdA,EAAUtM,EAAgBE,oBAAoBlE,KAAKkB,UAAWoP,IAElE,IAAM0N,EAAW,GACjB,GAAIhe,KAAKW,KAAKsP,OACV,IAAK,IAAI5S,EAAY,EAAG6E,EAAclC,KAAKW,KAAKsP,OAAO5O,OAAQhE,EAAI6E,EAAK7E,IAAK,CACzE,IAAMuT,EAAQ5M,EAAgBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKsP,OAAO5S,IACnF2gB,EAASlS,KAAK8E,GAGlBmN,GAAazN,GAAWyN,EAAUzN,IAEjCyN,EAAUzN,GAAgCrK,MAAM8X,EAAWC,GAKpEhe,KAAKO,YAEb,EAxCJ,CAA2C,EAAAS,UAA9B,EAAA6b,yB,8ZCJb,WACA,OACA,OAKA,OAGA,cAaI,WAAY3b,EAAwBP,GAApC,MACI,cAAO,K,OALD,EAAA4P,OAAiB,EAMvB,EAAKoJ,eAAgB,EACrB,EAAKhZ,KAAOA,EACZ,EAAKO,UAAYA,EACjB,EAAK0Y,UAAYjZ,EAAK8Q,MACtB,EAAKqC,QAAyB,IAAhBnT,EAAKmT,OACnB,EAAK+F,QAAyB,IAAhBlZ,EAAKkZ,OACnB,EAAKvJ,QAAU3P,EAAK2P,Q,EA+F5B,OApHyC,OAwB9B,YAAAvQ,IAAP,WAGI,GAFA,YAAMA,IAAG,WACTC,KAAK2Z,eAAgB,EACc,IAA/B3Z,KAAKwH,SAASsU,MAAMza,QAAgBrB,KAAKkB,WAAalB,KAAKsQ,QAAS,CACpEtQ,KAAKie,YAAc,CACfvd,KAAM,GACN1C,KAAMgC,KAAKsQ,QACXL,OAAQ,IAGZ,IAAMiO,EACF,IAAI,EAAA5M,iBAAiBtR,KAAKkB,UAAkBlB,KAAKsQ,QAAStQ,KAAKie,aACnEje,KAAKme,QAAUD,EACfle,KAAKwH,SAASM,QAAQoW,GAK1B,GAHIle,KAAKwH,UACLxH,KAAKwH,SAASE,GAAG,EAAAjI,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAEhEA,KAAKkB,UACL,GAAIlB,KAAK8T,QACCjS,EAAW7B,KAAKkB,UAA0BW,UAE5CA,EAAQuO,YAAY1I,GAAG1H,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAEvD,GAAIA,KAAK6Z,OAAQ,CACpB,IAAMhY,KAAW7B,KAAKkB,UAA0BW,UAE5CA,EAAQ6F,GAAG1H,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAG9CA,KAAKyQ,WAAa,EAAAtF,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC3DnH,KAAKyQ,YACLzQ,KAAKyQ,WAAW/I,GAAG1H,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,MAI9DA,KAAKO,YAIF,YAAAN,KAAP,WAGI,GAFAD,KAAKO,WAEDP,KAAKyQ,WACL,GAAIzQ,KAAK8T,QACCjS,EAAW7B,KAAKyQ,WAA2B5O,UAE7CA,EAAQuO,YAAYpI,IAAIhI,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAExD,GAAIA,KAAK6Z,OAAQ,CACpB,IAAMhY,KAAW7B,KAAKyQ,WAA2B5O,UAE7CA,EAAQmG,IAAIhI,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,WAG/CA,KAAKyQ,WAAWzI,IAAIhI,KAAK4Z,UAAW5Z,KAAK+Z,SAAU/Z,MAGvDA,KAAKwH,WACLxH,KAAKwH,SAASQ,IAAI,EAAAvI,UAAUe,eAAgBR,KAAK8Z,gBACjD9Z,KAAKwH,SAASjH,YAGlB,YAAMN,KAAI,YAEP,YAAAG,MAAP,WACIJ,KAAKO,WACL,YAAMH,MAAK,YAGL,YAAA0Z,eAAV,WACI9Z,KAAK2Z,eAAgB,GAGf,YAAAK,eAAV,SAAyBvC,GACjBA,EAAIzH,OAAShQ,KAAK4Z,WAClB5Z,KAAK+Z,SAAStC,IAIZ,YAAAsC,SAAV,W,IAAmB,sDACX/Z,KAAKL,YAGLsQ,GAAUA,EAAO5O,OAAS,GAAKrB,KAAKie,cACpCje,KAAKie,YAAYhO,OAASA,GAE1BjQ,KAAKwH,UAAYxH,KAAK2Z,gBACtB3Z,KAAK2Z,eAAgB,EACrB3Z,KAAKwH,SAASzH,SAG1B,EApHA,CAAyC,EAAAkI,eAA5B,EAAAyU,uB,8ZCXb,WAGA,OAGA,cASQ,WAAYxb,EAAwBP,GAApC,MACI,cAAO,K,OACP,EAAKgZ,eAAgB,EACrB,EAAKzY,UAAYA,EACjB,EAAKP,KAAOA,EACZ,EAAKiZ,UAAYjZ,EAAK8Q,MACtB,EAAKqC,QAAyB,IAAhBnT,EAAKmT,OACnB,EAAK+F,QAAyB,IAAhBlZ,EAAKkZ,O,EAyB3B,OAzCoC,OAmBzB,YAAA9Z,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UACL,GAAIlB,KAAK8T,QACCjS,EAAW7B,KAAKkB,UAA0BW,UAE5CA,EAAQuO,YAAYpI,IAAIhI,KAAK4Z,gBAE9B,GAAI5Z,KAAK6Z,OAAQ,CACpB,IAAMhY,KAAW7B,KAAKkB,UAA0BW,UAE5CA,EAAQmG,IAAIhI,KAAK4Z,gBAGrB5Z,KAAKyQ,WAAa,EAAAtF,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC3DnH,KAAKyQ,YACLzQ,KAAKyQ,WAAWzI,IAAIhI,KAAK4Z,WAIrC5Z,KAAKO,YAEb,EAzCJ,CAAwC,EAAAS,UAA3B,EAAA2b,sB,8ZCNb,WAMA,OAEA,cAWQ,WAAYzb,EAAwBP,GAApC,MACI,cAAO,K,OACP,EAAKO,UAAYA,EACjB,EAAKP,KAAOA,EACZ,EAAKiZ,UAAYjZ,EAAK8Q,MACtB,EAAK2M,UAAYzd,EAAKyd,UACtB,EAAKtK,QAAyB,IAAhBnT,EAAKmT,OACnB,EAAK+F,QAAyB,IAAhBlZ,EAAKkZ,O,EAyD3B,OA3E+B,OAqBpB,YAAA9Z,IAAP,WACI,YAAMA,IAAG,WACF,IAAAmB,EAAA,KAAAA,UACP,GAAIA,EAAW,CACX,IAAMmd,EAAgBre,KAAKse,mBAC3B,GAAIte,KAAK8T,QACL,GAAI5S,EAAUW,QAAS,CACnB,IAAMuO,EAAclP,EAAUW,QAAQuO,YACT,iBAAlBiO,GACNA,EAAyB3d,KAAOV,KAAK4Z,UACf,YAAnB5Z,KAAK4Z,WACLxJ,EAAY/P,KAAKL,KAAK4Z,UAAWyE,GAErCjO,EAAY/P,KAAK,UAAmBge,IAEpCjO,EAAYhE,UAAU,QAAS,CAACpM,KAAK4Z,UACLnK,KAAKC,UAAU2O,IAAiB,UAAoBre,YAGrFA,KAAK6Z,OACR3Y,EAAUW,SACVX,EAAUW,QAAQxB,KAAKL,KAAK4Z,UAAWyE,IAG3Cre,KAAKmH,OAAS,EAAAgE,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QACvDnH,KAAKmH,QACLnH,KAAKmH,OAAO9G,KAAKL,KAAK4Z,UAAWyE,IAK7Cre,KAAKO,YAGF,YAAAN,KAAP,WACID,KAAKO,WACL,YAAMN,KAAI,YAEP,YAAAG,MAAP,WACIJ,KAAKO,WACL,YAAMH,MAAK,YAEP,YAAAke,iBAAR,WACI,GAAI/a,MAAMC,QAAQxD,KAAKoe,YACfpe,KAAKkB,UAAW,CAChB,IAAMW,EAAW7B,KAAc,UAAE6B,QACjC,GAAIA,EAEA,OADaA,EAAQmC,gBAAgBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKoe,WAK1F,OAAOpe,KAAKoe,WAEpB,EA3EJ,CAAmC,EAAApd,UAAtB,EAAA4b,iB,8ZCRb,IAIA,cAKI,mBACI,cAAO,K,OAHH,EAAA2B,eAAyB,EACzB,EAAAC,UAAoB,EAGxB,EAAKC,UAAY,G,EA+DzB,OAtEmC,OAUxB,YAAAC,aAAP,WAEI1e,KAAK2e,SAAW,EAChB3e,KAAK4e,eAAYvc,GAGX,YAAAwc,YAAV,SAAsBC,EAAa9X,EAAaC,EAAakB,GACzD,YADyD,IAAAA,MAAA,MAClD2W,GAGD,YAAAC,eAAV,WACQ/e,KAAKgf,OAAO3d,QAIV,YAAA4d,eAAV,WACIjf,KAAKye,UAAUpd,OAAS,EACG,IAAvBrB,KAAKgf,OAAO3d,cAGOgB,IAAnBrC,KAAK4e,YACL5e,KAAK4e,UAAY5e,KAAKgf,OAAO,GAC7Bhf,KAAKue,eAAiB,GAGtBve,KAAKkf,SAAWlf,KAAK2e,SACjB3e,KAAKkf,QAAUlf,KAAK4e,UAAU1W,MAC9BlI,KAAKmf,WAAWnf,KAAKue,gBAAgB,GAGzCve,KAAKmf,WAAW,GAAG,KAInB,YAAAA,WAAR,SAAmBC,EAAoBC,GACnC,QADmC,IAAAA,OAAA,GAC/BA,EACA,IAAK,IAAIhiB,EAAI2C,KAAKue,eAAgBrc,EAAclC,KAAKgf,OAAO3d,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC9E,IAAMkb,EAAQvY,KAAKgf,OAAO3hB,GAC1B2C,KAAKsf,SAAS/G,GAGtB,IAASlb,EAAI+hB,EAAYld,EAAclC,KAAKgf,OAAO3d,OAAQhE,EAAI6E,EAAK7E,IAAK,CAErE,IADMkb,EAAQvY,KAAKgf,OAAO3hB,IAChB6K,KAAOlI,KAAKkf,UAAYG,GAAY9G,EAAMrQ,MAAQlI,KAAK2e,UAC7D3e,KAAKsf,SAAS/G,QACX,GAAIA,EAAMrQ,KAAOlI,KAAKkf,QAAS,CAClClf,KAAK4e,UAAYrG,EACjBvY,KAAKue,eAAiBlhB,EACtB,MAEJ2C,KAAKue,eAAiB/D,OAAOC,YAG7B,YAAA6E,SAAR,SAAiB/G,GACb,GAAIA,EAAM7Z,MACN,IAAK,IAAIud,EAAY,EAAGC,EAAe3D,EAAM7Z,MAAM2C,OAAQ4a,EAAIC,EAAMD,IACjEjc,KAAKye,UAAU3S,KAAKyM,EAAM7Z,MAAMud,KAIhD,EAtEA,CAJA,MAImCsD,UAAtB,EAAAC,iB,8ECFb,WAEA,aAiCQ,aAjBO,KAAA9e,KAAqB,KACrB,KAAAse,OAA0B,GAC1B,KAAAE,QAAkB,EAClB,KAAAP,SAAmB,EACnB,KAAAc,MAAgB,EAChB,KAAAC,UAAoB,EACjB,KAAAC,cAAmB,KACnB,KAAAC,YAAsB,EAEtB,KAAAC,gBAA0B,EAC1B,KAAAC,WAA8B,KAC9B,KAAAC,UAA6B,KAC7B,KAAAC,WAAuB,KACvB,KAAAC,QAAkB,EAElB,KAAAxB,UAAe,KAkE7B,OA/FI,sBAAW,2BAAY,C,IAAvB,SAAwB/f,GACpBsB,KAAK2f,cAAgBjhB,EACrBsB,KAAKye,UAAY/f,G,gCAErB,sBAAW,uBAAQ,C,IAAnB,WACI,OAAOsB,KAAKye,W,gCAGhB,sBAAW,yBAAU,C,IAArB,SAAsBjV,GAClBxJ,KAAK4f,YAAcpW,EACnBxJ,KAAKkgB,OACLlgB,KAAK6f,gBAAkBrW,G,gCAwBjB,YAAAqV,YAAV,SAAsBC,EAAa9X,EAAaC,EAAakB,QAAA,IAAAA,MAAA,MACzD,IAAIgY,EAAuB,EACvBC,EAAwB,EAO5B,GADAA,EAJID,EADAlZ,IAAQD,EACQ,GAEC8X,EAAM9X,IAAQC,EAAMD,GAGrCmB,GAASA,EAAM9G,QACM,IAAjB8G,EAAM9G,OAAc,CACpB,IAAMgf,EAAYlY,EAAM,GACxBiY,EAAgB,EAAAE,iBAAiBD,EAAWF,GAIpD,OAAOC,GAGD,YAAAF,KAAV,WACIlgB,KAAKkf,QAAUlf,KAAK4f,YAChB5f,KAAKyf,OACLzf,KAAKigB,OAAS3b,KAAKuE,MAAM7I,KAAKkf,QAAUlf,KAAK0f,WAC7C1f,KAAKkf,QAAUlf,KAAKkf,QAAUlf,KAAK0f,UAAY1f,KAAKigB,QAExDjgB,KAAK+e,iBACL/e,KAAKif,iBACLjf,KAAK2e,SAAW3e,KAAKkf,SAEf,YAAAH,eAAV,WACI,GAA2B,IAAvB/e,KAAKgf,OAAO3d,OAAhB,CAGArB,KAAK8f,WAAa9f,KAAK+f,UACvB,IACI7d,EADA7E,EAAY,EAEhB,IAAKA,EAAI,EAAG6E,EAAMlC,KAAKgf,OAAO3d,OAAQhE,EAAI6E,EAAK7E,IAC3C,GAAI2C,KAAKgf,OAAO3hB,GAAG6K,KAAOlI,KAAKkf,QAQ3B,YAPU,IAAN7hB,GACA2C,KAAK+f,UAAY,KACjB/f,KAAKggB,WAAahgB,KAAKgf,OAAO3hB,KAE9B2C,KAAK+f,UAAY/f,KAAKgf,OAAO3hB,EAAI,GACjC2C,KAAKggB,WAAahgB,KAAKgf,OAAO3hB,KAK1C2C,KAAK+f,UAAY/f,KAAKgf,OAAOhf,KAAKgf,OAAO3d,OAAS,GAClDrB,KAAKggB,WAAahgB,KAAK+f,YAGjB,YAAAd,eAAV,WACI,GAAIjf,KAAK+f,WAAa/f,KAAKggB,WAAY,CACnC,IAAMzgB,EAAIS,KAAK6e,YAAY7e,KAAKkf,QAASlf,KAAK+f,UAAU7X,KAC7BlI,KAAKggB,WAAW9X,KAAMlI,KAAK+f,UAAU5X,OAEhEnI,KAAKye,UAAYze,KAAK+f,UAAU3X,SAAS7I,EAAGS,KAAKggB,WAAWthB,SAGxE,EAjGJ,GAAa,EAAA6gB,Y,8ECAb,wBAA6BgB,GACzB,OAAOA,GACH,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,OACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,MACL,IAAK,MACL,IAAK,UACD,OAAO,EACX,IAAK,MACL,IAAK,MACL,IAAK,MACD,OAAO,EACX,IAAK,MACL,IAAK,OACL,IAAK,MACD,OAAO,EACX,IAAK,OACD,OAAO,EACX,QACI,OAAO,K,68CC1BnB,YAiCA,mBAA2CC,EAAa9J,EAAY+J,EAAqBC,G,2EA9BzF,IAEU3b,EAkCN,YAjCiB1C,KADX0C,EAAIzH,QACLqjB,UACD5b,EAAE4b,QAAU,mBAECte,IAAd0C,EAAE/H,UACD+H,EAAE/H,QAAU,SAEAqF,IAAb0C,EAAE9H,SACD8H,EAAE9H,OAAS,SAESoF,IAArB0C,EAAE9H,OAAOD,UACR+H,EAAE9H,OAAOD,QAAU,IAsBjB4jB,EAAa/f,GAAGsD,IAClBsc,GAAcG,EAAWH,GAClB,CAAP,EAAOG,EAAWH,KAGlBI,EAAmB,GAEhB,CAAP,EAAO,IAAIC,SAAQ,SAACC,EAASC,GAEzB,IAAIC,EAAiB,EAEfC,EAAa,SAAUjT,GACzB,IAAIzO,EAAI2hB,SAASC,cAAc,UAC/B5hB,EAAE6hB,OAAQ,EACV7hB,EAAE4U,IAAgB,IAAVnG,EAAcuS,EAAM,EAAAc,OAAOd,EAAK,GAAI9J,EAAMzI,EAAQ,GAC1DzO,EAAE+hB,iBAAiB,OAAQC,GAAc,GACzChiB,EAAE+hB,iBAAiB,QAASE,GAAW,GACvCN,SAASO,KAAKrL,YAAY7W,IAGxBgiB,EAAe,SAAmCpK,GAKpD,GAJAuK,EAAY3hB,MACR0gB,GACAA,IAEDD,EAAW,CACV,IACM,EADInjB,OACQL,OAAOD,QACzB,OAAG,EAAQsC,eAAemhB,IACtBG,EAAWH,GAAc,EAAQA,GAC1BM,EAAQH,EAAWH,KAEvBM,GAAQ,GAEnBA,GAAQ,IAENU,EAAY,SAAmCrK,GACjDuK,EAAY3hB,MACRihB,EAAiB,EACjBD,EAAO,CAAEhR,KAAM,MAAOE,MAAO,QAAkBvP,KAAM,CAACkgB,EAAUnU,KAAK,WAEhC,IAAjCmU,EAAUnG,QAAQ1a,KAAKoU,MACvByM,EAAU/U,KAAK9L,KAAKoU,KAExB8M,EAAW,GACXD,MAGFU,EAAc,SAAUC,GAC1BA,EAAQC,WAAW5I,YAAY2I,GAC/BA,EAAQE,oBAAoB,OAAQN,GAAc,GAClDI,EAAQE,oBAAoB,QAASL,GAAW,IAGpDP,EAAW,gB,8EC/FnB,YACA,QAiBA,SAAgBa,EAAUvB,EAAa9J,EAAWzI,GAC9C,QAD8C,IAAAA,MAAA,GACjB,IAAzBuS,EAAI9F,QAAQ,SACZ,OAAO8F,EAEX,IACIwB,EACJ,OAFa,EAAAC,aAAa,EAAAC,iBAAiB1B,KAGvC,KAAK,EACDwB,EAAMtL,EAAKyL,MACX,MACJ,KAAK,EACL,KAAK,EACDH,EAAMtL,EAAK0L,MACX,MACJ,QACIJ,EAAMtL,EAAKC,QAQnB,OANAqL,EAAMA,EAAI1d,KAAK2C,IAAIgH,EAAO+T,EAAI3gB,OAAS,GAAK2gB,EAAI3gB,SACnB,IAAzBmf,EAAI9F,QAAQ,SAAwC,IAAtB8F,EAAI9F,QAAQ,MAC1CsH,GAAOxB,EAAItJ,OAAOsJ,EAAI9F,QAAQ,IAAK8F,EAAI9F,QAAQ,OAE/CsH,GAAOxB,EAEJwB,EApCX,kBAAuBxB,EAAa6B,EAAc3L,EAAYzI,GAU1D,YAVgC,IAAAoU,MAAA,SAA0B,IAAApU,MAAA,GAE1C,KAAZoU,IAC6B,IAAzB7B,EAAI9F,QAAQ,UAAyC,IAAvB8F,EAAI9F,QAAQ,QAC1C8F,EAAM6B,EAAU7B,GAGpB9J,IACA8J,EAAMuB,EAAUvB,EAAK9J,EAAMzI,IAExBuS,GAGX,e,8ECVA,iBAMI,WAAY8B,EAAmBC,GAC3BviB,KAAKoC,GAAKkgB,EACVtiB,KAAKuiB,OAASA,EACdviB,KAAKwiB,OAAS,OAqCtB,OAlCW,YAAA/L,KAAP,SAAY9V,GACR,GAAoB,SAAhBX,KAAKwiB,OAMT,OAHAxiB,KAAKyiB,OAAO9hB,GACZX,KAAKwiB,OAAS,QACdxiB,KAAKuiB,OAAOG,MAAMC,IAAI3iB,KAAKoC,GAAIpC,MACxBA,MAGJ,YAAA4iB,QAAP,WACwB,SAAhB5iB,KAAKwiB,SAGTxiB,KAAK6iB,YACL7iB,KAAKuiB,OAAOG,MAAMI,OAAO9iB,KAAKoC,IAC9BpC,KAAKuiB,OAAS,KACdviB,KAAKwiB,OAAS,SAMR,YAAAC,OAAV,SAAiB9hB,KAOP,YAAAkiB,UAAV,aAIJ,EA9CA,GAAa,EAAAE,Q,45CCgBb,SAASC,EAAW7b,GAChB,IAAM8b,EAAM9b,EAEZ,KAAuB,IAAnB8b,EAAI/N,YAAoB+N,EAAIT,QAAU,KAA1C,CAEA,IAAM7O,EAAc,CAChB3D,KAAM,IACNE,MAAO,UACPwE,aAASrS,EACT1B,KAAK,MAGT,IACI,IAAMuiB,EAAWD,EAAIC,UAAYD,EAAIE,aAErC,OAAQF,EAAIrM,cACR,IAAK,QA9BjB,SAAmBwM,EAAW5W,GAE1B,IACIA,EAAO7L,KAA0B,iBAAVyiB,EAAsB3T,KAAKE,MAAMyT,GAAQA,EAGpE,MAAOhM,GAIH,OAHA5K,EAAOwD,KAAO,QACdxD,EAAO0D,MAAQ,QACf1D,EAAO7L,KAAOyW,EACP5K,GAqBC6W,CAAUH,EAASvP,GACnB,MACJ,QACIA,EAAIhT,KAAOuiB,EAGnB,OAAOvP,EAET,MAAO2P,GAIL,OAHA3P,EAAI3D,KAAO,QACX2D,EAAIzD,MAAQ,QACZyD,EAAIhT,KAAOsiB,EAAIM,YAAa,MAAOD,EAC5B3P,IAMf,SAASmO,EAAuEmB,EAAqBO,GAC7FA,IACAA,EAASC,SAAQ,SAAC/kB,GACdukB,EAAInB,oBAAoBpjB,EAAM,GAAIA,EAAM,OAE5C8kB,EAASniB,OAAS,GAEtB4hB,EAAIS,OAAS,KACbT,EAAIU,QAAU,KACdV,EAAIW,mBAAqB,KAkC7B,SAAwBC,EAAgErD,EAAapN,EAAuBoQ,GAExH,YAFiG,IAAApQ,MAAA,IAE1F,IAAI0N,SAAa,SAACC,EAASC,GAE9B,IAAM8C,EAAa,CAAChF,IAAI,EAAE7X,IAAImM,EAAQ0Q,YAAc,GAC9Cb,EAAM,IAAIc,eAEVC,EAAS5Q,EAAQ4Q,QAAU,MACjCf,EAAIgB,QAAU7Q,EAAQ6Q,SAAW,EACjChB,EAAIrM,aAAexD,EAAQwD,cAAgB,OAEvC4M,GACAA,EAASC,SAAQ,SAAC/kB,GACdukB,EAAI1B,iBAAiB7iB,EAAM,GAAIA,EAAM,OAI7CukB,EAAIS,OAAS,SAACjM,GACV,IAAM9D,EAAMqP,EAAWvL,EAAItQ,QAC3B,GAAIwM,EACA,MAAiB,UAAdA,EAAIzD,MACI8Q,EAAOrN,IAEdmO,EAAoBmB,EAAKO,GAClBzC,EAAQpN,EAAIhT,QAK/BsiB,EAAIW,mBAAqB,SAACnM,GACtB,IAAMwL,EAAMxL,EAAIyM,cAChB,IAAwB,IAAnBjB,EAAI/N,YAAuC,IAAnB+N,EAAI/N,aAAqB+N,EAAIT,QAAU,IAAK,CACrE,GAAIsB,EAAWhF,KAAOgF,EAAW7c,IAE7B,OADA6a,EAAoBmB,EAAKO,GAClBxC,EAAO,CAAChR,KAAM,QAAQE,MAAO,QAAiBvP,KAAM,CAACsiB,EAAIM,YAAYN,EAAIT,UAEpFsB,EAAWhF,MACXmE,EAAIkB,QACJlB,EAAImB,KAAKJ,EAAQxD,GAAI,GACrByC,EAAIoB,SAIZpB,EAAIU,QAAU,SAAClM,GACX,IAAMwL,EAAMxL,EAAIyM,cAChB,GAAIJ,EAAWhF,KAAOgF,EAAW7c,IAE7B,OADA6a,EAAoBmB,EAAKO,GAClBxC,EAAO,CAAChR,KAAM,QAAQE,MAAO,QAAiBvP,KAAM,CAACsiB,EAAIM,YAAYN,EAAIT,UAEpFsB,EAAWhF,MACXmE,EAAIkB,QACJlB,EAAImB,KAAKJ,EAAQxD,GAAI,GACrByC,EAAIoB,QAGRpB,EAAImB,KAAKJ,EAAQxD,GAAI,GACrByC,EAAIoB,U,iDA7EZ,2BAAyF7D,EAAa9J,EAAgBtD,EAAuBoQ,G,YAAvB,IAAApQ,MAAA,I,sGAC9F,IAAhBsD,EAAKrV,OAAL,MACO,GAAMwiB,EAAarD,EAAKpN,EAASoQ,I,OAAxC,MAAO,CAAP,EAAO,U,WAIS,EAAA9M,E,wBAAA,WACH,GAAMmN,GADP,MAC+B,IAAMrD,EAAKpN,EAASoQ,GAAU3M,OAAM,SAACyM,GAAiBhQ,EAAMgQ,MADnF,M,OAEpB,GADM3iB,EAAO,SAET,MAAO,CAAP,EAAOA,G,wBAHK,I,aAMpB,MAAO,CAAP,EAAO,IAAImgB,SAAQ,SAACC,EAASC,GAAYA,EAAO1N,eASpD,a,0ICtGA,OAEA,IAAMvO,EAAKzH,YAEE+E,IAAT0C,EAAElE,KACFkE,EAAElE,GAAK,IAEXkE,EAAElE,GAAGyjB,OAAStkB,M,8ZCNd,IAaKukB,EAbL,OACA,QAEA,QACA,OAEA,SAOA,SAAKA,GACD,mBACA,yBACA,qBACA,yBACA,uBACA,mBANJ,CAAKA,MAAY,KASjB,kBAoBI,WAAY5jB,EAAiBqT,EAAgBsQ,GAA7C,MACI,YAAMtQ,EAAOlR,MAAOkR,EAAOjR,SAAO,K,OAhB/B,EAAAyhB,IAAc,GAML,EAAA9B,MAAQ,IAAI+B,IAIpB,EAAAjC,OAAuB+B,EAAaG,KAOxC,EAAK/jB,KAAOA,EACZ,EAAKmC,MAAQkR,EAAOlR,MACpB,EAAKC,OAASiR,EAAOjR,OACrB,EAAKiR,OAASA,EACd,EAAKsQ,OAASA,EACdzjB,GAAGsD,IAAIwgB,MAAMvH,MAAQpJ,EAAOoJ,MAE5B,EAAKwH,IAAM,IAAI,EAAAC,IAAI,GACnB,EAAK7gB,gBAAkB,IAAI,EAAA6F,gBAC3B,EAAKoT,aAAe,IAAI,EAAA6H,aAAa,EAAKF,IAAK,GAC/C,EAAKG,MAAQ,IAAIlkB,GAAGsD,IAAI6gB,MAExB,IAAIC,EAAMC,U,EAwMlB,OA1O6B,OAqCzB,sBAAW,0BAAW,C,IAAtB,WACG,OAAOllB,KAAKgU,OAAO5D,a,gCAOf,YAAA+U,SAAP,SAAgBxR,QACOtR,IAAhBsR,EAAIe,UACHf,EAAIe,QAAU,IAEff,EAAIxM,QAAUwM,EAAIxM,OAAc,QAC/BwM,EAAIe,SAAY,UAAWf,EAAIxM,OAAW,GAAC,cAAewM,EAAIxM,OAAc,OAEhFnH,KAAKskB,OAAO3P,WAAWhB,IAGpB,YAAA8B,MAAP,WAEQzV,KAAKwC,KACLxC,KAAKwC,IAAI4iB,OAAOC,IAAIrlB,KAAKslB,kBAAmBtlB,MAKhDA,KAAKwiB,OAAS+B,EAAagB,QAC3BvlB,KAAK4kB,IAAIld,GAAG,eAAyB1H,KAAKwlB,mBAAoBxlB,MAC9DA,KAAK4kB,IAAIld,GAAG,eAAyB1H,KAAKylB,aAAczlB,MAExDA,KAAK4kB,IAAIrQ,SAASvU,KAAKW,OAEpB,YAAAT,MAAP,WACQF,KAAK+B,WACL/B,KAAKwiB,OAAS+B,EAAamB,OAC3B1lB,KAAK+B,SAAS7B,QACdF,KAAKid,aAAa/c,UAGnB,YAAAC,OAAP,WACQH,KAAK+B,WACL/B,KAAK+B,SAAS5B,SACdH,KAAKid,aAAa9c,SAClBH,KAAKwiB,OAAS+B,EAAaoB,UAI5B,YAAAlR,MAAP,WACQzU,KAAKwiB,SAAW+B,EAAaG,MAC7B1kB,KAAKwiB,SAAW+B,EAAagB,UAG7BvlB,KAAK+B,WACL/B,KAAK+B,SAASsF,UACdrH,KAAK+B,cAAWM,GAEpBrC,KAAKgE,gBAAgBgF,QACrBhJ,KAAKid,aAAajU,QAClBhJ,KAAK4lB,gBAEF,YAAAve,QAAP,WAEIrH,KAAKyZ,aAEDzZ,KAAK+B,UACL/B,KAAK+B,SAASsF,UAEdrH,KAAK+kB,OACL/kB,KAAK+kB,MAAMnC,UAKX5iB,KAAKwC,KAAOxC,KAAKwC,IAAI4iB,SACrBplB,KAAKwC,IAAI4iB,OAAOS,OAAO7lB,KAAKslB,kBAAmBtlB,MAC/CA,KAAKwC,IAAI4iB,OAAOnlB,QAGhBD,KAAK4kB,MACL5kB,KAAK4kB,IAAI5c,IAAI,eAAyBhI,KAAKwlB,mBAAoBxlB,MAC/DA,KAAK4kB,IAAI5c,IAAI,eAAyBhI,KAAKylB,aAAczlB,MACzDA,KAAK4kB,IAAIxP,UACTpV,KAAK4kB,IAAM,MAEf5kB,KAAK0iB,MAAMe,SAAQ,SAAC/kB,GAChBA,EAAMkkB,cAKP,YAAA5gB,YAAP,WACI,OAAOhC,KAAK+B,UAGT,YAAA6S,kBAAP,SAAyBC,GACrB,GAAI7U,KAAK+B,SAAU,CACf,IAAM+jB,EAAa9lB,KAAK+B,SAASK,GAC3B2jB,EAAY/lB,KAAK4kB,IAAIoB,gBAAgBF,EAAY9lB,MACnD+lB,GACA/lB,KAAKimB,cAAcF,EAAWlR,KAKnC,YAAAC,kBAAP,SAAyBD,GACrB,GAAI7U,KAAK+B,SAAU,CACf,IAAM+jB,EAAa9lB,KAAK+B,SAASK,GAC3B8jB,EAAYlmB,KAAK4kB,IAAIuB,gBAAgBL,EAAY9lB,MACnDkmB,GACAlmB,KAAKimB,cAAcC,EAAWrR,KAKnC,YAAAE,gBAAP,SAAuBC,EAAiBH,GACpC,IAAMuR,EAAQpmB,KAAK4kB,IAAIgB,YAAY5Q,EAAShV,MACxComB,GACApmB,KAAKimB,cAAcG,EAAOvR,IAI1B,YAAAoR,cAAR,SAAsBG,EAAgBvR,GAClC,GAAIuR,GAASpmB,KAAKwC,IAAK,CACnB,IAAI6jB,EAAiBxR,EACjBhQ,OAAW,EACX7E,KAAK+B,YACD/B,KAAK+B,SAAS8S,YAAcwR,KACN,MAAlBA,IACAA,EAAiBrmB,KAAK+B,SAAS8S,YAEnChQ,EAAc,EAAAyhB,cAActmB,KAAKwC,IAAKxC,KAAKyC,UAAWzC,KAAKyC,UAAUK,MAAO9C,KAAKyC,UAAUM,SAE/F/C,KAAKiZ,YAAYjZ,KAAK+B,UACtB/B,KAAK+B,SAASsF,WAElBrH,KAAK+B,SAAWqkB,EAChBpmB,KAAK+B,SAASe,MAAQ9C,KAAK8C,MAC3B9C,KAAK+B,SAASgB,OAAS/C,KAAK+C,OAC5B/C,KAAKuW,SAAS6P,GACVC,GAAkBxhB,EAClB,EAAA0hB,gBAAgBvmB,KAAM6E,EAAawhB,IAEnCrmB,KAAKK,KAAK,mBACVL,KAAKK,KAAK,oBAKd,YAAAmlB,mBAAR,SAA2BpO,GACvBpX,KAAKoQ,YAAY/P,KAAK,SAAkB,CACpC2P,KAAM,eAAyBE,MAAO,SAAmBvP,KAAM,OAGnEX,KAAKwiB,OAAS+B,EAAaiC,MAC3BxmB,KAAK4lB,cACL5lB,KAAKymB,cACLzmB,KAAKoQ,YAAY/P,KAAK,SAAkB,CACpC2P,KAAM,cAA0BE,MAAO,SAAmBvP,KAAM,QAIhE,YAAA8kB,aAAR,SAAqBrO,GACjBpX,KAAKoQ,YAAY/P,KAAK,SAAkB,CACpC2P,KAAM,eAAyBE,MAAO,SAAmBvP,KAAMyW,KAI/D,YAAAqP,YAAR,WAEI,IADA,IACoB,MADDzmB,KAAKgU,OAAO0O,MACX,eAAW,CAA1B,IAAMhkB,EAAK,KACNgoB,EAAezB,EAAcvmB,EAAM0D,IACzC,GAAIskB,EACoB,IAAIA,EAAWhoB,EAAM0D,GAAIpC,MACxCyW,KAAK/X,KAMd,YAAAknB,YAAR,WAEI,IAAMQ,EAAQpmB,KAAK4kB,IAAI+B,iBAAiB3mB,MACpComB,IACApmB,KAAK+B,SAAWqkB,EAChBpmB,KAAKuW,SAAS6P,IAElBpmB,KAAKwiB,OAAS+B,EAAaoB,SAGvB,YAAAL,kBAAR,SAA0BsB,GAClB5mB,KAAKwC,KACL3B,GAAGsD,IAAI0iB,aAAaC,OAAOF,EACvB5mB,KAAKwC,IAAI4iB,OAAOzG,SAChB3e,KAAKwC,IAAI4iB,OAAO2B,YAIhC,EA1OA,CAA6BlmB,GAAGsD,IAAI6iB,OAAvB,EAAA1Q,W,8ECnBb,YACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QAKA,aAKI,WAAYzU,EAAkBgD,EAA+BlE,GACzDX,KAAK6B,QAAUA,EACf7B,KAAK6E,YAAcA,EACnB7E,KAAKW,KAAOA,EA6DpB,OA1DW,YAAAZ,IAAP,WACI,IAAM8U,EAAa7U,KAAKinB,cAAcjnB,KAAKW,KAAKD,MAChD,GAAImU,EAAY,CACZ,IAAM,EAAc7U,KAAK6B,QAAQuO,YACjCyE,EAAWhO,mBAAmB7G,KAAK6E,aACnCgQ,EAAW9N,SAAW,EACtB8N,EAAW3N,iBAAiBlH,KAAK6B,QAAQY,WACzC,IAAMsiB,EAAQ/kB,KAAK6B,QAAQkjB,MAC3BA,EAAMmC,UAAUrS,GAChBkQ,EAAMjT,KAAKjR,GAAGsD,IAAI6gB,MAAMmC,MAAM5mB,UAAU,WACpCsU,EAAWxN,UACX,EAAYhH,KAAK,SAAkB,CAC/B2P,KAAM,gBAA0BE,MAAO,SAAmBvP,KAAM,UAGxEokB,EAAMqC,GAAG,CAACrgB,SAAU,GAAI/G,KAAKW,KAAK0mB,UAAU5R,QAC5C,EAAYpV,KAAK,SAAkB,CAC/B2P,KAAM,kBAA4BE,MAAO,SAAmBvP,KAAM,SAKtE,YAAAsmB,cAAR,SAAsBvmB,G,MAClB,GAAIV,KAAK6B,UACmB,IAAxB7B,KAAK6B,QAAQylB,QAAwC,IAAxBtnB,KAAK6B,QAAQ0lB,UACxB,QAAhB,EAAAvnB,KAAK6B,QAAQW,WAAG,eAAEW,SAASwO,SAAgB6V,cAC7C,OAAO,IAAI,EAAAC,YAEf,OAAQ/mB,GACJ,IAAK,OACD,OAAO,KACX,IAAK,UACD,OAAO,IAAI,EAAAgnB,gBACf,IAAK,aACD,OAAO,IAAI,EAAAC,iBACf,IAAK,YACD,OAAO,IAAI,EAAAC,gBACf,IAAK,aACD,OAAO,IAAI,EAAAC,iBACf,IAAK,YACD,OAAO,IAAI,EAAAC,gBACf,IAAK,aACD,OAAO,IAAI,EAAAC,iBACf,IAAK,WACD,OAAO,IAAI,EAAAC,eACf,IAAK,SACD,OAAO,IAAI,EAAAC,aACf,IAAK,OACD,OAAO,IAAI,EAAAC,WACf,IAAK,eACD,OAAO,IAAI,EAAAC,mBACf,IAAK,gBACD,OAAO,IAAI,EAAAC,oBACf,QACI,OAAO,KAEf,OAAO,MAEf,EArEA,GAAa,EAAAtjB,c,8ZCpBb,IAEA,cAiBQ,a,OACI,YAAM,GAAI4iB,EAAgB7hB,cAAY,KAE9C,OApBiC,OAEL,EAAAA,YAAsB,ggBAkBlD,EApBJ,CAFA,KAEqCE,gBAAxB,EAAA2hB,mB,8ZCFb,IAEA,cA+BQ,a,OACI,YAAM,GAAIC,EAAiB9hB,cAAY,KAE/C,OAlCkC,OAEN,EAAAA,YAAsB,k9BAgClD,EAlCJ,CAFA,KAEsCE,gBAAzB,EAAA4hB,oB,8ZCFb,WAWA,cA4EQ,a,OACI,YAAM,EAAA5hB,eAAeH,UAAWgiB,EAAgB/hB,YAAa+hB,EAAgBS,qBAAmB,KAExG,OA/EiC,OAEL,EAAAA,mBAAqB,CACzC7hB,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,EACjBuhB,SAAiB,IAGG,EAAAziB,YAAsB,+xFAqElD,EA/EJ,CAAqC,EAAAE,gBAAxB,EAAA6hB,mB,8ZCTb,WAaA,cA8DQ,mBACI,YAAM,EAAA7hB,eAAeH,UAAWiiB,EAAiBhiB,YAAagiB,EAAiBU,qBAAmB,K,OAClG,EAAKC,QAAU,E,EAoD3B,OApHsC,OAyEvB,YAAAviB,MAAP,SAAaC,EAAwCC,EAAyBC,GAC1E,IAAMC,EAAa,IAAIxF,GAAGyF,OAE1BtG,KAAK8F,SAASU,aAAeH,EAC7BrG,KAAK8F,SAASW,WAAa5F,GAAG6F,SAASC,WACvC,YAAMV,MAAK,UAACC,EAAeC,EAAOC,EAAQvF,GAAG4nB,YAAYC,KAOtD,YAAA7hB,mBAAP,SAA0BnI,GACtBsB,KAAK8F,SAASgB,gBAAkBpI,GAO7B,YAAAiqB,YAAP,SAAmBjqB,GACfA,EAAQ4F,KAAK0C,IAAI,EAAGtI,GACpBA,EAAQ4F,KAAK2C,IAAI,EAAGvI,GACpBsB,KAAK8F,SAASiB,SAAWrI,GAE7B,sBAAW,uBAAQ,C,IAKnB,WACI,OAAOsB,KAAK8F,SAASiB,U,IANzB,SAAoBrI,GAChBA,EAAQ4F,KAAK0C,IAAI,EAAGtI,GACpBA,EAAQ4F,KAAK2C,IAAI,EAAGvI,GACpBsB,KAAK8F,SAASiB,SAAWrI,G,gCAMtB,YAAAwI,iBAAP,SAAwBC,GACpBnH,KAAKmH,OAASA,EACdnH,KAAKmH,OAAOC,QAAU,CAACpH,OAEpB,YAAAqH,QAAP,WACQrH,KAAKmH,SACLnH,KAAKmH,OAAOC,QAAU,KA/GN,EAAAmhB,mBAAqB,CACzC9hB,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,EACjB6hB,SAAiB,GACjBC,UAAiB,EACjBC,MAAiB,GACjBC,UAAiB,GAGG,EAAAljB,YAAsB,2wDAwGtD,EApHA,CAAsChF,GAAG0G,QAA5B,EAAAsgB,oB,8ZCfb,WAWA,cAoCQ,a,OACI,YAAM,EAAA9hB,eAAeH,UAAWkiB,EAAgBjiB,YAAaiiB,EAAgBO,qBAAmB,KAExG,OAvCiC,OAEL,EAAAA,mBAAqB,CACzC7hB,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,GAGG,EAAAlB,YAAsB,s9BA8BlD,EAvCJ,CAAqC,EAAAE,gBAAxB,EAAA+hB,mB,8ZCXb,WAWA,cA+CQ,a,OACI,YAAM,EAAA/hB,eAAeH,UAAWmiB,EAAiBliB,YAAakiB,EAAiBM,qBAAmB,KAE1G,OAlDkC,OAEN,EAAAA,mBAAqB,CACzC7hB,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,EACjBiiB,UAAiB,IAGG,EAAAnjB,YAAsB,41CAwClD,EAlDJ,CAAsC,EAAAE,gBAAzB,EAAAgiB,oB,8ZCXb,WAUA,cAwMQ,a,OACI,YAAM,EAAAhiB,eAAeH,UAAWoiB,EAAeniB,YAAamiB,EAAeK,qBAAmB,KAEtG,OA3MgC,OAEJ,EAAAA,mBAAqB,CACzC7hB,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,GAGG,EAAAlB,YAAsB,mmPAkMlD,EA3MJ,CAAoC,EAAAE,gBAAvB,EAAAiiB,kB,8ZCVb,IAEA,cAwBQ,mBACI,YAAM,GAAIC,EAAapiB,cAAY,K,OACnC,EAAK2iB,QAAU,E,EAEvB,OA5B8B,OAEF,EAAA3iB,YAAsB,+jCA0BlD,EA5BJ,CAFA,KAEkCE,gBAArB,EAAAkiB,gB,8ZCFb,WAWA,cAmCQ,a,OACI,YAAM,EAAAliB,eAAeH,UAAWsiB,EAAWriB,YAAaqiB,EAAWG,qBAAmB,KAE9F,OAtC4B,OAEA,EAAAA,mBAAqB,CACzC7hB,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,EACjBkiB,KAAiB,IAGG,EAAApjB,YAAsB,m4BA4BlD,EAtCJ,CAAgC,EAAAE,gBAAnB,EAAAmiB,c,8ZCXb,WAUA,cA6HQ,a,OACI,YAAM,EAAAniB,eAAeH,UAAWuiB,EAAmBtiB,YAAasiB,EAAmBriB,WAAS,KAEpG,OAhIoC,OAER,EAAAA,SAAW,CAC/BU,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,GAGG,EAAAlB,YAAsB,gpJAuHlD,EAhIJ,CAAwC,EAAAE,gBAA3B,EAAAoiB,sB,8ZCVb,WAUA,cAsIQ,a,OACI,YAAM,EAAApiB,eAAeH,UAAWwiB,EAAoBviB,YAAauiB,EAAoBtiB,WAAS,KAEtG,OAzIqC,OAET,EAAAA,SAAW,CAC/BU,aAAiB3F,GAAGyF,OAAOgB,YAC3Bb,WAAiB5F,GAAG6F,SAASC,WAC7BG,gBAAiB,KACjBC,SAAiB,GAGG,EAAAlB,YAAsB,q/JAgIlD,EAzIJ,CAAyC,EAAAE,gBAA5B,EAAAqiB,uB,8ECRb,8BAKY,KAAAc,UAAoB,EAmChC,OAjCI,sBAAW,uBAAQ,C,IAMnB,WACI,OAAOlpB,KAAKkpB,W,IAPhB,SAAoB1f,GAChBxJ,KAAKkpB,UAAY1f,EACbxJ,KAAKmpB,aACLnpB,KAAKmpB,WAAWC,MAAS,EAAIppB,KAAKkpB,Y,gCAMnC,YAAAriB,mBAAP,SAA0BnI,GACtBsB,KAAK6E,YAAcnG,EACfsB,KAAK6E,cACL7E,KAAKmpB,WAAatoB,GAAGwoB,OAAOC,KAAKtpB,KAAK6E,eAGvC,YAAAqC,iBAAP,SAAwBC,GACpBnH,KAAKmH,OAASA,EACVnH,KAAKmH,QAAUnH,KAAKmH,OAAOob,QAAUviB,KAAKmpB,aAC1CnpB,KAAKmpB,WAAWzmB,EAAI1C,KAAKmH,OAAOzE,EAChC1C,KAAKmpB,WAAWxmB,EAAI3C,KAAKmH,OAAOxE,EAChC3C,KAAKmH,OAAOob,OAAOhM,SAASvW,KAAKmpB,cAGlC,YAAA9hB,QAAP,W,MACQrH,KAAKmpB,YAAcnpB,KAAKmpB,WAAW5G,SACnCviB,KAAKmpB,WAAW5G,OAAOtJ,YAAYjZ,KAAKmpB,YACxB,QAAhB,EAAAnpB,KAAK6E,mBAAW,SAAEuQ,UAClBpV,KAAK6E,iBAAcxC,EACnBrC,KAAKmpB,gBAAa9mB,IAK9B,EAxCA,GAAa,EAAAolB,e,68CCEb,YAIA,aAMI,WAAY7C,EAAU/iB,GAFd,KAAA0nB,SAA6C,GAGjDvpB,KAAK4kB,IAAMA,EACX5kB,KAAK6B,QAAUA,EACZA,EAAQmS,OAAOwV,OAAOC,eAgOjC,OA1MW,YAAAzgB,MAAP,WACIhJ,KAAKE,QACLF,KAAKupB,SAAW,IAGb,YAAArpB,MAAP,WACI,IAAK,IAAMkC,KAAMpC,KAAKupB,SAClB,GAAIvpB,KAAKupB,SAASnnB,GAAK,CACnB,IAAMsnB,EAAQ1pB,KAAKupB,SAASnnB,GACxBsnB,EAAMC,OAASD,EAAMC,MAAMC,WAC3BF,EAAMC,MAAMzpB,UAMrB,YAAAC,OAAP,WACI,IAAK,IAAMiC,KAAMpC,KAAKupB,SAClB,GAAIvpB,KAAKupB,SAASnnB,GAAK,CACnB,IAAMsnB,EAAQ1pB,KAAKupB,SAASnnB,GACxBsnB,EAAMC,OAASD,EAAMC,MAAME,QAC3BH,EAAMC,MAAMxpB,WAOrB,YAAA2pB,WAAP,SAAkBC,EAAiB/M,EAAkBrc,GACjD,QADiD,IAAAA,MAAyB,IACpD,iBAAZopB,GAAoC,KAAZA,EAAlC,CAGA,IAAMC,EAAQhqB,KAAK4kB,IAAIqF,SAASF,GAChC,QAAc1nB,IAAV2nB,QAAqC3nB,IAAd2nB,EAAMxJ,KAAmC,KAAdwJ,EAAMxJ,IAI5D,IAAIxgB,KAAKkqB,WAAWH,EAAS,aAAcppB,GAI3C,IAAIX,KAAKmqB,aAKT,GADcnqB,KAAK4kB,IAAIwF,cAAcL,GACrC,CAEA,IAAMM,EAAarqB,KAAKupB,SAASvM,GAC7BqN,GAGIA,EAAWV,OAASU,EAAWV,MAAMC,WACrCS,EAAWV,MAAMzpB,WAItB,YAAAoqB,YAAP,SAAmBP,EAAiB/M,EAAkBrc,QAAA,IAAAA,MAAyB,IAE3E,IAAMqpB,EAAQhqB,KAAK4kB,IAAIqF,SAASF,GAChC,QAAc1nB,IAAV2nB,QAAqC3nB,IAAd2nB,EAAMxJ,KAAmC,KAAdwJ,EAAMxJ,OAIxDxgB,KAAKkqB,WAAWH,EAAS,cAAeppB,KAIxCX,KAAKmqB,cAIKnqB,KAAK4kB,IAAIwF,cAAcL,IAErC,CAEA,IAAMM,EAAarqB,KAAKupB,SAASvM,GAC7BqN,GAEIA,EAAWV,OAASU,EAAWV,MAAME,QACrCQ,EAAWV,MAAMxpB,WAQhB,YAAAgd,UAAb,SAAuB4M,EAAiB/M,EAAkBrc,G,YAAA,IAAAA,MAAyB,I,+FAG/E,YAAc0B,KADR2nB,EAAQhqB,KAAK4kB,IAAIqF,SAASF,UACS1nB,IAAd2nB,EAAMxJ,KAAmC,KAAdwJ,EAAMxJ,IACxD,IAGAxgB,KAAKkqB,WAAWH,EAAS,YAAappB,GACtC,IAGAX,KAAKmqB,aACL,KAGEI,EAAQvqB,KAAK4kB,IAAIwF,cAAcL,MAI/BM,EAAarqB,KAAKupB,SAASvM,MAE7BqN,EAAWV,MAAM1pB,cACVD,KAAKupB,SAASvM,IAED,GAAMhd,KAAKwqB,sBAAsBD,EAAOvN,KAPlD,I,cAORyN,EAAkB,SACxBzqB,KAAKupB,SAASvM,GAAWyN,E,YAUhB,YAAAD,sBAAb,SAAmCD,EAAuBvN,G,uGAEvC,OADfuN,EAAMG,UAAW,EACF,GAAMH,EAAMlW,Q,OAK3B,OALMsW,EAAS,SACf3qB,KAAK6B,QAAQuO,YAAYwa,QAAQ,aAAuB5N,GACxD2N,EAAO7Y,KAAK,OAAO,WACf,EAAKjQ,QAAQuO,YAAYwa,QAAQ,WAAqB5N,KACvDhd,MACI,CAAP,EAAO,CACHoC,GAAI4a,EACJoF,MAAOuI,EACPhB,MAAOY,YAIR,YAAAM,SAAP,WACI,IAAMC,EAAKxtB,OAAOytB,UAAUC,UAAUC,cACtC,MAAO,iBAAiBC,KAAKJ,IAGzB,YAAAK,aAAR,WACI,OAAO,IAAIrK,SAAQ,SAACC,GAChB,IAAMwJ,EAAQpJ,SAASC,cAAc,SACrCmJ,EAAMnW,IAAM,UACZ+M,SAASO,KAAKrL,YAAYkU,GAC1B,IAAIa,GAAW,EACfb,EAAMlW,OAAOgX,MAAK,WACdD,GAAW,EACXb,EAAM1E,SACN9E,EAAQqK,MACTvU,OAAM,WACLuU,GAAW,EACXb,EAAM1E,SACN9E,EAAQqK,UAWZ,YAAAjB,WAAR,WACI,OAAO,GAWH,YAAAD,WAAR,SAAmBH,EAAiBuB,EAAiB3qB,QAAA,IAAAA,MAAyB,IAC1E,IAAI4qB,EAAYvrB,KAAK6B,QAAQmS,OAAOwV,OAAOC,eAK3C,GAJI9oB,EAAK4qB,YACLA,EAAY5qB,EAAK4qB,WAGjBA,EAAW,CACX,IAAMvB,EAAQhqB,KAAK4kB,IAAIqF,SAASF,GAYhC,OAXA/pB,KAAK6B,QAAQuO,YAAY/P,KAAK,UAAmB,CAC7C2P,KAAI,SACJtP,KAAI,SACJwP,MAAO,UACPvP,KAAO,CACHD,KAAM4qB,EACNlpB,GAAIzB,EAAKqc,SAAW,EACpB5I,IAAK4V,EAAMxJ,IACX5hB,KAAM+B,EAAK/B,MAAQ,YAGpB,EAEX,OAAO,GAGf,EAzOA,GAAa,EAAAkmB,gB,6BCRb,OAAe,i5L,yxDCOf,YACA,OACA,QACA,QACA,QAEA,QAEA,QAEA,QAEA,cAaI,WAAYtQ,GAAZ,MACI,cAAO,K,OAbJ,EAAAgX,cAAqD,GAErD,EAAA7qB,KAAkB,KAClB,EAAA8qB,UAAuB,GAGtB,EAAAC,WAAuB,GACvB,EAAAC,UAAuC,GACvC,EAAAC,SAAW,EAEX,EAAAC,YAAc,IAAIpH,IAItB5jB,GAAGsD,IAAIwgB,MAAMmH,cAAc,EAAKC,cAAc9sB,KAAK,IACnD4B,GAAGsD,IAAIwgB,MAAMqH,qBAAqB,EAAKC,iBAAiBhtB,KAAK,IAC7D,EAAKuV,MAAQA,E,EAqjBrB,OAtkByB,OAoBd,YAAAY,QAAP,WACI,GAAIpV,KAAKwrB,cACL,IAAK,IAAMppB,KAAMpC,KAAKwrB,cAClB,GAAIxrB,KAAKwrB,cAAcppB,GAAK,CACxB,IAAM8pB,EAAWlsB,KAAKwrB,cAAcppB,GAEhC8pB,EAAStpB,SACTspB,EAAStpB,QAAQwS,SAAQ,UAClBpV,KAAKwrB,cAAcppB,IAEpB8pB,EAAiBvC,QAClBuC,EAAiBvC,MAAMvH,OACvB8J,EAAiBvC,MAAMvU,iBAErBpV,KAAKwrB,cAAcppB,IAK1CvB,GAAGC,MAAMqrB,sBACTtrB,GAAGC,MAAMsrB,oBACLpsB,KAAKqsB,SACLrsB,KAAKqsB,QAAQjX,UAEjBpV,KAAKwU,WAAQnS,EACbrC,KAAK2rB,UAAY,IAEd,YAAAW,YAAP,SAAmBtC,GACfhqB,KAAK0rB,WAAW5f,KAAKke,IAGZ,YAAAzV,SAAb,SAAsB5T,G,iGAClBX,KAAKW,KAAOA,EACRX,KAAKW,MAAQX,KAAKW,KAAK4rB,OACvB,GAAMvsB,KAAKwsB,iBADX,M,OAEA,OADA,SACA,GAAMxsB,KAAKysB,gB,cAAX,S,aAGAzsB,KAAKK,KAAK,eAAyB,M,mCAIpC,YAAAsmB,iBAAP,SAAwB9kB,GAEpB,OADA7B,KAAK0sB,qBACD1sB,KAAKW,KAAKgsB,QAAU3sB,KAAKW,KAAKgsB,OAAOtrB,OAAS,EACvCrB,KAAK4lB,YAAY5lB,KAAKW,KAAKgsB,OAAO,GAAGvqB,GAAIP,GAG7C,MAGJ,YAAAmkB,gBAAP,SAAuB4G,EAAe/qB,GAClC,IAAMgrB,EAAgB7sB,KAAK8sB,iBAAiBF,GAE5C,OAAIC,EACO7sB,KAAK4lB,YAAYiH,EAAczqB,GAAIP,GAGvC,MAGJ,YAAAskB,gBAAP,SAAuByG,EAAe/qB,GAClC,IAAMgrB,EAAgB7sB,KAAK+sB,iBAAiBH,GAE5C,OAAIC,EACO7sB,KAAK4lB,YAAYiH,EAAczqB,GAAIP,GAGvC,MAGJ,YAAA+jB,YAAP,SAAmBxjB,EAAYP,GAC3B,IAAMmrB,EAAYhtB,KAAKitB,aAAa7qB,GAEpC,GAAI4qB,EAAW,CACX,IAAIE,EAAmBltB,KAAK2rB,UAAUvpB,GAQtC,GANe,MAAX8qB,KACAA,EAAU,IAAI,EAAAC,QAAQtrB,IACdgT,WAAamY,EAAUnY,YAEnCqY,EAAQ9qB,GAAKA,EACbpC,KAAK2rB,UAAUvpB,GAAM8qB,EACjBF,EAAU9iB,MAAO,CACjB,IAAMkc,EAAqBpmB,KAAKotB,gBAAgBJ,EAAU9iB,MAAO8iB,EAAU5qB,IAEvEgkB,IACAA,EAAMtjB,MAAQjB,EAAQiB,MACtBsjB,EAAMrjB,OAASlB,EAAQkB,OACvBmqB,EAAQG,aAAajH,IAI7B,OAAO8G,EAGX,OAAO,MAGJ,YAAAnB,cAAP,SAAqB9d,GAEjB,GAAsC,SAAlCA,EAAM5I,WAAW6R,OAAO,EAAG,GAC3B,OAAOjJ,EAAM5I,WAGjB,IAAM6mB,EAAWlsB,KAAKiqB,SAAShc,GAE/B,GAAIie,EAGA,OAFkBlsB,KAAKW,KAAK4rB,OAAOte,GAEjBvN,MACd,IAAK,QACD,OAAOwrB,EAAStpB,QACpB,IAAK,QACD,OAAOspB,EAASoB,YACpB,QACI,OAAOpB,IAOhB,YAAAD,iBAAP,SAAwB7pB,EAAY+E,GAChC,GAAU9E,MAAND,EAAJ,CAIA,GAAmC,SAA/BA,EAAGiD,WAAW6R,OAAO,EAAG,IAAiB/P,GAAUA,EAAOob,kBAAkB,EAAA/gB,YAAa,CACzF,IAAM+rB,EAAWnrB,EAAG4U,MAAM,KAE1BuW,EAAShsB,QAGT,IAFA,IAAI2W,EAAQ/Q,EAAOob,OAEZgL,EAASlsB,OAAS,GAAK6W,GAAO,CACjC,IAAM,EAAKqV,EAAShsB,QAEpB2W,EAAQA,EAAMzW,aAAa,GAE/B,OAAIyW,QAGJlY,KAAKwU,MAAMpE,YAAYhE,UAAU,QAAS,CAAChK,GAAK,WAKpD,OAAOpC,KAAKwtB,UAAUprB,KAGnB,YAAA6nB,SAAP,SAAgBhc,GACZ,IAAMwf,EAAYztB,KAAKW,KAAK4rB,OAAOte,GAEnC,QAAkB5L,IAAdorB,GAA2C,MAAhBA,EAAUrrB,GAMzC,OAAOpC,KAAKwrB,cAAciC,EAAUrrB,GAAGiD,YALnCrF,KAAKwU,MAAMpE,YAAYhE,UAAU,QAAS,CAAC6B,GAAQ,YAQpD,YAAAmc,cAAP,SAAqBnc,GACjB,IAAMwf,EAAYztB,KAAKiqB,SAAShc,GAEhC,GAAIwf,EACA,OAAOA,EAAU9D,OAMX,YAAA6C,cAAd,W,8HACUD,EAASvsB,KAAKW,KAAK4rB,OACnB7V,EAAO1W,KAAKwU,MAAMR,OAAO0C,K,KAGd6V,E,0DACbmB,EAAanB,EAAOnqB,KACkB,OAApBsrB,EAAWhtB,MAAyBgtB,EAAW1vB,KACjD,GAAM,UAAa0vB,EAAWlN,IAAK9J,EAAMgX,EAAW1vB,MAAM6Y,OAAM,SAACO,GACzE,EAAK5C,MAAMpE,YAAYkT,MAAMlM,OAFjC,O,cACMuW,EAAM,WAKJA,EAAIC,UACJ/sB,GAAGsD,IAAIoD,OAAOsmB,KAAKlL,IAAI+K,EAAW1vB,KAAM2vB,G,2DAO9C,YAAAlB,aAAd,W,6EAII,IAAWrqB,KAHLmqB,EAASvsB,KAAKW,KAAK4rB,OAIrB,GAAIA,EAAOnqB,GAAK,CAEZ,QAAmBC,KADnBqrB,EAAanB,EAAOnqB,UACgCC,IAApBqrB,EAAWhtB,WAAyC2B,IAAnBqrB,EAAWlN,IAAmB,CAC3FxgB,KAAKwU,MAAMpE,YAAYhE,UAAU,QAAS,CAAChK,IAC3C,SAEJ,GAAuB,KAAnBsrB,EAAWlN,IAAY,CACvBxgB,KAAKwU,MAAMpE,YAAYhE,UAAU,QAAS,CAAChK,GAAK,WAChD,SAEJ,GAAwB,UAApBsrB,EAAWhtB,MAA4BV,KAAKwU,MAAMR,OAAOwV,OAAOC,eAAgB,CAChFzpB,KAAKwU,MAAMpE,YAAYhE,UAAU,QAAS,CAAChK,GAAK,WAChD,SAEJ,GAAwB,OAApBsrB,EAAWhtB,KACX,SAEJgtB,EAAWtrB,GAAKA,EAChBpC,KAAKssB,YAAYC,EAAOnqB,I,OAGhCpC,KAAK8tB,gB,WAGD,YAAApB,mBAAR,WAKI,GAJI1sB,KAAKW,KAAKkZ,SACV7Z,KAAKwU,MAAMxQ,gBAAgBoF,kBAAkB,EAAAS,gBAAgBC,UAAW9J,KAAKW,KAAKkZ,QAClF7Z,KAAKwU,MAAMxQ,gBAAgB2F,oBAAoB3J,KAAKW,KAAKkZ,SAEzD7Z,KAAKyrB,UACL,IAAK,IAAIpuB,EAAI,EAAG6E,EAAclC,KAAKyrB,UAAUpqB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC/D,IAAM0wB,EAAS/tB,KAAKyrB,UAAUpuB,GAE9B,GAAI0wB,GAA0B,KAAhBA,EAAOrtB,KAAoC,CACrD,IAAMstB,EAAmCD,EAEzC/tB,KAAKwU,MAAMxQ,gBAAgBuG,wBAAwByjB,EAAU5jB,MACzD4jB,EAAUC,aACVD,EAAUtvB,UAKtB,YAAAuuB,aAAR,SAAqB7qB,GACjB,GAAIpC,KAAKW,KAAKgsB,OACV,IAAK,IAAItvB,EAAI,EAAG6E,EAAclC,KAAKW,KAAKgsB,OAAOtrB,OAAQhE,EAAI6E,EAAK7E,IAC5D,GAAI2C,KAAKW,KAAKgsB,OAAOtvB,GAAG+E,KAAOA,EAC3B,OAAOpC,KAAKW,KAAKgsB,OAAOtvB,GAKpC,OAAO,MAEH,YAAAyvB,iBAAR,SAAyBF,GACrB,GAAI5sB,KAAKW,KAAKgsB,OACV,IAAK,IAAItvB,EAAI,EAAG6E,EAAclC,KAAKW,KAAKgsB,OAAOtrB,OAAQhE,EAAI6E,EAAK7E,IAC5D,GAAI2C,KAAKW,KAAKgsB,OAAOtvB,GAAG+E,KAAOwqB,GACvBvvB,EAAI6E,EAAM,EACV,OAAOlC,KAAKW,KAAKgsB,OAAOtvB,EAAI,GAM5C,OAAO,MAEH,YAAA0vB,iBAAR,SAAyBH,GACrB,GAAI5sB,KAAKW,KAAKgsB,OACV,IAAK,IAAItvB,EAAI,EAAG6E,EAAclC,KAAKW,KAAKgsB,OAAOtrB,OAAQhE,EAAI6E,EAAK7E,IAC5D,GAAI2C,KAAKW,KAAKgsB,OAAOtvB,GAAG+E,KAAOwqB,GACvBvvB,EAAI,EACJ,OAAO2C,KAAKW,KAAKgsB,OAAOtvB,EAAI,GAM5C,OAAO,MAGH,YAAA+vB,gBAAR,SAAwBljB,EAAe9H,GACnC,IAAM8rB,EAAgBluB,KAAKW,KAAKwtB,WAAWjkB,GACvChJ,EAAyC,KAE7C,GAAIgtB,EACA,OAAQA,EAAcxtB,MAClB,IAAK,SACDQ,EAAYlB,KAAKouB,sBAAsBlkB,EAAO9H,QACVC,IAAhC6rB,EAAclW,gBACd9W,EAAU8W,cAAgBkW,EAAclW,eAE5C,MACJ,QACI9W,EAAYlB,KAAKwtB,UAAUtjB,GAKvC,OAAOhJ,GAGH,YAAAssB,UAAR,SAAkBprB,GACd,IAAM8rB,EAAgBluB,KAAKW,KAAKwtB,WAAW/rB,GAE3C,IAAK8rB,EACD,OAAO,KAEX,IAEIG,EAFE3tB,EAAYwtB,EAAcxtB,KAIhC,IAGI2tB,EAAK,IAFOxtB,GAAGsD,IAAIwgB,MAAM2J,YAAY5tB,IAIzC,MAAO0W,GAEH,MADApX,KAAKwU,MAAMpE,YAAYhE,UAAU,QAAS,CAAChK,IACrC,IAAI+N,MAAM,iBAAiBzP,EAAI,oBAEzC,GAAI2tB,EACA,IAAK,IAAMrvB,KAAOkvB,EACd,GAAIlvB,KAAOkvB,EACP,OAAQlvB,GACJ,IAAK,KAEDqvB,EAAGnkB,MAAQgkB,EAAclvB,GACzB,MACJ,IAAK,OAEDqvB,EAAGE,QAAUL,EAAclvB,GAC3B,MACJ,IAAK,OACL,IAAK,WACL,IAAK,aACL,IAAK,UACL,IAAK,OACD,MACJ,QACIqvB,EAAGrvB,GAAQkvB,EAAsBlvB,GAOrD,OAAOqvB,GAEH,YAAAD,sBAAR,SAA8BlkB,EAAe9H,GACzC,IACMosB,EADgBxuB,KAAKW,KAAKwtB,WAAWjkB,GAErCukB,EAA2B,IAAI,EAAAjtB,YAWrC,GATAitB,EAAYzwB,KAAOwwB,EAAWxwB,KAC9BywB,EAAYvkB,MAAQA,EACpBukB,EAAYrsB,GAAKA,EAEbosB,EAAWE,QACX1uB,KAAKwU,MAAMxQ,gBAAgBoF,kBAAkBc,EAAM7E,WAAYmpB,EAAWE,OAC1E1uB,KAAKwU,MAAMxQ,gBAAgBiG,uBAAuBwkB,IAGlDD,EAAWnZ,SACX,IAAK,IAAIhY,EAAI,EAAG6E,EAAcssB,EAAWnZ,SAAShU,OAAQhE,EAAI6E,EAAK7E,IAAK,CACpE,IAAMsxB,EAAiBH,EAAWnZ,SAAShY,GAE3C,GAAI,UAAWsxB,EAAW,CACtB,IAAMC,EAAqB5uB,KAAKW,KAAKwtB,WAAWQ,EAAUzkB,OACpDgO,EAAQlY,KAAKotB,gBAAgBuB,EAAUzkB,MAAOykB,EAAUvsB,IAE1D8V,IACQ0W,EAAmBluB,KAEnBV,KAAK6uB,8BAA8B3W,EAAOyW,GAGlDF,EAAYlY,SAAS2B,KAKrC,GAAIsW,EAAWnW,YAAwC,KAA1BmW,EAAWnW,WAAmB,CACvD,IAAMA,EAAa,IAAI,EAAAyW,WAAWL,EAAaD,EAAWnW,YAE1DoW,EAAYpW,WAAaA,OAExB,QAAchW,IAAV6H,EAAqB,CAC1B,IAAM6kB,EAAU/uB,KAAKgvB,oBAAoB9kB,EAAM7E,YAE/C,GAAI0pB,EAAS,CACH1W,EAAa,IAAI,EAAAyW,WAAWL,EAAaM,GAE/CN,EAAYpW,WAAaA,GAGjC,GAAImW,EAAWS,WAAY,CACvB,IAAM9W,EAAY,IAAI,EAAA+W,UAAUT,EAAaD,EAAWS,WAAYjvB,KAAKW,KAAK6jB,KAE9EiK,EAAYtW,UAAYA,EAG5B,OAAOsW,GAGH,YAAAI,8BAAR,SAAsCM,EAA+BxuB,GACjE,IAAK,IAAM3B,KAAO2B,EACd,GAAI3B,KAAO2B,EACP,OAAQ3B,GAGJ,IAAK,QACL,IAAK,OACL,IAAK,WACL,IAAK,aACL,IAAK,UACD,MACJ,QACkC,IAA1BA,EAAI0b,QAAQ,UACZ1a,KAAK4G,YAAYuoB,EAASnwB,EAAM2B,EAAa3B,IAG5CmwB,EAAgBnwB,GAAQ2B,EAAa3B,KAQtD,YAAA4H,YAAR,SAAoBuoB,EAA+BC,EAAmB1wB,GAIlE,IAHA,IAAM2wB,EAAaD,EAAUpY,MAAM,KAC/B7P,EAASgoB,EAEJ9xB,EAAI,EAAG6E,EAAcmtB,EAAWhuB,OAAQhE,EAAI6E,EAAM,EAAG7E,IAAK,CAC/D,IAAMiyB,EAASD,EAAWhyB,GAEtB8J,GAAUA,EAAOmoB,KACjBnoB,EAASA,EAAOmoB,IAGpBnoB,IACAA,EAAOkoB,EAAWA,EAAWhuB,OAAS,IAAM3C,IAI5C,YAAAovB,cAAR,2BACyBzrB,IAAjBrC,KAAKqsB,UACLrsB,KAAKqsB,QAAU,IAAIxrB,GAAG0uB,QAE1B,IAAMC,EAASxvB,KAAKqsB,QACdoD,EAAY,GAElBzvB,KAAK4rB,SAAW,EAEhB,IAAK,IAAIvuB,EAAI,EAAG6E,EAAclC,KAAK0rB,WAAWrqB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAChE,IAAMunB,EAAM5kB,KAAK0rB,WAAWruB,GACtB+E,OAAgBC,IAAXuiB,EAAIxiB,GAAmB,YAAcwiB,EAAIxiB,GAAGiD,WAEnDoqB,EAAK7K,EAAIpE,KACTiP,EAAK7K,EAAIpE,KAAK1U,KAAK8Y,EAAIxiB,KAG3BotB,EAAOnK,IAAIjjB,EAAI,EAAAkf,OAAOsD,EAAIpE,IAAKxgB,KAAKW,KAAK0hB,UACzCoN,EAAK7K,EAAIpE,KAAO,CAACpe,IAErB,IAAIstB,EACAC,EAAa,EACbC,EAAU,EAEdF,EAAaF,EAAOK,WAAWxK,KAAI,WAC/B,EAAKuG,WACL,EAAKvrB,KAAK,eAAyB,CAAC,EAAKurB,SAAY,EAAKF,WAAiB,OAAG,EAAKA,WAAWrqB,YAElGsuB,EAAaH,EAAOM,WAAWzK,KAAI,SAAC0K,EAAoBC,GAEpD,GADA,EAAKxE,cAAgBwE,GAChB,EAAKC,oBAAqB,CAC3B,IAAK,IAAMjxB,KAAOywB,EAGd,IAFA,IAAMrtB,EAAKqtB,EAAKzwB,GAAKuC,QAEdkuB,EAAKzwB,GAAKqC,OAAS,GACtB,EAAKmqB,cAAciE,EAAKzwB,GAAKuC,SAAWyuB,EAAU5tB,GAG1DotB,EAAOM,WAAWI,OAAOR,GACzBF,EAAOM,WAAWI,OAAOP,GACzBH,EAAOM,WAAWI,OAAON,GACzB,EAAKvvB,KAAK,eAAyB,UAG3CuvB,EAAUJ,EAAOnc,QAAQgS,KAAI,SAAC/B,EAAcyM,EAAoBI,GAC5D,IAAMC,EAAY,EAAKvE,YAAYvtB,IAAI6xB,EAAenyB,MAElDoyB,GACIA,EAAUC,OAAS,IACnB,EAAKxE,YAAY/I,OAAOqN,EAAenyB,MACvC,EAAKwW,MAAMpE,YAAYhE,UAAU,MAAO,CAAC+jB,EAAe3P,OAE5D4P,EAAUC,SAGV,EAAKxE,YAAYlJ,IAAIwN,EAAenyB,KAAM,CAAEoE,GAAI+tB,EAAenyB,KAC3DwiB,IAAK2P,EAAe3P,IACpB8P,UAAWH,EAAeG,UAAWD,MAAO,OAGxDb,EAAO/Y,QAIH,YAAAwZ,kBAAR,WACI,QAAqB5tB,IAAjBrC,KAAKqsB,QACL,OAAO,EAGX,GAAIrsB,KAAK6rB,YAAY5C,MAAQ,EACzB,OAAO,EAEX,IAAMuG,EAASxvB,KAAKqsB,QACd3V,EAAO1W,KAAKwU,MAAMR,OAAO0C,KA6B/B,OA3BA1W,KAAK6rB,YAAYpI,SAAQ,SAACmB,GACtB,IACI5C,EAEJ,OAHa,EAAAC,aAAa2C,EAAI0L,YAI1B,KAAK,EACDtO,EAAMtL,EAAKyL,MACX,MACJ,KAAK,EACL,KAAK,EACDH,EAAMtL,EAAK0L,MACX,MACJ,QACIJ,EAAMtL,EAAKC,QAEnB,IAAI6J,EAAMwB,GAAK4C,EAAIyL,MAAQ,GAAKrO,EAAI3gB,SAEH,IAA7BujB,EAAIpE,IAAI9F,QAAQ,SAA4C,IAA1BkK,EAAIpE,IAAI9F,QAAQ,MAClD8F,GAAOoE,EAAIpE,IAAItJ,OAAO0N,EAAIpE,IAAI9F,QAAQ,IAAKkK,EAAIpE,IAAI9F,QAAQ,OAG3D8F,GAAOoE,EAAIpE,WAERgP,EAAOQ,UAAUpL,EAAIxiB,IAC5BotB,EAAOnK,IAAIT,EAAIxiB,GAAIoe,OAGhB,GAGH,YAAAwO,oBAAR,SAA4B9kB,GACxB,GAAIlK,KAAKyrB,UACL,IAAK,IAAIpuB,EAAI,EAAG6E,EAAclC,KAAKyrB,UAAUpqB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC/D,IAAM0wB,EAAS/tB,KAAKyrB,UAAUpuB,GAE9B,GAAI0wB,GAA0B,KAAhBA,EAAOrtB,MAAkCqtB,EAAOrvB,QAAUwL,EACpE,OAAO6jB,EAAOwC,UAOlC,EAtkBA,CAAyB1vB,GAAGC,MAAMC,cAArB,EAAA8jB,O,8ZCfb,kBAQQ,WAAYhjB,GAAZ,MACI,cAAO,K,OANJ,EAAAO,GAAa,KAGZ,EAAAlB,UAAyB,KAI7B,EAAKW,QAAUA,E,EAyCvB,OAnDyB,OAad,YAAA3B,MAAP,WACQF,KAAKkB,WACLlB,KAAKkB,UAAUhB,SAIhB,YAAAC,OAAP,WACQH,KAAKkB,WACLlB,KAAKkB,UAAUf,UAIhB,YAAAktB,aAAP,SAAoBoB,GAChBzuB,KAAKkB,UAAYutB,EACjBzuB,KAAKkB,UAAUW,QAAU7B,KAAK6B,QAC9B7B,KAAKkB,UAAUiY,YACfnZ,KAAKkB,UAAUmY,uBACDrZ,KAAKuW,SAASkY,GAC5BzuB,KAAKkB,UAAUoY,iBACftZ,KAAKkB,UAAUuX,wBAGZ,YAAA+X,gBAAP,WACI,GAAIxwB,KAAKkB,UAAW,CAChBlB,KAAKkB,UAAUsY,0BACDxZ,KAAKiZ,YAAYjZ,KAAKkB,WACpClB,KAAKkB,UAAUqY,oBACfvZ,KAAKkB,UAAUjB,OACfD,KAAKkB,UAAUW,aAAUQ,IAG1B,YAAAgF,QAAP,WACQrH,KAAKkB,YACLlB,KAAKwwB,kBACLxwB,KAAKkB,UAAUmG,WAEnBrH,KAAKkB,UAAY,MAEzB,EAnDJ,CAA6BL,GAAGsD,IAAIuV,WAAvB,EAAAyT,W,8ECEb,YACA,QACA,QACA,QACA,QACA,QACA,QACA,OACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QAEA,QACA,QAGA,aAMQ,WAAYjsB,EAAwBP,GAF5B,KAAA8vB,YAA0B,GAG9BzwB,KAAKkB,UAAYA,EACjBlB,KAAKW,KAAOA,EACZX,KAAK0wB,YA4Yb,OAzYW,YAAA3wB,IAAP,WACI,GAAIC,KAAKywB,aAAezwB,KAAKywB,YAAYpvB,OACrC,IAAM,IAAIhE,EAAY,EAAG6E,EAAclC,KAAKywB,YAAYpvB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC7D2C,KAAKywB,YAAYpzB,GACzB0C,QAKV,YAAAE,KAAP,WACI,GAAID,KAAKywB,aAAezwB,KAAKywB,YAAYpvB,OACrC,IAAM,IAAIhE,EAAY,EAAG6E,EAAclC,KAAKywB,YAAYpvB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC7D2C,KAAKywB,YAAYpzB,GACzB4C,SAKV,YAAAC,MAAP,WACI,GAAIF,KAAKywB,aAAezwB,KAAKywB,YAAYpvB,OACrC,IAAM,IAAIhE,EAAY,EAAG6E,EAAclC,KAAKywB,YAAYpvB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC7D2C,KAAKywB,YAAYpzB,GACzB6C,UAKV,YAAAC,OAAP,WACI,GAAIH,KAAKywB,aAAezwB,KAAKywB,YAAYpvB,OACrC,IAAM,IAAIhE,EAAY,EAAG6E,EAAclC,KAAKywB,YAAYpvB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC7D2C,KAAKywB,YAAYpzB,GACzB8C,WAKT,YAAAuwB,UAAR,WACQ1wB,KAAKW,MACD4C,MAAMC,QAAQxD,KAAKW,OACnBX,KAAK2wB,SAAS3wB,KAAKW,OAKvB,YAAAiwB,kBAAR,SAA0B7C,GAClB/tB,KAAKkB,WAAalB,KAAKkB,UAAUW,SACT7B,KAAKkB,UAAUW,QAAQmC,gBAC/BuG,wBAAwBwjB,EAAO3jB,MAAO2jB,EAAOE,aAAcF,EAAOrvB,QAGlF,YAAAiyB,SAAR,SAAiB5B,GACb,GAAIA,EACA,IAAK,IAAI1xB,EAAY,EAAG6E,EAAc6sB,EAAQ1tB,OAAQhE,EAAI6E,EAAK7E,IAAK,CAChE,IAAMwK,EAAO7H,KAAK6wB,YAAY9B,EAAQ1xB,IAClCwK,GACA7H,KAAKywB,YAAY3kB,KAAKjE,KAK9B,YAAAgpB,YAAR,SAAoBlwB,GAEhB,IAAIkH,EACJ,OAAQlH,EAAKD,MACT,KAAK,EACDmH,EAAO7H,KAAK8wB,sBAAsBnwB,GAClC,MACJ,KAAK,EACDkH,EAAO7H,KAAK+wB,gBAAgBpwB,GAC5B,MACJ,KAAK,EACDkH,EAAO7H,KAAKgxB,iBAAiBrwB,GAC7B,MACJ,KAAK,EACDkH,EAAO7H,KAAKixB,WAAWtwB,GACvB,MACJ,KAAK,EACDkH,EAAO7H,KAAKkxB,aAAavwB,GACzB,MACJ,KAAK,EACDkH,EAAO7H,KAAKmxB,QAAQxwB,GACpB,MACJ,KAAK,GACDkH,EAAO7H,KAAKoxB,oBAAoBzwB,GAChC,MACJ,KAAK,GACDkH,EAAO7H,KAAKqxB,kBAAkB1wB,GAC9B,MACJ,KAAK,EACDkH,EAAO7H,KAAKsxB,WAAW3wB,GACvB,MACJ,KAAK,GACDkH,EAAO7H,KAAKuxB,sBAAsB5wB,GAClC,MACJ,KAAK,GACDkH,EAAO7H,KAAKwxB,yBAAyB7wB,GACrC,MACJ,KAAK,GACDkH,EAAO7H,KAAKyxB,eAAe9wB,GAC3B,MACJ,KAAK,GACDkH,EAAO7H,KAAK0xB,eAAe/wB,GAC3B,MACJ,KAAK,GACDkH,EAAO7H,KAAK2xB,gBAAgBhxB,GAC5B,MACJ,KAAK,GACDkH,EAAO7H,KAAK4xB,iBAAiBjxB,GAC7B,MACJ,KAAK,GACDkH,EAAO7H,KAAK6xB,mBAAmBlxB,GAC/B,MACJ,KAAK,GACDkH,EAAO7H,KAAK8xB,qBAAqBnxB,GACjC,MACJ,KAAK,GACDkH,EAAO7H,KAAK+xB,qBAAqBpxB,GACjC,MACJ,KAAK,GACDkH,EAAO7H,KAAKgyB,iBAAiBrxB,GAC7B,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAoqB,cAAcjyB,KAAKkB,UAAWP,GACzC,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAqqB,aAAalyB,KAAKkB,UAAWP,GACxC,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAsqB,cAAcnyB,KAAKkB,UAAWP,GACzC,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAuqB,gBAAgBpyB,KAAKkB,UAAWP,GAC3C,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAwqB,gBAAgBryB,KAAKkB,UAAWP,GAC3C,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAyqB,gBAAgBtyB,KAAKkB,UAAWP,GAC3C,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAA0qB,eAAevyB,KAAKkB,UAAWP,GAC1C,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAA2qB,iBAAiBxyB,KAAKkB,UAAWP,GAC5C,MACJ,KAAK,GACDkH,EAAO7H,KAAKyyB,0BAA0B9xB,GACtC,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAA6qB,mBAAmB1yB,KAAKkB,UAAWP,GAC9C,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAgV,sBAAsB7c,KAAKkB,UAAWP,GACjD,MACJ,KAAK,GACD,IAAMgyB,EAAYhyB,EACZiyB,EAAoC,CACtClyB,KAAM,GACNyG,OAAQwrB,EAAUxrB,OAClBnJ,KAAM,WAEV,OAAsB,IAClBuF,MAAMC,QAAQmvB,EAAU30B,MACxB40B,EAAa3iB,OAAOnE,KAAK6mB,EAAU30B,MAEnC40B,EAAa3iB,OAAOnE,KAAK,CAAC,EAAG6mB,EAAU30B,OAEvCuF,MAAMC,QAAQmvB,EAAUpa,OACxBqa,EAAa3iB,OAAOnE,KAAK6mB,EAAUpa,OAEnCqa,EAAa3iB,OAAOnE,KAAK,CAAC,EAAG6mB,EAAUpa,QAEvChV,MAAMC,QAAQmvB,EAAUna,OACxBoa,EAAa3iB,OAAOnE,KAAK6mB,EAAUna,OAEnCoa,EAAa3iB,OAAOnE,KAAK,CAAC,EAAG6mB,EAAUna,QAE3C3Q,EAAO,IAAI,EAAAgV,sBAAsB7c,KAAKkB,UAAW0xB,GACjD,MACJ,KAAK,GACD,IAAMC,EAAYlyB,EACZmyB,EAAoC,CACtCpyB,KAAM,GACNyG,OAAQ0rB,EAAU1rB,OAClBnJ,KAAM,WAEV,OAAsB,IAClBuF,MAAMC,QAAQqvB,EAAU70B,MACxB80B,EAAa7iB,OAAOnE,KAAK+mB,EAAU70B,MAEnC80B,EAAa7iB,OAAOnE,KAAK,CAAC,EAAG+mB,EAAU70B,OAEvCuF,MAAMC,QAAQqvB,EAAUta,OACxBua,EAAa7iB,OAAOnE,KAAK+mB,EAAUta,OAEnCua,EAAa7iB,OAAOnE,KAAK,CAAC,EAAG+mB,EAAUta,QAE3C1Q,EAAO,IAAI,EAAAgV,sBAAsB7c,KAAKkB,UAAW4xB,GACjD,MACJ,KAAK,GACDjrB,EAAO7H,KAAK+yB,SAASpyB,GACrB,MACJ,KAAK,GACDkH,EAAO,IAAI,EAAAmrB,UACX,MACJ,KAAK,GACDnrB,EAAO,IAAI,EAAAorB,SAASjzB,KAAKkB,UAAWP,GACpC,MACJ,KAAK,GACDkH,EAAO7H,KAAKkzB,gBAAgBvyB,GAC5B,MACJ,KAAK,GACDkH,EAAO7H,KAAKmzB,iBAAiBxyB,GAC7B,MACJ,KAAK,GACDkH,EAAO7H,KAAKozB,gBAAgBzyB,GAKpC,OAAOkH,GAGH,YAAAwrB,aAAR,SAAqBxrB,EAAqBlH,GACtC,GAAIA,EAAK4vB,QACL,IAAK,IAAIlzB,EAAY,EAAG6E,EAAcvB,EAAK4vB,QAAQlvB,OAAQhE,EAAI6E,EAAK7E,IAAK,CACrE,IAAMi2B,EAAW3yB,EAAK4vB,QAAQlzB,GACxBk2B,EAAUvzB,KAAK6wB,YAAYyC,GAC7BC,GACA1rB,EAAKD,WAAW2rB,KAMxB,YAAAzC,sBAAR,SAA8BnwB,GAC1B,IAKMkH,EAAwB,IAAI,EAAAoS,gBAAgBja,KAAKkB,UALZ,CACvCR,KAAM,GACN+Q,MAAO,MACPtK,OAAQ,KAIZ,OADAnH,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAEH,YAAAkpB,gBAAR,SAAwBpwB,GACpB,IAKMkH,EAAwB,IAAI,EAAAoS,gBAAgBja,KAAKkB,UALV,CACzCR,KAAM,GACN+Q,MAAO,QACPtK,OAAQ,KAIZ,OADAnH,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAGH,YAAAmpB,iBAAR,SAAyBrwB,GAErB,OAD8B,IAAI,EAAAoa,gBAAgB/a,KAAKkB,UAAWP,IAI9D,YAAAswB,WAAR,SAAmBtwB,GAEf,IAAM6yB,EAA6C,CAC/C/hB,MAAO,QACP/Q,KAAM,GACNyG,OAAQxG,EAAKwG,QAEXU,EAAwB,IAAI,EAAAoS,gBAAgBja,KAAKkB,UAAWsyB,GAElE,OADAxzB,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAGH,YAAAqpB,aAAR,SAAqBvwB,GAEjB,OAD0B,IAAI,EAAAqa,YAAYhb,KAAKkB,UAAWP,IAItD,YAAAwwB,QAAR,SAAgBxwB,GACZ,IAAMkH,EAAe,IAAI,EAAA8T,OAAO3b,KAAKkB,WACrC,GAAIP,EAAK4vB,QACL,IAAK,IAAIlzB,EAAY,EAAG6E,EAAcvB,EAAK4vB,QAAQlvB,OAAQhE,EAAI6E,EAAK7E,IAAK,CACrE,IAAMo2B,EAAS9yB,EAAK4vB,QAAQlzB,GAC5B,GAAoB,IAAhBo2B,EAAO/yB,MACS,IAAhB+yB,EAAO/yB,MACS,KAAhB+yB,EAAO/yB,KAA0B,CACjC,IAAM0a,EAAaqY,EAAyBrY,UACtCsY,EAAe,IAAI,EAAAjsB,UACzB,GAAIgsB,EAAOlD,QACP,IAAK,IAAItU,EAAY,EAAGC,EAAeuX,EAAOlD,QAAQlvB,OAAQ4a,EAAIC,EAAMD,IAAK,CACzE,IAAMsX,EAAUvzB,KAAK6wB,YAAY4C,EAAOlD,QAAQtU,IAC5CsX,GACAG,EAAa5rB,QAAQyrB,GAIjC1rB,EAAKsT,aAAaC,EAAWsY,IAIzC,OAAO7rB,GAGH,YAAAupB,oBAAR,SAA4BzwB,GACxB,IAAMgzB,EAAwB,IAAI,EAAAC,aAAa5zB,KAAKkB,UAAWP,EAAK3C,MAGpE,OAFAgC,KAAKqzB,aAAaM,EAAShzB,GACM,IAAI,EAAAkzB,mBAAmB7zB,KAAKkB,UAAWP,EAAK3C,KAAM2C,EAAMgzB,IAIrF,YAAAtC,kBAAR,SAA0B1wB,GAEtB,OAD+B,IAAI,EAAA2Q,iBAAiBtR,KAAKkB,UAAWP,EAAK3C,KAAM2C,IAI3E,YAAA2wB,WAAR,SAAmB3wB,GAEf,OADwB,IAAI,EAAA6b,UAAUxc,KAAKkB,UAAWP,IAIlD,YAAA4wB,sBAAR,SAA8B5wB,GAC1B,IAAMkH,EAAwB,IAAI,EAAAoS,gBAAgBja,KAAKkB,UAAWP,GAElE,OADAX,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAGH,YAAA2pB,yBAAR,SAAiC7wB,GAG7B,OADiC,IAAI,EAAAgc,mBAAmB3c,KAAKkB,UAAWP,IAIpE,YAAA8wB,eAAR,SAAuB9wB,GAEnB,OAD4B,IAAI,EAAAic,cAAc5c,KAAKkB,UAAWP,IAG1D,YAAA8xB,0BAAR,SAAkC9xB,GAC9B,GAAIA,EAAK2P,QAGL,OADI,IAAI,EAAAoM,oBAAoB1c,KAAKkB,UAAWP,IAI5C,YAAA+wB,eAAR,SAAuB/wB,GAEnB,OAD4B,IAAI,EAAA2b,cAActc,KAAKkB,UAAWP,EAAKjC,MAAOiC,EAAKqc,QAASrc,IAGpF,YAAAgxB,gBAAR,SAAwBhxB,GAEpB,OAD6B,IAAI,EAAAmzB,eAAe9zB,KAAKkB,UAAWP,EAAKjC,MAAOiC,EAAKqc,QAASrc,IAGtF,YAAAixB,iBAAR,SAAyBjxB,GAErB,OAD8B,IAAI,EAAAozB,gBAAgB/zB,KAAKkB,UAAWP,EAAKjC,MAAOiC,EAAKqc,QAASrc,IAGxF,YAAAkxB,mBAAR,SAA2BlxB,GAEvB,OADgC,IAAI,EAAA0b,kBAAkBrc,KAAKkB,UAAWP,IAGlE,YAAAmxB,qBAAR,SAA6BnxB,GAEzB,OADkC,IAAI,EAAAqzB,oBAAoBh0B,KAAKkB,UAAWP,EAAKkU,aAG3E,YAAAkd,qBAAR,SAA6BpxB,GAEzB,OADkC,IAAI,EAAAszB,oBAAoBj0B,KAAKkB,UAAWP,EAAKkU,aAG3E,YAAAmd,iBAAR,SAAyBrxB,GAErB,OAD8B,IAAI,EAAAuzB,gBAAgBl0B,KAAKkB,UAAWP,EAAKjC,MAAOiC,EAAKkU,aAI/E,YAAAke,SAAR,SAAiBpyB,GACb,IAAMkH,EAAO,IAAI,EAAA4U,QAAQzc,KAAKkB,UAAWP,GAEzC,OADAX,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAEH,YAAAqrB,gBAAR,SAAwBvyB,GACpB,IAAMkH,EAAuB,IAAI,EAAAssB,eAAen0B,KAAKkB,UAAWP,GAEhE,OADAX,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAGH,YAAAsrB,iBAAR,SAAyBxyB,GACrB,IAAMkH,EAAwB,IAAI,EAAAusB,gBAAgBp0B,KAAKkB,UAAWP,GAElE,OADAX,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAEH,YAAAurB,gBAAR,SAAwBzyB,GACpB,IAAMkH,EAAuB,IAAI,EAAAwsB,eAAer0B,KAAKkB,UAAWP,GAEhE,OADAX,KAAKqzB,aAAaxrB,EAAMlH,GACjBkH,GAEf,EArZJ,GAAa,EAAAinB,c,8ZC5Cb,WAIA,OAEA,cAQQ,WAAYze,EAAyBC,EAAiB3P,EAAeoQ,GAArE,MACI,cAAO,K,OAHD,EAAAL,MAAgB,GAItB,EAAKxP,UAAYmP,EACjB,EAAKC,QAAUA,EACf,EAAKS,IAAMA,EACX,EAAKpQ,KAAOA,E,EAsBpB,OAnCoC,OAgBzB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,QAAS,CACxB,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBAC3C0M,EAAQ1Q,KAAKsQ,QACXgkB,EAAe,EAAAnpB,mBAAmBnL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC9DmtB,IACA5jB,EAAS4jB,EAA6BlpB,SAAWpL,KAAKsQ,SAE1DtM,EAAgBmF,gBAAgBuH,EAAO1Q,KAAK+Q,KAC5C/Q,KAAKO,gBAELP,KAAKO,YAIN,YAAAN,KAAP,WACI,YAAMA,KAAI,YAElB,EAnCJ,CAAwC,EAAAe,UAA3B,EAAA6yB,sB,8ZCNb,WACA,OAUA,QAGA,cAOQ,WAAYxjB,EAAkCC,GAA9C,MACI,cAAO,K,OAHD,EAAAikB,YAAwB,GAI9B,EAAK5a,eAAgB,EACrB,EAAKlJ,WAAaJ,EAClB,EAAKC,QAAUA,E,EAwFvB,OAnG8B,OAcnB,YAAAU,aAAP,SAAoBR,GACZxQ,KAAKwH,UACL,EAAAoU,wBAAwB5b,KAAKwH,SAAUgJ,IAKxC,YAAAW,UAAP,SAAiB/O,GACRpC,KAAKN,aACNM,KAAKu0B,YAAYzoB,KAAK1J,GACtBpC,KAAKD,QAIN,YAAAqR,WAAP,SAAkBhP,GACd,IAAM6L,EAAQjO,KAAKu0B,YAAY7Z,QAAQtY,GACnC6L,GAAS,IACLA,EAAQ,EACRjO,KAAKu0B,YAAY5lB,OAAOV,EAAO,IAE/BjO,KAAKu0B,YAAY5lB,OAAOV,EAAO,GAC3BjO,KAAKN,YACLM,KAAKwH,SAASvH,UAMvB,YAAAoR,YAAP,SAAmBjP,GACf,IAAM6L,EAAQjO,KAAKu0B,YAAY7Z,QAAQtY,GACnC6L,GAAS,IACLA,EAAQ,EACRjO,KAAKu0B,YAAY5lB,OAAOV,EAAO,IAE/BjO,KAAKu0B,YAAY5lB,OAAOV,EAAO,GAC3BjO,KAAKN,YACLM,KAAKwH,SAASpH,WAKvB,YAAAL,IAAP,WACI,YAAMA,IAAG,WACTC,KAAK2Z,eAAgB,EACjB3Z,KAAKwH,WACLxH,KAAKwH,SAASE,GAAG,EAAAjI,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAChEA,KAAKwH,SAASE,GAAG,EAAAjI,UAAUa,YAAaN,KAAK2H,QAAS3H,OAEtDA,KAAKu0B,YAAYlzB,OAAS,EAC1BrB,KAAKwH,SAASzH,MAEdC,KAAKO,YAKN,YAAAN,KAAP,WACID,KAAKO,WACL,YAAMN,KAAI,YAEP,YAAAG,MAAP,WACIJ,KAAKO,WACL,YAAMH,MAAK,YAGR,YAAAG,SAAP,WACIP,KAAKu0B,YAAYlzB,OAAS,EAC1BrB,KAAKwH,SAASQ,IAAI,EAAAvI,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MACjEA,KAAKwH,SAASQ,IAAI,EAAAvI,UAAUa,YAAaN,KAAK2H,QAAS3H,MACvD,YAAMO,SAAQ,YAER,YAAAuZ,eAAV,WACI,GAAI9Z,KAAKu0B,YAAYlzB,OAAS,EAAG,CAC7B,IAAMmzB,EAASx0B,KAAKu0B,YAAY,GAChCv0B,KAAKu0B,YAAYhzB,QACjBvB,KAAKN,YAAa,EAClBM,KAAKK,KAAK,EAAAZ,UAAUwR,sBAAuBujB,GAE3Cx0B,KAAKu0B,YAAYlzB,OAAS,EAC1BrB,KAAKwH,SAASzH,MAEdC,KAAKO,YAIjB,EAnGJ,CAAkC,EAAA0H,eAArB,EAAA2rB,gB,8ECbb,qB,IAA8B,sDAC1B,IAAMa,EAAQ,WACd,OAAQhvB,EAAKpE,QAET,KAAK,EAAG,OAAO6D,QAAQC,IAAIsvB,EAAOhvB,EAAK,IAEvC,KAAK,EAAG,OAAOP,QAAQC,IAAIsvB,EAAOhvB,EAAK,GAAIA,EAAK,IAEhD,KAAK,EAAG,OAAOP,QAAQC,IAAIsvB,EAAOhvB,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAEzD,KAAK,EAAG,OAAOP,QAAQC,IAAIsvB,EAAOhvB,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAElE,KAAK,EAAG,OAAOP,QAAQC,IAAIsvB,EAAOhvB,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE3E,KAAK,EAAG,OAAOP,QAAQC,IAAIsvB,EAAOhvB,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,O,8ZCf5F,IAIA,cAKQ,WAAY4K,EAAyBwE,GAArC,MACI,cAAO,K,OACP,EAAK3T,UAAYmP,EACjB,EAAKwE,WAAaA,E,EAa1B,OArBqC,OAW1B,YAAA9U,IAAP,WACI,YAAMA,IAAG,WACT,IAAM8B,EAAU7B,KAAKkB,UAAUW,QAC3BA,GACAA,EAAQ+S,kBAAkB5U,KAAK6U,YAC/B7U,KAAKO,YAELP,KAAKO,YAGjB,EArBJ,CAJA,KAIyCS,UAA5B,EAAAgzB,uB,8ZCJb,IAIA,cAKQ,WAAY3jB,EAAyBwE,GAArC,MACI,cAAO,K,OACP,EAAK3T,UAAYmP,EACjB,EAAKwE,WAAaA,E,EAa1B,OArBqC,OAW1B,YAAA9U,IAAP,WACI,YAAMA,IAAG,WACT,IAAM8B,EAAU7B,KAAKkB,UAAUW,QAC3BA,GACAA,EAAQiT,kBAAkB9U,KAAK6U,YAC/B7U,KAAKO,YAELP,KAAKO,YAGjB,EArBJ,CAJA,KAIyCS,UAA5B,EAAAizB,uB,8ZCJb,IAIA,cAMQ,WAAY5jB,EAAyB2E,EAAiBH,GAAtD,MACI,cAAO,K,OACP,EAAK3T,UAAYmP,EACjB,EAAK2E,QAAUA,EACf,EAAKH,WAAaA,E,EAc1B,OAxBiC,OAatB,YAAA9U,IAAP,WACI,YAAMA,IAAG,WACT,IAAM8B,EAAU7B,KAAKkB,UAAUW,QAC3BA,GACAA,EAAQkT,gBAAgB/U,KAAKgV,QAAShV,KAAK6U,YAC3C7U,KAAKO,YAELP,KAAKO,YAIjB,EAxBJ,CAJA,KAIqCS,UAAxB,EAAAkzB,mB,8ZCJb,IAIA,cAKQ,WAAY7jB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAcpB,OAtB8B,OAWnB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IACM4G,EADkB/N,KAAKkB,UAAUW,QAAQmC,gBACfgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QACxE4G,GACAA,EAAQrP,MAAMsN,MAGtBhM,KAAKO,YAEb,EAtBJ,CAJA,KAIkCS,UAArB,EAAAkxB,gB,8ZCJb,IAIA,cAKQ,WAAY7hB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAepB,OAvB+B,OAWpB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IACM4G,EADkB/N,KAAKkB,UAAUW,QAAQmC,gBACfgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC5E,GAAI4G,EACYA,EAAQrP,MAChBoN,KAAK9L,KAAKW,KAAKjC,OAG3BsB,KAAKO,YAEb,EAvBJ,CAJA,KAImCS,UAAtB,EAAAmxB,iB,8ZCJb,IAIA,cAKQ,WAAY9hB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAmBpB,OA3BiC,OAWtB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IACM4G,EADkB/N,KAAKkB,UAAUW,QAAQmC,gBACfgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC5E,GAAI4G,EAAS,CACT,IAAMrP,EAAQsB,KAAKW,KAAKjC,WACV2D,IAAV3D,EACAqP,EAAQrP,MAAMiQ,OAAO3O,KAAKW,KAAK8U,MAAOzV,KAAKW,KAAKiO,aAAe,EAAGlQ,GAElEqP,EAAQrP,MAAMiQ,OAAO3O,KAAKW,KAAK8U,MAAOzV,KAAKW,KAAKiO,aAAe,IAI3E5O,KAAKO,YAEb,EA3BJ,CAJA,KAIqCS,UAAxB,EAAAoxB,mB,8ZCJb,IAIA,cAKQ,WAAY/hB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAepB,OAvBiC,OAWtB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IAAMnD,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACzC+J,EAAU/J,EAAgBgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC5E,GAAI4G,EAAS,CACT,IAAMpF,EAAMoF,EAAQrP,MACpBsF,EAAgB0E,QAAQC,IAGhC3I,KAAKO,YAEb,EAvBJ,CAJA,KAIqCS,UAAxB,EAAAqxB,mB,8ZCJb,IAIA,cAKQ,WAAYhiB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAcpB,OAtB+B,OAWpB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IACM4G,EADkB/N,KAAKkB,UAAUW,QAAQmC,gBACfgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QACxE4G,IACAA,EAAQrP,MAAQsB,KAAKW,KAAKjC,OAGlCsB,KAAKO,YAEb,EAtBJ,CAJA,KAImCS,UAAtB,EAAAixB,iB,8ZCJb,IAIA,cAKQ,WAAY5hB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAmBpB,OA3BiC,OAWtB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IAAMnD,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACzC+J,EAAU/J,EAAgBgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QACtEutB,EAAa1wB,EAAgBgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKg0B,WAC3E5mB,GAAW2mB,IACP10B,KAAKW,KAAKjC,MACVqP,EAAQrP,MAAQg2B,EAAWh2B,MAAMkD,OAAO5B,KAAKW,KAAKjC,OAElDqP,EAAQrP,MAAQg2B,EAAWh2B,MAAMkD,UAI7C5B,KAAKO,YAEb,EA3BJ,CAJA,KAIqCS,UAAxB,EAAAsxB,mB,8ZCJb,IAIA,cAKQ,WAAYjiB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAcpB,OAtBgC,OAWrB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IACM4G,EADkB/N,KAAKkB,UAAUW,QAAQmC,gBACfgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QACxE4G,GACAA,EAAQrP,MAAM6C,QAGtBvB,KAAKO,YAEb,EAtBJ,CAJA,KAIoCS,UAAvB,EAAAuxB,kB,8ZCJb,IAIA,cAKQ,WAAYliB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAepB,OAvBkC,OAWvB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,SAAW7B,KAAKW,KAAKwG,OAAQ,CAC5C,IACM4G,EADkB/N,KAAKkB,UAAUW,QAAQmC,gBACfgH,kBAAkBhL,KAAKkB,UAAWlB,KAAKW,KAAKwG,QAC5E,GAAI4G,EACYA,EAAQrP,MAChB8P,QAAQxO,KAAKW,KAAKjC,OAG9BsB,KAAKO,YAEb,EAvBJ,CAJA,KAIsCS,UAAzB,EAAAwxB,oB,8ZCJb,WAGA,OAEA,cAKQ,WAAYniB,EAAyB1P,GAArC,MACI,cAAO,K,OACP,EAAKO,UAAYmP,EACjB,EAAK1P,KAAOA,E,EAyBpB,OAjCoC,OAWzB,YAAAZ,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,WAAalB,KAAKkB,UAAUW,QAAS,CAC1C,IAAMmC,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBACzC8J,EAA+B,EAAA3C,mBAAmBnL,KAAKkB,UACLlB,KAAKW,KAAKwG,QAC9D2G,EACA9J,EAAgBmG,2BAA2B2D,EACA9N,KAAKW,KAAKyJ,MACVpK,KAAKW,KAAKstB,aACVjuB,KAAKW,KAAKjC,OAErDsF,EAAgBuG,wBACwBvK,KAAKW,KAAKyJ,MACVpK,KAAKW,KAAKstB,aACVjuB,KAAKW,KAAKjC,OAK1DsB,KAAKO,YAEb,EAjCJ,CAAwC,EAAAS,UAA3B,EAAA0xB,sB,8ZCLb,IAIA,cAOQ,WAAYriB,EAAyBkM,EAAyBS,EAAkBrc,GAAhF,MACI,cAAO,K,OAJJ,EAAAqc,QAAkB,KAKrB,EAAK9b,UAAYmP,EACjB,EAAKkM,QAAUA,EACf,EAAK5b,KAAOA,EACRqc,IACA,EAAKA,QAAUA,G,EA6B3B,OA1CgC,OAkBrB,YAAAjd,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,QAAS,CACxB,IAAMob,EAAejd,KAAKkB,UAAUW,QAAQob,aACtCjZ,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBAC3CuY,EAAkB,EACtB,GAAIhZ,MAAMC,QAAQxD,KAAKuc,SAAU,CAC7B,IAAMW,EAAalZ,EAAgBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKuc,SAExEA,EADAW,GAAcA,EAAWxe,MACfwe,EAAWxe,MAEXwe,OAGdX,EAAUvc,KAAKuc,QAGnBU,EAAa6M,WAAWvN,EAASvc,KAAKgd,QAAShd,KAAKW,MACpDX,KAAKO,gBAELP,KAAKO,YAIjB,EA1CJ,CAJA,KAIoCS,UAAvB,EAAA8yB,kB,8ZCJb,IAIA,cAOQ,WAAYzjB,EAAyBkM,EAAyBS,EAAkBrc,GAAhF,MACI,cAAO,K,OAJJ,EAAAqc,QAAkB,KAKrB,EAAK9b,UAAYmP,EACjB,EAAKkM,QAAUA,EACf,EAAK5b,KAAOA,EACRqc,IACA,EAAKA,QAAUA,G,EA6B3B,OA1CiC,OAkBtB,YAAAjd,IAAP,WAEI,GADA,YAAMA,IAAG,WACLC,KAAKkB,UAAUW,QAAS,CACxB,IAAMob,EAAejd,KAAKkB,UAAUW,QAAQob,aACtCjZ,EAAkBhE,KAAKkB,UAAUW,QAAQmC,gBAC3CuY,EAAkB,EACtB,GAAIhZ,MAAMC,QAAQxD,KAAKuc,SAAU,CAC7B,IAAMW,EAAalZ,EAAgBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKuc,SAExEA,EADAW,GAAcA,EAAWxe,MACfwe,EAAWxe,MAEXwe,OAGdX,EAAUvc,KAAKuc,QAGnBU,EAAaqN,YAAY/N,EAASvc,KAAKgd,QAAShd,KAAKW,MACrDX,KAAKO,gBAELP,KAAKO,YAIjB,EA1CJ,CAJA,KAIqCS,UAAxB,EAAA+yB,mB,8ZCJb,IAEA,cAGQ,a,OACI,cAAO,KAQf,OAZ2B,OAOhB,YAAAh0B,IAAP,WACI,YAAMA,IAAG,WACTC,KAAKI,QACLJ,KAAKO,YAEb,EAZJ,CAFA,KAE+BS,UAAlB,EAAAgyB,a,8ZCFb,WAGA,OAEA,cAMI,WAAY9xB,EAAwBP,GAApC,MACI,cAAO,K,OACP,EAAKO,UAAYA,EACjB,EAAKP,KAAOA,E,EAgCpB,OAzC8B,OAY1B,sBAAY,sBAAO,C,IAAnB,WACI,IAAIuH,EAAe,EACf3E,MAAMC,QAAQxD,KAAKW,KAAKjC,OACpBsB,KAAKkB,WAAalB,KAAKkB,UAAUW,UAEjCqG,EADwBlI,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKjC,QAIzEwJ,EAAOlI,KAAKW,KAAKjC,MAKrB,OAHK,EAAAyP,SAASjG,KACVA,EAAO,GAEJA,G,gCAGJ,YAAAnI,IAAP,sBACI,YAAMA,IAAG,WACT,IAAMkkB,EAAUjkB,KAAKikB,QACrBjkB,KAAK40B,eAAiB/zB,GAAGsD,IAAI0wB,UAAUC,WAAW7Q,GAAS,WACnD,EAAK2Q,iBACL,EAAKA,eAAe30B,OACpB,EAAK20B,oBAAiBvyB,GAG1B,EAAK9B,eAGjB,EAzCA,CAA8B,EAAAS,UAAjB,EAAAiyB,Y,8ZCFb,WAGA,cAMQ,WAAY/xB,EAAwBP,GAApC,MACI,cAAO,K,OACP,EAAKO,UAAYA,EACjB,EAAKP,KAAOA,E,EAmCpB,OA5CgC,OAY5B,sBAAY,sBAAO,C,IAAnB,WACI,IAAIuH,EAAe,EACf3E,MAAMC,QAAQxD,KAAKW,KAAKjC,OACpBsB,KAAKkB,WAAalB,KAAKkB,UAAUW,UAEjCqG,EADwBlI,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKjC,QAIzEwJ,EAAOlI,KAAKW,KAAKjC,MAKrB,OAHK,EAAAyP,SAASjG,KACVA,EAAO,GAEJA,G,gCAGJ,YAAAnI,IAAP,sBACI,YAAMA,IAAG,WACT,IAAMkkB,EAAUjkB,KAAKikB,QACrBjkB,KAAK40B,eAAiB/zB,GAAGsD,IAAI0wB,UAAUC,WAAW7Q,GAAS,WACnD,EAAK2Q,iBACL,EAAKA,eAAe30B,OACpB,EAAK20B,oBAAiBvyB,GAEtB,EAAKmF,UACL,EAAKA,SAASzH,SAItBC,KAAKO,YAEb,EA5CJ,CAFA,KAEoC0H,eAAvB,EAAAksB,kB,8ZCNb,WAGA,OAGA,cAUQ,WAAYjzB,EAAwBP,GAApC,MACI,cAAO,K,OANH,EAAAo0B,UAAoB,EACpB,EAAAC,kBAA4B,EAC5B,EAAAC,kBAA4B,EAC5B,EAAAC,SAAmB,EACnB,EAAAjV,OAAiB,EAGrB,EAAK/e,UAAYA,EACjB,EAAKP,KAAOA,E,EAsIpB,OAnJiC,OAgB7B,sBAAY,sBAAO,C,IAAnB,WACI,IAAIuH,EAAe,EACf3E,MAAMC,QAAQxD,KAAKW,KAAKjC,OACpBsB,KAAKkB,WAAalB,KAAKkB,UAAUW,UAEjCqG,EADwBlI,KAAKkB,UAAUW,QAAQmC,gBACxBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAKjC,QAGzEwJ,EAAOlI,KAAKW,KAAKjC,MAKrB,OAHK,EAAAyP,SAASjG,KACVA,EAAO,GAEJA,G,gCAGX,sBAAY,oBAAK,C,IAAjB,WACI,IAAIsQ,EAAgB,EAChBjV,MAAMC,QAAQxD,KAAKW,KAAK6X,OACpBxY,KAAKkB,WAAalB,KAAKkB,UAAUW,UAEjC2W,EADwBxY,KAAKkB,UAAUW,QAAQmC,gBACvBE,oBAAoBlE,KAAKkB,UAAWlB,KAAKW,KAAK6X,QAKtEA,OADoBnW,IAApBrC,KAAKW,KAAK6X,MACF,EAEAxY,KAAKW,KAAK6X,MAO1B,OAHK,EAAArK,SAASqK,KACVA,EAAQ,GAELA,G,gCAGJ,YAAAzY,IAAP,WACI,YAAMA,IAAG,WACTC,KAAKk1B,SAAWl1B,KAAKikB,QACrBjkB,KAAKigB,OAASjgB,KAAKwY,MACnBxY,KAAK+0B,UAAY/0B,KAAKigB,OAClBjgB,KAAKwH,UACLxH,KAAKwH,SAASoK,YAAY,EAAAnS,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAG7EA,KAAKm1B,QAAQn1B,KAAKk1B,SAAUl1B,KAAKigB,SAG9B,YAAA1f,SAAP,WAEI,YAAMA,SAAQ,WACVP,KAAK40B,iBACL50B,KAAK40B,eAAe30B,OACpBD,KAAK40B,oBAAiBvyB,GAEtBrC,KAAKwH,UACLxH,KAAKwH,SAASqK,eAAe,EAAApS,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,OAI7E,YAAAC,KAAP,WACI,YAAMA,KAAI,WACVD,KAAKO,YAGF,YAAAJ,OAAP,WACQH,KAAKL,WACDK,KAAKg1B,kBAAoBh1B,KAAKi1B,kBAC9Bj1B,KAAKo1B,cAAcp1B,KAAKk1B,SAAUl1B,KAAKigB,QAG/C,YAAM9f,OAAM,YAER,YAAA2Z,eAAR,WACI9Z,KAAKg1B,kBAAmB,EACpBh1B,KAAKi1B,kBACLj1B,KAAKo1B,cAAcp1B,KAAKk1B,SAAUl1B,KAAKigB,SAIvC,YAAAkV,QAAR,SAAgBlR,EAAiBzL,GAAjC,WACIxY,KAAKi1B,kBAAmB,OACI5yB,IAAxBrC,KAAK40B,eACL50B,KAAK40B,eAAiB/zB,GAAGsD,IAAI0wB,UAAUC,WAAW7Q,GAAS,WACvD,EAAKgR,kBAAmB,EACpB,EAAKL,gBACL,EAAKA,eAAe30B,OAGpB,EAAK+0B,kBAAoB,EAAKC,kBAC9B,EAAKG,cAAcnR,EAASzL,MAIpCxY,KAAK40B,eAAeS,WAMpB,YAAAD,cAAR,SAAsBnR,EAAiBzL,GACnC,IAAIxY,KAAKL,YAAaK,KAAKJ,aAA3B,CAII4Y,EAAQ,KACJxY,KAAK+0B,UAAY,GAUrB/0B,KAAKO,YAELP,KAAK+0B,YACD/0B,KAAKwH,UACLxH,KAAKg1B,kBAAmB,EACxBh1B,KAAKm1B,QAAQlR,EAASzL,GACtBxY,KAAKwH,SAASzH,OAGdC,KAAKO,cAIrB,EAnJJ,CAFA,KAEqC0H,eAAxB,EAAAmsB,mB,8ZCNb,WAMA,cAMQ,WAAYlzB,EAAwBP,GAApC,MACI,cAAO,K,OAHH,EAAAq0B,kBAA4B,EAIhC,EAAK9zB,UAAYA,EACjB,EAAKP,KAAOA,E,EAsEpB,OA/EgC,OAYrB,YAAAZ,IAAP,WAGI,GAFA,YAAMA,IAAG,WAELC,KAAKkB,UAAW,CAChB,IAAMW,EAAU7B,KAAKkB,UAAUW,QAC3BA,GAAWA,EAAQW,KACfxC,KAAKwH,UACLxH,KAAKwH,SAASoK,YAAY,EAAAnS,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAE7E6B,EAAQW,IAAI4iB,OAAOC,IAAIrlB,KAAKkgB,KAAMlgB,OAElCA,KAAKO,gBAGTP,KAAKO,YAIN,YAAAA,SAAP,WAKI,GAJA,YAAMA,SAAQ,WACVP,KAAKwH,UACLxH,KAAKwH,SAASqK,eAAe,EAAApS,UAAUe,eAAgBR,KAAK8Z,eAAgB9Z,MAE5EA,KAAKkB,UAAW,CAChB,IAAMW,EAAU7B,KAAKkB,UAAUW,QAC3BA,GAAWA,EAAQW,KACnBX,EAAQW,IAAI4iB,OAAOS,OAAO7lB,KAAKkgB,KAAMlgB,QAI1C,YAAAC,KAAP,WACI,YAAMA,KAAI,WACVD,KAAKO,YAGF,YAAAL,MAAP,WAEI,GADA,YAAMA,MAAK,WACPF,KAAKkB,UAAW,CAChB,IAAMW,EAAU7B,KAAKkB,UAAUW,QAC3BA,GAAWA,EAAQW,KACnBX,EAAQW,IAAI4iB,OAAOS,OAAO7lB,KAAKkgB,KAAMlgB,QAK1C,YAAAG,OAAP,WACI,GAAIH,KAAKL,WACDK,KAAKkB,UAAW,CAChB,IAAMW,EAAU7B,KAAKkB,UAAUW,QAC3BA,GAAWA,EAAQW,KACnBX,EAAQW,IAAI4iB,OAAOC,IAAIrlB,KAAKkgB,KAAMlgB,MAI9C,YAAMG,OAAM,YAGR,YAAA2Z,eAAR,WACI9Z,KAAKg1B,kBAAmB,GAEpB,YAAA9U,KAAR,WACQlgB,KAAKg1B,kBACDh1B,KAAKwH,UACLxH,KAAKwH,SAASzH,OAI9B,EA/EJ,CAFA,KAEoCkI,eAAvB,EAAAosB,kB,8ECNb,YAGA,QACA,QACA,QACA,QACA,QAEA,QACA,QAEA,aA0BQ,WAAYnzB,EAAwBP,EAAoB6jB,QAAA,IAAAA,MAAA,IAxBhD,KAAA8Q,aAAkD,GAClD,KAAAC,gBAA6F,GAE7F,KAAA/S,OAAM,EACN,KAAAgT,kBAAqC,GAErC,KAAAC,SAAmB,EACnB,KAAAvW,QAAkB,EAClB,KAAAP,SAAmB,EACnB,KAAA+W,YAAsB,EACtB,KAAAC,UAAoB,EACpB,KAAAC,WAAqB,EAGrB,KAAAC,UAAoB,GACpB,KAAAC,OAAiB,EACjB,KAAAtR,IAAc,GACd,KAAAuR,gBAA0B,GAC1B,KAAAC,oBAA8B,EAC9B,KAAAC,wBAAkC,EAClC,KAAAC,kBAA4B,EAC5B,KAAAC,sBAAgC,EAChC,KAAAC,cAAwB,EAG5Bp2B,KAAKkB,UAAYA,EACjBlB,KAAKW,KAAOA,EACR6jB,EAAM,IACNxkB,KAAKwkB,IAAMA,GAEfxkB,KAAK61B,UAAYvxB,KAAK+xB,KAAK,IAAOr2B,KAAKwkB,KACvCxkB,KAAK81B,OAAS,EACd91B,KAAK0wB,YA2Tb,OAxTW,YAAA4F,iBAAP,SAAwBC,GACpB,IAAMv4B,EAAOu4B,EAAKv4B,KACdixB,EAAajvB,KAAKs1B,aAAat3B,GACjB,MAAdixB,IACAA,EAAa,GACbjvB,KAAKs1B,aAAat3B,GAAQixB,GAE9BA,EAAWnjB,KAAKyqB,IAGb,YAAAne,aAAP,WACI,GAAoB,IAAhBpY,KAAKwiB,OACL,MAAO,CACHrK,UAAWnY,KAAK+1B,gBAChBxd,MAAOjU,KAAKoJ,MAAM1N,KAAK01B,YAAc11B,KAAKwkB,IAAM,KAChDhM,MAAOxY,KAAKk2B,mBAAqB,EACrBl2B,KAAKk2B,kBACJl2B,KAAKk2B,kBAAoBl2B,KAAKo2B,gBAKhD,YAAA3d,qBAAP,WACI,GAAoB,IAAhBzY,KAAKwiB,OAGT,IAAM,IAAM,KAAQxiB,KAAKu1B,gBACrB,GAAIv1B,KAAKu1B,gBAAgB,GAAO,CAC5B,IAAMvhB,EAAShU,KAAKu1B,gBAAgB,GACpC,GAAIvhB,EAAO0W,SAAU,CACjB1qB,KAAKqU,KAAK,EAAML,EAAOyL,MAAQ,EAAI,GACnC,SAMT,YAAAnH,SAAP,SAAgBta,EAAcw4B,EAAoBhe,QAAA,IAAAA,MAAA,GAC1B,IAAhBxY,KAAKwiB,QACLxiB,KAAKC,OAET,IAAM+T,EAAShU,KAAKu1B,gBAAgBv3B,GAChCgW,GACAhU,KAAKg2B,oBAAsBhiB,EAAO0L,UAMtC1f,KAAK+1B,gBAAkB/3B,EACvBgC,KAAKw1B,kBAAoBx1B,KAAKs1B,aAAat3B,GAC3CgC,KAAKk2B,kBAAoB1d,EACzBxY,KAAKm2B,sBAAwB7xB,KAAKoJ,MAAM1N,KAAKg2B,oBACLh2B,KAAKk2B,mBAAqB,IAAOl2B,KAAKwkB,MAC9ExkB,KAAKi2B,wBAA0B3xB,KAAKoJ,MAAiC,IAA3B1N,KAAKg2B,oBAA6Bh2B,KAAKwkB,KACjFxkB,KAAK01B,YAAcc,GAAc,IAAOx2B,KAAKwkB,KAC7CxkB,KAAK81B,OAAS,EACd91B,KAAKy2B,WAAWz2B,KAAK01B,aACrB11B,KAAKwiB,OAAS,EACdxiB,KAAK21B,WAAY,IAAI/oB,MAAOI,UAC5BhN,KAAKkf,QAAUlf,KAAK21B,UACpB31B,KAAK2e,SAAW3e,KAAK21B,UACrB31B,KAAK21B,WAAa31B,KAAK01B,YACvB11B,KAAKo2B,cAAgB,EACrBv1B,GAAG61B,OAAOC,OAAOtR,IAAIrlB,KAAKkgB,KAAMlgB,OAlB5BkF,QAAQ0xB,KAAK,0BAA2B54B,IAoBzC,YAAA0a,SAAP,SAAgB1a,EAAcw4B,GACN,IAAhBx2B,KAAKwiB,QACLxiB,KAAKC,OAET,IAAM+T,EAAShU,KAAKu1B,gBAAgBv3B,GAChCgW,GACAhU,KAAKg2B,oBAAsBhiB,EAAO0L,UAOtC1f,KAAKw1B,kBAAoBx1B,KAAKs1B,aAAat3B,GAC3CgC,KAAKk2B,kBAAoB,EACzBl2B,KAAKm2B,sBAAwB7xB,KAAKoJ,MAAM1N,KAAKg2B,oBACLh2B,KAAKk2B,mBAAqB,IAAOl2B,KAAKwkB,MAC9ExkB,KAAKi2B,wBAA0B3xB,KAAKoJ,MAAiC,IAA3B1N,KAAKg2B,oBAA6Bh2B,KAAKwkB,KACjFxkB,KAAK01B,YAAcc,GAAc,IAAOx2B,KAAKwkB,KAC7CxkB,KAAK81B,OAAS,EACd91B,KAAKy2B,WAAWz2B,KAAK01B,aACrB11B,KAAKwiB,OAAS,EACdxiB,KAAK21B,WAAY,IAAI/oB,MAAOI,UAC5BhN,KAAKkf,QAAUlf,KAAK21B,UACpB31B,KAAK2e,SAAW3e,KAAK21B,UACrB31B,KAAK21B,WAAa31B,KAAK01B,YACvB11B,KAAKo2B,cAAgB,EACrBp2B,KAAKkgB,QAlBDhb,QAAQ0xB,KAAK,0BAA2B54B,IAqBzC,YAAAqW,KAAP,SAAYrW,EAAcwa,QAAA,IAAAA,MAAA,GACvBxY,KAAKsY,SAASta,EAAM,EAAGwa,IAGnB,YAAAvY,KAAP,WACIY,GAAG61B,OAAOC,OAAO9Q,OAAO7lB,KAAKkgB,KAAMlgB,MACnCA,KAAKwiB,OAAS,EACdxiB,KAAK62B,iBAGT,sBAAc,2BAAY,C,IAA1B,SAA2BrtB,GACnBA,IAAMxJ,KAAKo2B,gBACXp2B,KAAKo2B,cAAgB5sB,EACjBxJ,KAAKkB,YACLlB,KAAKkB,UAAUb,KAAK,wBAAsCmJ,GACtDxJ,KAAKk2B,kBAAoB,GAAKl2B,KAAKo2B,eAAiBp2B,KAAKk2B,mBACzDl2B,KAAKkB,UAAUb,KAAK,wB,gCAK1B,YAAA6f,KAAV,WACI,IAAMhB,GAAU,IAAItS,MAAOI,UAC3BhN,KAAKkf,QAAUA,EACf,IAAM4X,EAAK92B,KAAKkf,QAAUlf,KAAK2e,SAE/B,GADA3e,KAAK01B,aAAeoB,EAChB92B,KAAKy1B,QAAS,CAEd,GADAz1B,KAAK81B,QAAUgB,EACX92B,KAAK81B,OAAS91B,KAAK61B,UASnB,OARA71B,KAAK2e,SAAW3e,KAAKkf,QACrBlf,KAAK41B,WAAa51B,KAAKkf,QAAUlf,KAAK21B,UAElC31B,KAAKk2B,kBAAoB,GACzBl2B,KAAK41B,WAAa51B,KAAKm2B,uBACvBn2B,KAAKC,YAETD,KAAK+2B,aAAezyB,KAAKuE,MAAM7I,KAAK41B,WAAa51B,KAAKi2B,0BAG1D,KAAOj2B,KAAK81B,OAAS91B,KAAK61B,WACtB71B,KAAK81B,QAAU91B,KAAK61B,UAGxB71B,KAAK01B,YAAc11B,KAAKi2B,0BACpBj2B,KAAKk2B,kBAAoB,GACzBl2B,KAAKk2B,kBAAoB,GAAKl2B,KAAKo2B,cAAgBp2B,KAAKk2B,kBAAoB,KAC5El2B,KAAK01B,YAAc11B,KAAK01B,YAAc11B,KAAKi2B,yBAGnDj2B,KAAKy2B,WAAWz2B,KAAK01B,aAErB11B,KAAK2e,SAAW3e,KAAKkf,QACrBlf,KAAK41B,WAAa51B,KAAKkf,QAAUlf,KAAK21B,UAElC31B,KAAKk2B,kBAAoB,GACzBl2B,KAAK41B,WAAa51B,KAAKm2B,uBACvBn2B,KAAKC,OAETD,KAAK+2B,aAAezyB,KAAKuE,MAAM7I,KAAK41B,WAAa51B,KAAKi2B,0BAIhD,YAAAQ,WAAV,SAAqBvX,GACjB,GAAIlf,KAAKw1B,kBACL,IAAK,IAAIn4B,EAAY,EAAG6E,EAAclC,KAAKw1B,kBAAkBn0B,OAAQhE,EAAI6E,EAAK7E,IAAK,CAClE2C,KAAKw1B,kBAAkBn4B,GAC/B6hB,QAAUA,IAKjB,YAAA2X,cAAV,WACI,GAAI72B,KAAKw1B,kBACL,IAAK,IAAIn4B,EAAY,EAAG6E,EAAclC,KAAKw1B,kBAAkBn0B,OAAQhE,EAAI6E,EAAK7E,IAAK,CAClE2C,KAAKw1B,kBAAkBn4B,GAC/Bw5B,kBAKT,YAAAnG,UAAR,WACI,GAAI1wB,KAAKkB,WAAalB,KAAKW,KACvB,IAAK,IAAItD,EAAY,EAAG6E,EAAclC,KAAKW,KAAKU,OAAQhE,EAAI6E,EAAK7E,IAC7D2C,KAAKg3B,eAAeh3B,KAAKW,KAAKtD,KAKlC,YAAA25B,eAAR,SAAuBC,GACnB,IAAMj5B,EAAOi5B,EAAKj5B,KACZ0hB,EAAYuX,EAAK5P,UAAY,EAI7BrT,EAAS,CACXyL,KAJSwX,EAAKxX,KAKdC,UAAS,EACTgL,SALauM,EAAKvM,UAOtB1qB,KAAKu1B,gBAAgBv3B,GAAQgW,EAC7B,IAAIqT,EAAmB,EACvB,IAAK,IAAMroB,KAAOi4B,EAAK5hB,SACnB,GAAI4hB,EAAK5hB,SAASrW,GAAM,CACpB,IAAMk4B,EAAKl3B,KAAKm3B,mBAAoBn4B,EAAKhB,EAAMi5B,EAAK5hB,SAASrW,IACzDk4B,GAAMA,EAAGxX,UAAY2H,IACrBA,EAAW6P,EAAGxX,aAKrBuX,EAAK5P,UAAY4P,EAAK5P,UAAY,KACnC4P,EAAK5P,SAAWA,EAChBrT,EAAO0L,UAAY2H,IAInB,YAAA8P,mBAAR,SAA2BC,EAAqBC,EACrBC,GACvB,IACIp2B,EADEI,EAAU81B,EAOhB,GAJIl2B,EADY,UAAZI,EACYtB,KAAKkB,UAELlB,KAAKkB,UAAUO,aAAaH,GAE7B,CACX,IAAMi2B,EAAW,IAAI,EAAAC,cAAcH,GACnCE,EAASv5B,KAAOq5B,EAChBE,EAAS/S,IAAMxkB,KAAKwkB,IACpB+S,EAASpwB,OAASjG,EAClBq2B,EAAS7X,UAAY4X,EAAajQ,UAAY,EAC9CkQ,EAAS9X,OAAS6X,EAAa7X,KAE/B,IADA,IAAI4H,EAAmB,EACdhqB,EAAY,EAAG6E,EAAco1B,EAAaG,UAAUp2B,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC/E,IAAMq6B,EAAeJ,EAAaG,UAAUp6B,GACtCs6B,EAAW33B,KAAK43B,cAAcF,EAAcJ,EAAajQ,UAC3DsQ,IACAJ,EAASE,UAAU3rB,KAAK6rB,GACpBA,EAASjY,UAAY2H,IACrBA,EAAWsQ,EAASjY,YAShC,QAJK6X,EAAS7X,WAAa6X,EAAS7X,WAAa,KAC7C6X,EAAS7X,UAAY2H,GAEzBrnB,KAAKs2B,iBAAiBiB,GACfA,IAIP,YAAAK,cAAR,SAAsBj3B,EAAiB0mB,GACnC,IAAIsQ,EAEJ,YAHmC,IAAAtQ,OAAoB,GAG/C1mB,EAAKD,MACT,IAAK,IACL,IAAK,IACL,IAAK,SACL,IAAK,SACL,IAAK,WACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,aACDi3B,EAAW,IAAI,EAAApY,SACfvf,KAAK63B,YAAYF,EAAUh3B,EAAKqe,OAAQ,EAAA8Y,aACxC,MACJ,IAAK,UACL,IAAK,UACDH,EAAW,IAAI,EAAApY,SACfvf,KAAK63B,YAAYF,EAAUh3B,EAAKqe,OAAQ,EAAA+Y,cACxC,MACJ,IAAK,OACL,IAAK,OACDJ,EAAW,IAAI,EAAApY,SACfvf,KAAK63B,YAAYF,EAAUh3B,EAAKqe,OAAQ,EAAAgZ,aACxC,MACJ,IAAK,QACDL,EAAW,IAAI,EAAApY,SACfvf,KAAK63B,YAAYF,EAAUh3B,EAAKqe,OAAQ,EAAAiZ,YACxC,MACJ,IAAK,QACDN,EAAW,IAAI,EAAAnY,cACfxf,KAAK63B,YAAYF,EAAUh3B,EAAKqe,OAAQ,EAAAkZ,YACxC,MACJ,QACIP,EAAW,IAAI,EAAApY,SACfvf,KAAK63B,YAAYF,EAAUh3B,EAAKqe,OAAQ,EAAA8Y,aAahD,OAVIH,IACAA,EAASj3B,KAAOC,EAAKD,KACrBi3B,EAASlY,OAAS9e,EAAK8e,KACnB9e,EAAKqe,QAAUre,EAAKqe,OAAO3d,OAC3Bs2B,EAASjY,UAAY/e,EAAKqe,OAAOre,EAAKqe,OAAO3d,OAAS,GAAGkX,MAEzDof,EAASjY,UAAY,GAItBiY,GAEH,YAAAE,YAAR,SAAoBF,EAAyBh3B,EAAgBw3B,GACzD,IAAK,IAAI96B,EAAY,EAAG6E,EAAcvB,EAAKU,OAAQhE,EAAI6E,EAAK7E,IAAK,CAC7D,IAAM+6B,EAAYz3B,EAAKtD,GACjBkb,EAAQ,IAAI4f,EAClB5f,EAAMrQ,KAAOkwB,EAAU7f,MACvBA,EAAMpQ,MAAQiwB,EAAUjwB,MACxBoQ,EAAM7Z,MAAQ05B,EAAU15B,MACxBi5B,EAAS3Y,OAAOlT,KAAKyM,KAGjC,EA7VJ,GAAa,EAAA2W,a,8ECTb,YAEA,aA0BQ,WAAYlxB,GAPL,KAAAy5B,UAAkC,GAClC,KAAAjT,IAAc,GAEd,KAAA9E,UAAoB,EACpB,KAAAD,MAAgB,EACf,KAAA4Y,SAAmB,EACnB,KAAAtY,UAAoB,EAExB/f,KAAKhC,KAAOA,EAoFpB,OA7GI,sBAAY,4BAAa,C,IAAzB,WACI,OAAOgC,KAAKmH,Q,gCAGhB,sBAAW,sBAAO,C,IAAlB,SAAmBqC,GACfxJ,KAAKq4B,SAAW7uB,EAChBxJ,KAAK+f,UAAY/f,KAAKq4B,SAAWr4B,KAAKwkB,IAAM,IACxCxkB,KAAKyf,OACLzf,KAAK+f,UAAY/f,KAAK+f,UAAY/f,KAAK0f,WAE3C,IAAK,IAAIriB,EAAI,EAAG6E,EAAMlC,KAAKy3B,UAAUp2B,OAAQhE,EAAI6E,EAAK7E,IAClD2C,KAAKy3B,UAAUp6B,GAAGi7B,WAAat4B,KAAK+f,UAExC/f,KAAKu4B,iB,gCAeF,YAAA1B,cAAP,WACI,IAAK,IAAIx5B,EAAI,EAAG6E,EAAMlC,KAAKy3B,UAAUp2B,OAAQhE,EAAI6E,EAAK7E,IAAK,CACvD,IAAMs6B,EAAW33B,KAAKy3B,UAAUp6B,GAC5Bs6B,aAAoB,EAAAnY,eACpBmY,EAASjZ,iBAIb,YAAA6Z,cAAR,WACI,GAAmB,MAAfv4B,KAAKmH,OAGT,IAAK,IAAI9J,EAAY,EAAG6E,EAAclC,KAAKy3B,UAAUp2B,OAAQhE,EAAI6E,EAAK7E,IAAK,CACvE,IAAMs6B,EAAW33B,KAAKy3B,UAAUp6B,GAC1Bm7B,EAAgBx4B,KAAKw4B,cACrBC,EAAWd,EAASc,SAC1B,OAAQd,EAASj3B,MACb,IAAK,IACD83B,EAAc91B,EAAI+1B,EAClB,MACJ,IAAK,IACDD,EAAc71B,EAAI81B,EAClB,MACJ,IAAK,SACDD,EAAclR,OAASmR,EACvB,MACJ,IAAK,SACDD,EAAcjR,OAASkR,EACvB,MACJ,IAAK,WACDD,EAAcE,SAAWD,EACzB,MACJ,IAAK,UACDD,EAAcG,QAAUF,EACxB,MACJ,IAAK,QACDD,EAAcpP,MAAQqP,EACtB,MACJ,IAAK,OACAD,EAA+BpV,KAAOqV,EACvC,MACJ,IAAK,UACDD,EAAcI,QAAUH,EACxB,MACJ,IAAK,aACDD,EAAcK,WAAaJ,EAC3B,MACJ,IAAK,QACD,IAAMK,EAASL,EACf,GAAIK,EACA,IAAK,IAAI7c,EAAY,EAAGC,EAAe4c,EAAOz3B,OAAQ4a,EAAIC,EAAMD,IAAK,CACjE,IAAM,EAAQ6c,EAAO7c,GACpBuc,EAA8Bn4B,KAAK,EAAMK,KAAM,EAAMC,MAG9D,MACJ,QAC4C,IAApCg3B,EAASj3B,KAAKga,QAAQ,UACtB1a,KAAK4G,YAAY4xB,EAAeb,EAASj3B,KAAM+3B,GAE9CD,EAAsBb,EAASj3B,MAAQ+3B,KAOpD,YAAA7xB,YAAR,SAAoBuoB,EAA+BC,EAAmB1wB,GAGlE,IAFA,IAAM2wB,EAAaD,EAAUpY,MAAM,KAC/B7P,EAASgoB,EACJ9xB,EAAY,EAAG6E,EAAcmtB,EAAWhuB,OAAQhE,EAAI6E,EAAM,EAAI7E,IAAK,CACxE,IAAMiyB,EAASD,EAAWhyB,GACtB8J,GAAUA,EAAOmoB,KACjBnoB,EAASA,EAAOmoB,IAGpBnoB,IACAA,EAAOkoB,EAAWA,EAAWhuB,OAAS,IAAM3C,IAIxD,EA/GJ,GAAa,EAAA84B,iB,8ZCLb,IAEA,cAEQ,a,OACI,cAAO,KAMf,OAT6B,OAMlB,YAAApvB,SAAP,SAAgBrB,EAAkBrI,GAC9B,OAAOsB,KAAKtB,OAASA,EAAQsB,KAAKtB,OAASqI,GAEnD,EATJ,CAFA,KAEiCsB,OAApB,EAAAyvB,e,8ZCFb,IAEA,cAEQ,a,OACI,cAAO,KAMf,OAT8B,OAMnB,YAAA1vB,SAAP,SAAgBrB,EAAkBrI,GAC9B,OAAOsB,KAAKtB,OAEpB,EATJ,CAFA,KAEkC2J,OAArB,EAAA0vB,gB,8ZCFb,IAEA,cAEQ,a,OACI,cAAO,KAMf,OAT6B,OAMlB,YAAA3vB,SAAP,SAAgBrB,EAAkBrI,GAC9B,OAAOsB,KAAKtB,OAEpB,EATJ,CAFA,KAEiC2J,OAApB,EAAA2vB,e,8ZCFb,IAEA,cAEQ,a,OACI,cAAO,KA0Bf,OA7B4B,OAMjB,YAAA5vB,SAAP,SAAgBrB,EAAkBrI,GAC9B,IAAMq6B,EAAU/4B,KAAKg5B,gBAAgBh5B,KAAKtB,OACpCu6B,EAAWj5B,KAAKg5B,gBAAgBt6B,GAChCw6B,EAAY,CACdH,EAAQ,IAAME,EAAS,GAAKA,EAAS,IAAMlyB,EAC3CgyB,EAAQ,IAAME,EAAS,GAAKA,EAAS,IAAMlyB,EAC3CgyB,EAAQ,IAAME,EAAS,GAAKA,EAAS,IAAMlyB,GAE/C,OAAO/G,KAAKm5B,gBAAgBD,IAGtB,YAAAF,gBAAV,SAA0BI,GAOtB,MAAO,CALIA,GAAS,GAAM,IAEfA,GAAS,EAAK,IAEdA,GAAS,EAAK,MAGnB,YAAAD,gBAAV,SAA0BE,GACtB,OAAgB,MAATA,EAAI,GAAwB,IAATA,EAAI,GAAaA,EAAI,IAEvD,EA7BJ,CAFA,KAEgChxB,OAAnB,EAAA4vB,c,8ZCFb,IAGA,cAEQ,a,OACI,cAAO,KAMf,OAT4B,OAMjB,YAAA7vB,SAAP,SAAgBrB,EAAkBrI,GAC9B,OAAOsB,KAAKtB,OAEpB,EATJ,CAHA,KAGgC2J,OAAnB,EAAA6vB,c,8ECAb,4BAAiC1X,GAC7B,IACI8Y,EAAM,GAEV,GAH2C,IAAzB9Y,EAAI9F,QAAQ,SAGhB,CACV,IAAM6e,EAAa/Y,EAAI9F,QAAQ,KAE/B4e,EAAM9Y,EAAIgZ,UAAUD,EAAa,EAAG/Y,EAAI9F,QAAQ,IAAK6e,QACpD,CACD,IAAME,EAAajZ,EAAI9F,QAAQ,KACzBgf,EAAYlZ,EAAI9F,QAAQ,KACxBzM,EAAQ3J,KAAK0C,IACfyyB,GAAc,EAAIA,EAAajZ,EAAInf,OACnCq4B,GAAa,EAAIA,EAAYlZ,EAAInf,QAIrCi4B,GADA9Y,EAAMA,EAAIgZ,UAAU,EAAGvrB,IACburB,UAAUhZ,EAAIrJ,YAAY,KAAO,GAG/C,OAAOmiB,EAAIrO,gB,8ECvBf,YAAU,EAAA0O,cAAA,EAAAA,cACV,YAAU,EAAAC,iBAAA,EAAAA,iBAGV,MACI,aADS,EAAA1U,a,8ZCHb,IAQA,cAII,WAAY5C,EAAmBC,G,OAC3B,YAAMD,EAAWC,IAAO,KAsDhC,OA3DmC,OAQxB,YAAAE,OAAP,SAAc9hB,GACF,IAAA4hB,EAAA,KAAAA,OACRviB,KAAK65B,WAAa,IAAIh5B,GAAGsD,IAAI21B,WAAWvX,GACxC,IAAMsX,EAAa75B,KAAK65B,WAWxB,OAVAA,EAAWE,KAAsB,IAAdp5B,EAAKo5B,K,QAGxBF,EAAW/2B,MAAQyf,EAAOzf,MAC1B+2B,EAAW92B,OAASwf,EAAOxf,OAC3Bwf,EAAOhM,SAASsjB,GAEhBA,EAAWnyB,GAAG7G,GAAGsD,IAAI61B,YAAYC,eAAeC,SAAUl6B,KAAK8vB,WAAY9vB,MAE3EuiB,EAAOvO,OAAO5D,YAAY1I,GAAG,UAAmB1H,KAAKm6B,UAAWn6B,MACxDA,MAGL,YAAA6iB,UAAP,W,UACI7iB,KAAKuiB,OAAOvO,OAAO5D,YAAYpI,IAAI,UAAmBhI,KAAKm6B,UAAWn6B,MACvD,QAAf,EAAAA,KAAK65B,kBAAU,SAAE7xB,IAAInH,GAAGsD,IAAI61B,YAAYC,eAAeC,SAAUl6B,KAAK8vB,WAAY9vB,MACnE,QAAf,EAAAA,KAAK65B,kBAAU,SAAEO,SACF,QAAf,EAAAp6B,KAAK65B,kBAAU,SAAEjX,WAGb,YAAAkN,WAAR,SAAmBX,EAA4BxuB,GAC3CX,KAAKuiB,OAAOvO,OAAO5D,YAAY/P,KAAK,UAChC,CACIK,KAAM,aACNsP,KAAM,aACNE,MAAK,UACLvP,KAAM,CAAC3C,KAAM,YAAaq8B,IAAK15B,MAInC,YAAAw5B,UAAR,SAAkBxmB,GACd,GAAIA,EAAIhT,MAAqB,eAAbgT,EAAI3D,MAA0BhQ,KAAK65B,WAAY,CAC3D,IAAMA,EAAa75B,KAAK65B,WACF,cAAlBlmB,EAAIhT,KAAK3C,KACT67B,EAAWS,QAAQ3mB,EAAIhT,KAAK05B,KACH,iBAAlB1mB,EAAIhT,KAAK3C,KAChB67B,EAAWplB,QACc,eAAlBd,EAAIhT,KAAK3C,KAChB67B,EAAWU,UAAY5mB,EAAIhT,KAAK05B,IACP,mBAAlB1mB,EAAIhT,KAAK3C,OAChB67B,EAAWW,UAAY7mB,EAAIhT,KAAK05B,OAOhD,EA3DA,CARA,MAQmCtX,MAAtB,EAAA4W,iB,8ZCPb,IAMA,cAKI,WAAYrX,EAAmBC,G,OAC3B,YAAMD,EAAWC,IAAO,KAkEhC,OAxEsC,OASxB,YAAAE,OAAV,SAAiB9hB,G,YAET85B,EAAUtZ,SAASuZ,eAAe,cACtC,GAAc,MAAXD,EAAgB,CACf,IAAME,EAAkBxZ,SAASyZ,uBAAuB,oBAAoB,GACxED,GAAmBA,EAAgBtlB,SAAS,KAC5ColB,EAAUE,EAAgBtlB,SAAS,IAG3C,GAAe,MAAXolB,EAAJ,CAKAz6B,KAAK66B,IAAMJ,EACH,IAAAlY,EAAA,KAAAA,OAIFuY,EAAmBx9B,OAAOw9B,kBAAqBx9B,OAAey9B,wBAA2Bz9B,OAAe09B,oBAC9Gh7B,KAAKi7B,SAAW,IAAIH,GAAiB,SAACI,GAClCA,EAAUzX,SAAQ,SAAC0X,G,MACf,GAAsB,eAAlBA,EAASz6B,KAAuB,CAEhC,IAAM06B,EAAOD,EAASh0B,OAChBk0B,EAA8B,QAAb,EAAG9Y,EAAO/f,WAAG,eAAEW,SAASm4B,QAAQC,YAAYF,kBACnE,GAAID,EAAKI,QAAQC,SAAWL,EAAKjlB,MAAMslB,OAAQ,CAC3C,GAA0B,YAAtBJ,EAGA,OAFAD,EAAKjlB,MAAMslB,OAAS,eACpBL,EAAKI,QAAQC,OAASL,EAAKjlB,MAAMslB,QAGrCL,EAAKI,QAAQC,OAASL,EAAKjlB,MAAMslB,eAKjDz7B,KAAKi7B,SAASS,QAAQjB,EAAS,CAC3BkB,YAAY,EACZC,gBAAiB,CAAC,WAItB,IAAMC,EAAgBpB,EAAQtkB,MAAMslB,OAWpC,OAVU,QAAV,EAAAlZ,EAAO/f,WAAG,SAAEW,SAASm4B,QAAQC,YAAYO,iBAAiBrB,EAAmB,QAAZ,EAAElY,EAAO/f,WAAG,eAAEW,SAASsD,aACtB,QAAhD,EAAkB,QAAlB,EAAQ8b,EAAO/f,WAAG,eAAEW,SAASm4B,QAAQC,mBAAW,eAAEQ,cACvDplB,QAAUklB,EAEvBpB,EAAQtkB,MAAMgZ,QAAU,OAExB2F,YAAW,WAEJ2F,IAASA,EAAQtkB,MAAMgZ,QAAU,MACrC,IACInvB,KA3CHA,KAAKuiB,OAAOnS,YAAYhE,UAAU,QAAS,CAAC,+BAAgC,YA8C1E,YAAAyW,UAAV,W,MAEiB,QAAb,EAAA7iB,KAAKi7B,gBAAQ,SAAEe,aACfh8B,KAAK66B,IAAM,MAGnB,EAxEA,CANA,MAMsC9X,MAAzB,EAAA6W,oB,8ECSb,mBAAkDqC,EAA2BznB,EAAgBxR,EAAsBk5B,EAAuBC,EAAuBC,QAA9C,IAAAF,MAAA,SAAuB,IAAAC,MAAA,QAAuB,IAAAC,OAAA,GAC7J,IAEIC,EAAc/+B,OAAOg/B,WACrBC,EAAej/B,OAAOk/B,YAO1B,GALyB,MAArBP,EAAOpa,aACPwa,EAAeJ,EAAOpa,WAA2B4a,YACjDF,EAAgBN,EAAOpa,WAA2B6a,cAG7B,KAArBR,EAAyB,CACzB,GAAiD,MAA7C/a,SAASuZ,eAAewB,GACxB,MAAM,IAAI/rB,MAAM,kCAAkC+rB,EAAgB,KAEtEG,EAAelb,SAASuZ,eAAewB,GAAkCO,YACzEF,EAAgBpb,SAASuZ,eAAewB,GAAkCQ,aAG9E,IAAMC,EAAsBN,EACtBO,EAAuBL,EAKvBM,EAwDV,SACI75B,EACA85B,EACAC,EACAC,EACAC,GAEA,IAAIC,EAAeJ,EACfK,EAAgBJ,EAChBK,EAAaJ,EACbK,EAAcJ,EACZ3V,EAAUwV,EAAcM,GAAe,EACvC7V,EAAUwV,EAAeM,GAAgB,EAE/C,OAAQr6B,GACJ,IAAK,UACGskB,EAASC,EACT2V,EAAe54B,KAAKoJ,MAAM0vB,EAAa7V,GAEvC4V,EAAgB74B,KAAKoJ,MAAM2vB,EAAc/V,GAE7C,MACJ,IAAK,QACGA,EAASC,EACT4V,EAAgB74B,KAAKoJ,MAAM2vB,EAAc/V,GAEzC4V,EAAe54B,KAAKoJ,MAAM0vB,EAAa7V,GAE3C,MACJ,IAAK,UACGD,EAASC,EACT6V,EAAa94B,KAAKoJ,MAAMovB,EAAcvV,GAEtC8V,EAAc/4B,KAAKoJ,MAAMqvB,EAAezV,GAE5C,MACJ,QACI8V,EAAaN,EACbO,EAAcN,EAIlBK,EAAa,GAAM,IACnBA,GAAc,GAEdC,EAAc,GAAM,IACpBA,GAAe,GAEfH,EAAe,GAAM,IACrBA,GAAgB,GAEhBC,EAAgB,GAAM,IACtBA,GAAiB,GAErB,MAAO,CACHC,WAAU,EACVC,YAAW,EACXH,aAAY,EACZC,cAAa,GAlHCG,CAAmBt6B,EAHjB25B,EACCC,EAEsDX,EAAOn5B,MAAOm5B,EAAOl5B,QAE1Fq6B,EAAaP,EAAUO,WACvBC,EAAcR,EAAUQ,YACxBH,EAAeL,EAAUK,aACzBC,EAAgBN,EAAUM,cAEhClB,EAAO9lB,MAAMonB,gBAAkB,YAE3BtB,EAAOn5B,QAAUs6B,IACjBnB,EAAOn5B,MAAQs6B,GAEfnB,EAAOl5B,SAAWs6B,IAClBpB,EAAOl5B,OAASs6B,GAIpBpB,EAAO9lB,MAAMqnB,IAzCD,GAyCcZ,EAAuBO,GAAiB,EAAI,KACtElB,EAAO9lB,MAAMsnB,MAAQd,EAAsBO,GAAgB,EAAI,KAE/D,IAAMQ,EAASR,EAAeE,EACxBO,EAASR,EAAgBE,EAE3BO,EAAeF,EAASvB,EACxB0B,EAAeF,EAASxB,EAEvBC,IACDwB,EAAet5B,KAAK+xB,KAAKuH,GACzBC,EAAev5B,KAAK+xB,KAAKwH,IAG7B,IAAMhgC,EAAI,IAAIgD,GAAGyF,OAajB,OAZAzI,EAAEigC,WACFjgC,EAAEkgC,MAAML,EAASE,EAAcD,EAASE,GACxChgC,EAAEmgC,OAlBe,EAkBG15B,KAAKG,GAAK,KAE9Bw3B,EAAO9lB,MAAM8nB,SAAW,WACxBhC,EAAO9lB,MAAM+nB,UAAY,UAAUrgC,EAAET,EAAC,IAAIS,EAAEsgC,EAAC,IAAItgC,EAAEC,EAAC,IAAID,EAAEE,EAAC,IAAIF,EAAEugC,GAAE,IAAIvgC,EAAEwgC,GAAE,IAC3EpC,EAAOn5B,MAAQs6B,EAAaQ,EAC5B3B,EAAOl5B,OAASs6B,EAAcQ,EAE9BrpB,EAAM8S,OAASsW,EACfppB,EAAM+S,OAASsW,EAER,CAAE/6B,MAAOm5B,EAAOn5B,MAAOC,OAAQk5B,EAAOl5B,OAAQukB,OAAQsW,EAAcrW,OAAQsW,K,8ZC3EvF,WAGA,OACA,QAEA,cAoDI,WAAYzqB,GAAZ,MACI,cAAO,K,OA/BH,EAAAkrB,QAAe,GAEf,EAAAC,OAAgB,GA8BpB,EAAKC,WAAaprB,EAAQ3Q,UAC1B,EAAKg8B,IAAMrrB,EAAQhR,IAAM,EAAK2P,iBAC9B,EAAK2sB,KAAOtrB,EAAQgB,UAAO/R,EAC3B,EAAKs8B,WAAyBt8B,IAAjB+Q,EAAQiB,MAA4BuqB,QAAQxrB,EAAQiB,MACjE,EAAKwqB,WAAyBx8B,IAAjB+Q,EAAQqM,MAA6Bmf,QAAQxrB,EAAQqM,MAClE,EAAKqf,WAAyBz8B,IAAjB+Q,EAAQ2rB,MAA4BH,QAAQxrB,EAAQ2rB,MACjE,EAAKC,WAAa5rB,EAAQpQ,gBAAaX,EACvC,EAAK48B,OAAS7rB,EAAQ8rB,OAAS,KAC/B,EAAKC,OAAS/rB,EAAQ4C,OAAS,cAC/B,EAAKopB,SAAWhsB,EAAQ0C,QACxB,EAAKwoB,QAAUlrB,EAAQoW,QAAU,GACjC,EAAK6V,WAAajsB,EAAQksB,WAAa,GACvC,EAAKC,OAASnsB,EAAQtQ,OAAS,IAC/B,EAAK08B,QAAUpsB,EAAQrQ,QAAU,IACjC,EAAK08B,aAAersB,EAAQssB,aAAe,OAC3C,EAAKC,YAAcvsB,EAAQwsB,YAAc,EACzC,EAAKC,cAA+Bx9B,IAApB+Q,EAAQ0sB,SAA+BlB,QAAQxrB,EAAQ0sB,SACvE,EAAKC,cAA+B19B,IAApB+Q,EAAQ4sB,SAA+BpB,QAAQxrB,EAAQ4sB,SACvE,EAAKC,gBAAkB7sB,EAAQmE,eAC/B,EAAK2oB,OAAS9sB,EAAQgK,QAAS,EAC/B,EAAKmhB,OAASnrB,EAAQsP,OAAS,EAAK6b,OACpC,EAAK4B,kBAAoB/sB,EAAQgtB,mBAAoB,EACrD,EAAK1pB,KAAOnT,MAAMC,QAAQ4P,EAAQoW,OAAO9S,MAAQ,CAACC,QAAQvD,EAAQoW,OAAO9S,MAAQtD,EAAQoW,OAAO9S,UACzErU,IAApB,EAAKqU,KAAKyL,QACT,EAAKzL,KAAKyL,MAAQ,EAAKzL,KAAKC,QAAQ/U,eAEjBS,IAApB,EAAKqU,KAAK0L,QACT,EAAK1L,KAAK0L,MAAQ,EAAK1L,KAAKC,QAAQ/U,eAEpBS,IAAjB,EAAKqU,KAAK2pB,KACT,EAAK3pB,KAAK2pB,GAAK,EAAK3pB,KAAKC,QAAQ/U,UAErC,EAAK0+B,UAAYltB,EAAQmtB,UAAY,EAAA1sB,OAAOC,OAAOysB,SACnD,EAAKC,MAAQ,IAAI,UAAK,EAAKF,WAC3B,EAAKl6B,OAAO,eAAgB,EAAKq6B,M,EA4QzC,OApWoC,OA2FhC,sBAAW,wBAAS,C,IAApB,WACI,OAAOzgC,KAAKw+B,Y,IAGhB,SAAqB9/B,GACbsB,KAAKw+B,aAAe9/B,IACxBsB,KAAKw+B,WAAa9/B,EAClBsB,KAAKuS,eAAe,e,gCAGxB,sBAAW,iBAAE,C,IAAb,WACI,OAAOvS,KAAKy+B,K,IAGhB,SAAc//B,GACNsB,KAAKy+B,MAAQ//B,IACjBsB,KAAKy+B,IAAM//B,EACXsB,KAAKuS,eAAe,Q,gCAGxB,sBAAW,kBAAG,C,IAAd,WACI,OAAOvS,KAAK0+B,M,IAGhB,SAAehgC,GACPsB,KAAK0+B,OAAShgC,IAClBsB,KAAK0+B,KAAOhgC,EACZsB,KAAKuS,eAAe,S,gCAGxB,sBAAW,mBAAI,C,IAAf,WACI,OAAOvS,KAAK2+B,O,IAGhB,SAAgBjgC,GACRsB,KAAK2+B,QAAUjgC,IACnBsB,KAAK2+B,MAAQjgC,EACbsB,KAAKuS,eAAe,U,gCAGxB,sBAAW,mBAAI,C,IAAf,WACI,OAAOvS,KAAK6+B,O,IAGhB,SAAgBngC,GACRsB,KAAK6+B,QAAUngC,IACnBsB,KAAK6+B,MAAQngC,EACbsB,KAAKuS,eAAe,U,gCAGxB,sBAAW,mBAAI,C,IAAf,WACI,OAAOvS,KAAK8+B,O,IAGhB,SAAgBpgC,GACRsB,KAAK8+B,QAAUpgC,IACnBsB,KAAK8+B,MAAQpgC,EACbsB,KAAKuS,eAAe,U,gCAGxB,sBAAW,wBAAS,C,IAApB,WACI,OAAOvS,KAAKg/B,Y,IAGhB,SAAqBtgC,GACbsB,KAAKg/B,aAAetgC,IACxBsB,KAAKg/B,WAAatgC,EAClBsB,KAAKuS,eAAe,e,gCAGxB,sBAAW,oBAAK,C,IAAhB,WACI,OAAOvS,KAAKi/B,Q,IAGhB,SAAiBvgC,GACTsB,KAAKi/B,SAAWvgC,IACpBsB,KAAKi/B,OAASvgC,EACdsB,KAAKuS,eAAe,W,gCAGxB,sBAAW,oBAAK,C,IAAhB,WACI,OAAOvS,KAAKm/B,Q,IAGhB,SAAiBzgC,GACTsB,KAAKm/B,SAAWzgC,IACpBsB,KAAKm/B,OAASzgC,EACdsB,KAAKuS,eAAe,W,gCAGxB,sBAAW,sBAAO,C,IAAlB,WACI,OAAOvS,KAAKo/B,U,IAGhB,SAAmB1gC,GACXsB,KAAKo/B,WAAa1gC,IACtBsB,KAAKo/B,SAAW1gC,EAChBsB,KAAKuS,eAAe,a,gCAOxB,sBAAW,qBAAM,C,IAAjB,WACI,OAAOvS,KAAKs+B,S,IAGhB,SAAkB5/B,GAGXsB,KAAKs+B,UAAY5/B,IACpBsB,KAAKs+B,QAAU5/B,EACfsB,KAAKuS,eAAe,Y,gCAGxB,sBAAW,oBAAK,C,IAAhB,WACI,OAAOvS,KAAKu+B,Q,IAEhB,SAAiB7/B,GACbsB,KAAKu+B,OAAS7/B,G,gCAGlB,sBAAW,wBAAS,C,IAApB,WACI,OAAOsB,KAAKq/B,Y,IAGhB,SAAqB3gC,GACbsB,KAAKq/B,aAAe3gC,IACxBsB,KAAKq/B,WAAa3gC,EAClBsB,KAAKuS,eAAe,e,gCAGxB,sBAAW,oBAAK,C,IAAhB,WACI,OAAOvS,KAAKu/B,Q,IAGhB,SAAiB7gC,GACTsB,KAAKu/B,SAAW7gC,IACpBsB,KAAKu/B,OAAS7gC,EACdsB,KAAKuS,eAAe,W,gCAGxB,sBAAW,qBAAM,C,IAAjB,WACI,OAAOvS,KAAKw/B,S,IAGhB,SAAkB9gC,GACVsB,KAAKw/B,UAAY9gC,IACrBsB,KAAKw/B,QAAU9gC,EACfsB,KAAKuS,eAAe,Y,gCAGxB,sBAAW,0BAAW,C,IAAtB,WACI,OAAOvS,KAAKy/B,c,IAGhB,SAAuB/gC,GACfsB,KAAKy/B,eAAiB/gC,IAC1BsB,KAAKy/B,aAAe/gC,EACpBsB,KAAKuS,eAAe,iB,gCAGxB,sBAAW,yBAAU,C,IAArB,WACI,OAAOvS,KAAK2/B,a,IAGhB,SAAsBjhC,GACdsB,KAAK2/B,cAAgBjhC,IACzBsB,KAAK2/B,YAAcjhC,EACnBsB,KAAKuS,eAAe,gB,gCAGxB,sBAAW,sBAAO,C,IAAlB,WACI,OAAOvS,KAAK6/B,U,IAGhB,SAAmBnhC,GACXsB,KAAK6/B,WAAanhC,IACtBsB,KAAK6/B,SAAWnhC,EAChBsB,KAAKuS,eAAe,a,gCAGxB,sBAAW,sBAAO,C,IAAlB,WACI,OAAOvS,KAAK+/B,U,IAGhB,SAAmBrhC,GACXsB,KAAK+/B,WAAarhC,IACtBsB,KAAK+/B,SAAWrhC,EAChBsB,KAAKuS,eAAe,a,gCAGxB,sBAAW,6BAAc,C,IAMzB,WACI,OAAOvS,KAAKigC,iB,IAPhB,SAA0BvhC,GAClBsB,KAAKigC,kBAAoBvhC,IAC7BsB,KAAKigC,gBAAkBvhC,EACvBsB,KAAKuS,eAAe,oB,gCAOxB,sBAAW,oBAAK,C,IAMhB,WACI,OAAOvS,KAAKkgC,Q,IAPhB,SAAiBxhC,GACTsB,KAAKkgC,SAAWxhC,IACpBsB,KAAKkgC,OAASxhC,EACdsB,KAAKuS,eAAe,W,gCAOxB,sBAAW,+BAAgB,C,IAM3B,WACI,OAAOvS,KAAKmgC,mB,IAPhB,SAA4BzhC,GACpBsB,KAAKmgC,oBAAsBzhC,IAC/BsB,KAAKmgC,kBAAoBzhC,EACzBsB,KAAKuS,eAAe,sB,gCAOxB,sBAAW,uBAAQ,C,IAAnB,WACI,OAAOvS,KAAKsgC,W,IAGhB,SAAoB5hC,GACZsB,KAAKsgC,YAAc5hC,IACvBsB,KAAKsgC,UAAY5hC,EACjBsB,KAAKuS,eAAe,c,gCAGxB,sBAAW,mBAAI,C,IAAf,WACI,OAAOvS,KAAKwgC,O,gCAGhB,sBAAW,mBAAI,C,IAAf,WACI,MAAO,CACH/9B,UAAWzC,KAAKyC,UAChBL,GAAIpC,KAAKoC,GACTgS,IAAKpU,KAAKoU,IACVC,KAAMrU,KAAKqU,KACXoL,KAAMzf,KAAKyf,KACXsf,KAAM/+B,KAAK++B,KACX/7B,UAAWhD,KAAKgD,UAChBk8B,MAAOl/B,KAAKk/B,MACZlpB,MAAOhW,KAAKgW,MACZF,QAAS9V,KAAK8V,QACd0T,OAAQxpB,KAAKwpB,OACb9G,MAAO1iB,KAAK0iB,MACZ4c,UAAWt/B,KAAKs/B,UAChBx8B,MAAO9C,KAAK8C,MACZC,OAAQ/C,KAAK+C,OACb28B,YAAa1/B,KAAK0/B,YAClBE,WAAY5/B,KAAK4/B,WACjBE,QAAS9/B,KAAK8/B,QACdE,QAAShgC,KAAKggC,QACdI,iBAAkBpgC,KAAKogC,iBACvB7oB,eAAgBvX,KAAKuX,eACrB6F,MAAOpd,KAAKod,MACZmjB,SAAUvgC,KAAKugC,SACf/pB,KAAMxW,KAAKwW,KAAKiqB,O,gCAG5B,EApWA,CAAoC,W,2aCjBpC,IAOA,cAII,mBACI,cAAO,K,OACP,EAAKC,WAAa,G,EAuC1B,OA7CwC,OAS7B,YAAArgC,KAAP,SAAYK,EAAc+Q,GACtB,QAAapP,IAAT3B,EACA,MAAM,IAAIyP,MAAM,iBAAiBzP,EAAI,iBAEzC,QAAmB2B,IAAfoP,EAAMzB,KACN,MAAM,IAAIG,MAAM,iBAAiBzP,EAAI,2BAEzC,QAAoB2B,IAAhBoP,EAAMvB,MACN,MAAM,IAAIC,MAAM,iBAAiBzP,EAAI,4BAGzC,OADe,YAAML,KAAI,UAACK,EAAM+Q,IAU7B,YAAAmZ,QAAP,SAAenZ,EAAgBiE,EAAYirB,GACvC3gC,KAAKK,KAAKoR,EAAO,CAAEzB,KAAMyB,EAAOvB,MAAO,UAAoBvP,KAAM+U,EAAOvO,OAAQw5B,KAQ7E,YAAAv0B,UAAP,SAAiBw0B,EAAmBjgC,EAAcuP,EAA2B/I,QAA3B,IAAA+I,MAAA,SAC9ClQ,KAAKsjB,MAAM,CAACtT,KAAM4wB,EAAW1wB,MAAK,EAAEvP,KAAI,EAAE+T,QAASksB,EAAWz5B,OAAM,KAGjE,YAAAmc,MAAP,SAAa3P,GACT3T,KAAKK,KAAK,SAAkBsT,IAEpC,EA7CA,CAPA,MAOwC5S,c,0CCLxC,IAAI8/B,EAAM1iC,OAAOkB,UAAUC,eACvBwhC,EAAS,IASb,SAASC,KA4BT,SAASC,EAAGtvB,EAAIC,EAASG,GACvB9R,KAAK0R,GAAKA,EACV1R,KAAK2R,QAAUA,EACf3R,KAAK8R,KAAOA,IAAQ,EActB,SAASF,EAAYqvB,EAASxvB,EAAOC,EAAIC,EAASG,GAChD,GAAkB,mBAAPJ,EACT,MAAM,IAAIwvB,UAAU,mCAGtB,IAAI1d,EAAW,IAAIwd,EAAGtvB,EAAIC,GAAWsvB,EAASnvB,GAC1C2F,EAAMqpB,EAASA,EAASrvB,EAAQA,EAMpC,OAJKwvB,EAAQE,QAAQ1pB,GACXwpB,EAAQE,QAAQ1pB,GAAK/F,GAC1BuvB,EAAQE,QAAQ1pB,GAAO,CAACwpB,EAAQE,QAAQ1pB,GAAM+L,GADhByd,EAAQE,QAAQ1pB,GAAK3L,KAAK0X,IADlCyd,EAAQE,QAAQ1pB,GAAO+L,EAAUyd,EAAQG,gBAI7DH,EAUT,SAAS1mB,EAAW0mB,EAASxpB,GACI,KAAzBwpB,EAAQG,aAAoBH,EAAQE,QAAU,IAAIJ,SAC5CE,EAAQE,QAAQ1pB,GAU9B,SAAS1W,IACPf,KAAKmhC,QAAU,IAAIJ,EACnB/gC,KAAKohC,aAAe,EAxElBjjC,OAAOY,SACTgiC,EAAO1hC,UAAYlB,OAAOY,OAAO,OAM5B,IAAIgiC,GAASM,YAAWP,GAAS,IA2ExC//B,EAAa1B,UAAUiiC,WAAa,WAClC,IACIxI,EACA96B,EAFAujC,EAAQ,GAIZ,GAA0B,IAAtBvhC,KAAKohC,aAAoB,OAAOG,EAEpC,IAAKvjC,KAAS86B,EAAS94B,KAAKmhC,QACtBN,EAAIjjC,KAAKk7B,EAAQ96B,IAAOujC,EAAMz1B,KAAKg1B,EAAS9iC,EAAKwjC,MAAM,GAAKxjC,GAGlE,OAAIG,OAAOsjC,sBACFF,EAAM3/B,OAAOzD,OAAOsjC,sBAAsB3I,IAG5CyI,GAUTxgC,EAAa1B,UAAUqiC,UAAY,SAAmBjwB,GACpD,IAAIgG,EAAMqpB,EAASA,EAASrvB,EAAQA,EAChCkwB,EAAW3hC,KAAKmhC,QAAQ1pB,GAE5B,IAAKkqB,EAAU,MAAO,GACtB,GAAIA,EAASjwB,GAAI,MAAO,CAACiwB,EAASjwB,IAElC,IAAK,IAAIrU,EAAI,EAAGK,EAAIikC,EAAStgC,OAAQugC,EAAK,IAAIr+B,MAAM7F,GAAIL,EAAIK,EAAGL,IAC7DukC,EAAGvkC,GAAKskC,EAAStkC,GAAGqU,GAGtB,OAAOkwB,GAUT7gC,EAAa1B,UAAUwiC,cAAgB,SAAuBpwB,GAC5D,IAAIgG,EAAMqpB,EAASA,EAASrvB,EAAQA,EAChCiwB,EAAY1hC,KAAKmhC,QAAQ1pB,GAE7B,OAAKiqB,EACDA,EAAUhwB,GAAW,EAClBgwB,EAAUrgC,OAFM,GAYzBN,EAAa1B,UAAUgB,KAAO,SAAcoR,EAAOqwB,EAAIC,EAAIC,EAAIC,EAAIC,GACjE,IAAIzqB,EAAMqpB,EAASA,EAASrvB,EAAQA,EAEpC,IAAKzR,KAAKmhC,QAAQ1pB,GAAM,OAAO,EAE/B,IAEIhS,EACApI,EAHAqkC,EAAY1hC,KAAKmhC,QAAQ1pB,GACzBvV,EAAMigC,UAAU9gC,OAIpB,GAAIqgC,EAAUhwB,GAAI,CAGhB,OAFIgwB,EAAU5vB,MAAM9R,KAAK6R,eAAeJ,EAAOiwB,EAAUhwB,QAAIrP,GAAW,GAEhEH,GACN,KAAK,EAAG,OAAOw/B,EAAUhwB,GAAG9T,KAAK8jC,EAAU/vB,UAAU,EACrD,KAAK,EAAG,OAAO+vB,EAAUhwB,GAAG9T,KAAK8jC,EAAU/vB,QAASmwB,IAAK,EACzD,KAAK,EAAG,OAAOJ,EAAUhwB,GAAG9T,KAAK8jC,EAAU/vB,QAASmwB,EAAIC,IAAK,EAC7D,KAAK,EAAG,OAAOL,EAAUhwB,GAAG9T,KAAK8jC,EAAU/vB,QAASmwB,EAAIC,EAAIC,IAAK,EACjE,KAAK,EAAG,OAAON,EAAUhwB,GAAG9T,KAAK8jC,EAAU/vB,QAASmwB,EAAIC,EAAIC,EAAIC,IAAK,EACrE,KAAK,EAAG,OAAOP,EAAUhwB,GAAG9T,KAAK8jC,EAAU/vB,QAASmwB,EAAIC,EAAIC,EAAIC,EAAIC,IAAK,EAG3E,IAAK7kC,EAAI,EAAGoI,EAAO,IAAIlC,MAAMrB,EAAK,GAAI7E,EAAI6E,EAAK7E,IAC7CoI,EAAKpI,EAAI,GAAK8kC,UAAU9kC,GAG1BqkC,EAAUhwB,GAAGzL,MAAMy7B,EAAU/vB,QAASlM,OACjC,CACL,IACIwW,EADA5a,EAASqgC,EAAUrgC,OAGvB,IAAKhE,EAAI,EAAGA,EAAIgE,EAAQhE,IAGtB,OAFIqkC,EAAUrkC,GAAGyU,MAAM9R,KAAK6R,eAAeJ,EAAOiwB,EAAUrkC,GAAGqU,QAAIrP,GAAW,GAEtEH,GACN,KAAK,EAAGw/B,EAAUrkC,GAAGqU,GAAG9T,KAAK8jC,EAAUrkC,GAAGsU,SAAU,MACpD,KAAK,EAAG+vB,EAAUrkC,GAAGqU,GAAG9T,KAAK8jC,EAAUrkC,GAAGsU,QAASmwB,GAAK,MACxD,KAAK,EAAGJ,EAAUrkC,GAAGqU,GAAG9T,KAAK8jC,EAAUrkC,GAAGsU,QAASmwB,EAAIC,GAAK,MAC5D,KAAK,EAAGL,EAAUrkC,GAAGqU,GAAG9T,KAAK8jC,EAAUrkC,GAAGsU,QAASmwB,EAAIC,EAAIC,GAAK,MAChE,QACE,IAAKv8B,EAAM,IAAKwW,EAAI,EAAGxW,EAAO,IAAIlC,MAAMrB,EAAK,GAAI+Z,EAAI/Z,EAAK+Z,IACxDxW,EAAKwW,EAAI,GAAKkmB,UAAUlmB,GAG1BylB,EAAUrkC,GAAGqU,GAAGzL,MAAMy7B,EAAUrkC,GAAGsU,QAASlM,IAKpD,OAAO,GAYT1E,EAAa1B,UAAUqI,GAAK,SAAY+J,EAAOC,EAAIC,GACjD,OAAOC,EAAY5R,KAAMyR,EAAOC,EAAIC,GAAS,IAY/C5Q,EAAa1B,UAAUyS,KAAO,SAAcL,EAAOC,EAAIC,GACrD,OAAOC,EAAY5R,KAAMyR,EAAOC,EAAIC,GAAS,IAa/C5Q,EAAa1B,UAAUwS,eAAiB,SAAwBJ,EAAOC,EAAIC,EAASG,GAClF,IAAI2F,EAAMqpB,EAASA,EAASrvB,EAAQA,EAEpC,IAAKzR,KAAKmhC,QAAQ1pB,GAAM,OAAOzX,KAC/B,IAAK0R,EAEH,OADA6I,EAAWva,KAAMyX,GACVzX,KAGT,IAAI0hC,EAAY1hC,KAAKmhC,QAAQ1pB,GAE7B,GAAIiqB,EAAUhwB,GAEVgwB,EAAUhwB,KAAOA,GACfI,IAAQ4vB,EAAU5vB,MAClBH,GAAW+vB,EAAU/vB,UAAYA,GAEnC4I,EAAWva,KAAMyX,OAEd,CACL,IAAK,IAAIpa,EAAI,EAAGy7B,EAAS,GAAIz3B,EAASqgC,EAAUrgC,OAAQhE,EAAIgE,EAAQhE,KAEhEqkC,EAAUrkC,GAAGqU,KAAOA,GACnBI,IAAS4vB,EAAUrkC,GAAGyU,MACtBH,GAAW+vB,EAAUrkC,GAAGsU,UAAYA,IAErCmnB,EAAOhtB,KAAK41B,EAAUrkC,IAOtBy7B,EAAOz3B,OAAQrB,KAAKmhC,QAAQ1pB,GAAyB,IAAlBqhB,EAAOz3B,OAAey3B,EAAO,GAAKA,EACpEve,EAAWva,KAAMyX,GAGxB,OAAOzX,MAUTe,EAAa1B,UAAU8V,mBAAqB,SAA4B1D,GACtE,IAAIgG,EAUJ,OARIhG,GACFgG,EAAMqpB,EAASA,EAASrvB,EAAQA,EAC5BzR,KAAKmhC,QAAQ1pB,IAAM8C,EAAWva,KAAMyX,KAExCzX,KAAKmhC,QAAU,IAAIJ,EACnB/gC,KAAKohC,aAAe,GAGfphC,MAMTe,EAAa1B,UAAU2I,IAAMjH,EAAa1B,UAAUwS,eACpD9Q,EAAa1B,UAAUuS,YAAc7Q,EAAa1B,UAAUqI,GAK5D3G,EAAaqhC,SAAWtB,EAKxB//B,EAAaA,aAAeA,EAM1B9D,EAAOD,QAAU+D,G,yxDCtUnB,WACA,QAGA,OACA,cAOI,WAAYw/B,GAAZ,MACI,cAAO,K,OAPM,EAAA8B,KAAe,GAIxB,EAAAluB,YAAW,OAIf,EAAKkuB,KAAO9B,EAAS+B,qBACY,IAA7B,EAAKD,KAAK3nB,QAAQ,MAClB,EAAK2nB,KAAO,QAGZ,EAAKA,KAAO,Q,EA+CxB,OA7DkC,OAkB9B,sBAAW,yBAAU,C,IAArB,WACI,OAAOriC,KAAKmU,a,IAEhB,SAAsBzV,GAClBsB,KAAKmU,YAAczV,G,gCAGvB,sBAAW,mBAAI,C,IAAf,WACI,MAAO,CAAC,QAAS,U,gCAGd,YAAAC,EAAP,SAASK,EAAa4R,GAClB,IAAMjQ,EAAOX,KAAK0V,MAElB,OAAI/U,GAAQA,EAAK3B,GACN,EAAAujC,aAAa5hC,EAAK3B,GAAK0V,QAAQrP,WAAYuL,GAG/C,qBAAqB5R,EAAG,+BAA+ByQ,KAAKC,UAAUkB,IAGpE,YAAA6F,KAAb,SAAkBC,EAAgBrD,G,yGAC1BrT,KAAKqiC,MAA6B,UAArBriC,KAAKmU,aACdqM,EAAM,GAGNA,EAAM,kBAAkBxgB,KAAKqiC,KAAI,YAKrC,EAAAriC,KAAa,GAAM,EAAAwiC,gBAAgBhiB,EAAK9J,EAAM,CAAEE,aAAc,SAAUC,OAAM,SAACnY,GAC3E2U,EAAQ3U,QAVZ,M,OAYA,GAHA,EAAKgX,MAAQ,SAGT1V,KAAK0V,MAGL,OAFA1V,KAAKmU,YAAc,QAEZ,CAAP,GAAO,G,iBAIf,MAAO,CAAP,GAAO,WAEf,EA7DA,CAAkC,W,2aCRlC,IACA,cAoBI,WAAYsuB,GAAZ,MACI,cAAO,KACP,GApBI,EAAAC,SAAmB,GAEnB,EAAAC,cAAwB,GAExB,EAAArC,UAAoB,GAEpB,EAAAsC,YAAsB,GAEtB,EAAAC,IAAc,GAEd,EAAAC,QAAe,GAEf,EAAAC,IAAW,GAEX,EAAAC,SAAgB,GAMhBP,IAASQ,EAET,MAAM,IAAIC,YAAY,kB,OAE1B,EAAKC,a,EAiSb,OA3ToC,OA6BlB,EAAApvB,YAAd,WAKI,OAHKqvB,EAAOC,WACRD,EAAOC,SAAW,IAAID,EAAOH,IAE1BG,EAAOC,UAOlB,sBAAW,iBAAE,C,IAAb,WACI,OAAOrjC,KAAK6iC,K,gCAOhB,sBAAW,qBAAM,C,IAAjB,WACI,OAAO7iC,KAAK8iC,S,gCAOhB,sBAAW,iBAAE,C,IAAb,WACI,OAAO9iC,KAAK+iC,K,gCAOhB,sBAAW,sBAAO,C,IAAlB,WACI,OAAO/iC,KAAKgjC,U,gCAOhB,sBAAW,sBAAO,C,IAAlB,WAEI,OAAOhjC,KAAK0iC,U,IAGhB,SAAmBhkC,GAEXA,GAASsB,KAAK0iC,UAAYhkC,IAE1BsB,KAAK0iC,SAAWY,mBAAmB5kC,GAEnCsB,KAAKuS,eAAe,a,gCAQ5B,sBAAW,2BAAY,C,IAAvB,WAEI,OAAOvS,KAAK2iC,e,IAGhB,SAAwBjkC,GAEhBA,GAASsB,KAAK2iC,eAAiBjkC,IAE/BsB,KAAK2iC,cAAgBW,mBAAmB5kC,GAExCsB,KAAKuS,eAAe,kB,gCAQ5B,sBAAW,yBAAU,C,IAArB,WAEI,OAAOvS,KAAK4iC,a,gCAOhB,sBAAW,uBAAQ,C,IAAnB,WACI,OAAO5iC,KAAKsgC,W,gCAGhB,sBAAW,mBAAI,C,IAAf,WACI,MAAO,CACHiD,QAASvjC,KAAKujC,QACdC,aAAcxjC,KAAKwjC,aACnBjD,SAAUvgC,KAAKugC,SACf95B,WAAYzG,KAAKyG,WACjBqkB,GAAI9qB,KAAK8qB,GACT2Y,OAAQzjC,KAAKyjC,OACbC,GAAI1jC,KAAK0jC,GACTC,QAAS3jC,KAAK2jC,U,gCAQd,YAAAR,WAAR,WACOS,SACC5jC,KAAK4iC,YAAcgB,OAAO9gC,MAAQ,IAAM8gC,OAAO7gC,QAEhDgoB,YACC/qB,KAAK6iC,IAAM9X,UAAUC,UACrBhrB,KAAKsgC,UAAYvV,UAAUwV,UAE5BvgC,KAAK6iC,MACJ7iC,KAAK6jC,cACL7jC,KAAK8jC,gBAET9jC,KAAKujC,QAAUpiB,SAAS4iB,SAASC,KACjChkC,KAAKwjC,aAAeriB,SAAS8iB,SAE7BjkC,KAAKoG,OAAO,sBAAuBpG,KAAKygC,OAGpC,YAAAoD,YAAR,WAII,IAAIK,EA8BJ,GAjCAlkC,KAAK+iC,IAAI/kC,KAAO+sB,UAAUoZ,SACtBnkC,KAAK6iC,IAAIqB,MAAM,UAASlkC,KAAK+iC,IAAI/kC,KAAO,QACxCgC,KAAK6iC,IAAIqB,MAAM,WAAUlkC,KAAK+iC,IAAI/kC,KAAO,SAGzCgC,KAAK6iC,IAAIqB,MAAM,yBAA2BlkC,KAAK6iC,IAAIqB,MAAM,UAAYlkC,KAAK6iC,IAAIqB,MAAM,UAAYlkC,KAAK6iC,IAAIqB,MAAM,0BAC/GlkC,KAAK+iC,IAAI/kC,KAAO,OACZkmC,EAAQ,wBAAwBhxB,KAAKlT,KAAK6iC,QAC1C7iC,KAAK+iC,IAAIhsB,QAAUmtB,EAAM,GAAGx+B,QAAQ,KAAM,MAE1C1F,KAAK6iC,IAAIqB,MAAM,sBACflkC,KAAK8iC,QAAQ9kC,KAAO,SACpBgC,KAAK8iC,QAAQpiC,KAAO,YACbV,KAAK6iC,IAAIqB,MAAM,UACtBlkC,KAAK8iC,QAAQ9kC,KAAO,aACpBgC,KAAK8iC,QAAQpiC,KAAO,SACbV,KAAK6iC,IAAIqB,MAAM,YAAclkC,KAAK6iC,IAAIqB,MAAM,0BACnDlkC,KAAK8iC,QAAQ9kC,KAAO,SACpBgC,KAAK8iC,QAAQpiC,KAAO,WAEpBV,KAAK8iC,QAAQ9kC,KAAO,OACpBgC,KAAK8iC,QAAQpiC,KAAO,WAGnBV,KAAK6iC,IAAIqB,MAAM,cACpBlkC,KAAK+iC,IAAI/kC,KAAO,YACZkmC,EAAQ,yBAAyBhxB,KAAKlT,KAAK6iC,QAC3C7iC,KAAK+iC,IAAIhsB,QAAUmtB,EAAM,GAAGx+B,QAAQ,KAAM,MAE9C1F,KAAK8iC,QAAQ9kC,KAAO,iBACpBgC,KAAK8iC,QAAQpiC,KAAO,MAGpBV,KAAK6iC,IAAIqB,MAAM,WAAY,CAE3B,GADAlkC,KAAK+iC,IAAI/kC,KAAO,UACZkmC,EAAQ,4BAA4BhxB,KAAKlT,KAAK6iC,KAE9C,OADA7iC,KAAK+iC,IAAIhsB,QAAUmtB,EAAM,GACjBA,EAAM,IACV,IAAK,MACDlkC,KAAK+iC,IAAIhsB,QAAU,IACnB,MACJ,IAAK,MACD/W,KAAK+iC,IAAIhsB,QAAU,IACnB,MACJ,IAAK,MACD/W,KAAK+iC,IAAIhsB,QAAU,QACnB,MACJ,IAAK,MACD/W,KAAK+iC,IAAIhsB,QAAU,cACnB,MACJ,IAAK,MACD/W,KAAK+iC,IAAIhsB,QAAU,KACnB,MACJ,IAAK,MACD/W,KAAK+iC,IAAIhsB,QAAU,OACnB,MACJ,QACI/W,KAAK+iC,IAAIhsB,QAAU,MAAQ/W,KAAK+iC,IAAIhsB,QAGhD/W,KAAK8iC,QAAQ9kC,KAAO,mBACpBgC,KAAK8iC,QAAQpiC,KAAO,MAChBV,KAAK6iC,IAAIqB,MAAM,kBAAoBlkC,KAAK6iC,IAAIqB,MAAM,oBAClDlkC,KAAK8iC,QAAQ9kC,KAAO,gBACpBgC,KAAK8iC,QAAQpiC,KAAO,SACpBV,KAAK+iC,IAAI/kC,KAAO,iBAChBgC,KAAK+iC,IAAIhsB,QAAU,KAKvB/W,KAAK6iC,IAAIqB,MAAM,aACflkC,KAAK+iC,IAAI/kC,KAAO,WACZkmC,EAAQ,6DAA6DhxB,KAAKlT,KAAK6iC,IAAIn9B,QAAQ,UAAW,SACtG1F,KAAK+iC,IAAIhsB,QAAUmtB,EAAM,IAE7BlkC,KAAK8iC,QAAQ9kC,KAAO,iBACpBgC,KAAK8iC,QAAQpiC,KAAO,SAChBV,KAAK+iC,IAAIhsB,SAAW,IAAG/W,KAAK8iC,QAAQpiC,KAAO,UAC3CV,KAAK+iC,IAAIhsB,SAAW,GAAK/W,KAAK6iC,IAAIqB,MAAM,YAAWlkC,KAAK8iC,QAAQpiC,KAAO,YAM3E,YAAAojC,aAAR,WACI,IAAII,EA0DJ,IAzDIA,EAAQ,qBAAqBhxB,KAAKlT,KAAK6iC,QACvC7iC,KAAKgjC,SAAShlC,KAAO,SACrBgC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,KAG9BA,EAAQ,iCAAiChxB,KAAKlT,KAAK6iC,QACnD7iC,KAAKgjC,SAAShlC,KAAO,SACrBgC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,IAE9BlkC,KAAK6iC,IAAIqB,MAAM,YACflkC,KAAKgjC,SAAShlC,KAAO,UACjBkmC,EAAQ,sBAAsBhxB,KAAKlT,KAAK6iC,QACxC7iC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,KAGlClkC,KAAK6iC,IAAIqB,MAAM,UACflkC,KAAKgjC,SAAShlC,KAAO,qBACjBkmC,EAAQ,iBAAiBhxB,KAAKlT,KAAK6iC,QACnC7iC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,KAGlClkC,KAAK6iC,IAAIqB,MAAM,UACflkC,KAAKgjC,SAAShlC,KAAO,OACrBgC,KAAKgjC,SAASjsB,QAAU,KAExB/W,KAAK6iC,IAAIqB,MAAM,YACflkC,KAAKgjC,SAAShlC,KAAO,SACjBkmC,EAAQ,uBAAuBhxB,KAAKlT,KAAK6iC,QACzC7iC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,KAGlClkC,KAAK6iC,IAAIqB,MAAM,aACflkC,KAAKgjC,SAAShlC,KAAO,WACjBkmC,EAAQ,uBAAuBhxB,KAAKlT,KAAK6iC,QACzC7iC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,MAGlCA,EAAQ,mCAAmChxB,KAAKlT,KAAK6iC,QACrD7iC,KAAKgjC,SAAShlC,KAAO,SACrBgC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,IAE9BlkC,KAAK6iC,IAAIqB,MAAM,cACflkC,KAAKgjC,SAAShlC,KAAO,YACjBkmC,EAAQ,sBAAsBhxB,KAAKlT,KAAK6iC,QACxC7iC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,KAGlClkC,KAAK6iC,IAAIqB,MAAM,WACflkC,KAAKgjC,SAAShlC,KAAO,MACjBkmC,EAAQ,yBAAyBhxB,KAAKlT,KAAK6iC,QAC3C7iC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,MAGlCA,EAAQ,uBAAuBhxB,KAAKlT,KAAK6iC,QACzC7iC,KAAKgjC,SAAShlC,KAAO,KACrBgC,KAAKgjC,SAASjsB,QAAUmtB,EAAM,IAE9BA,EAAQ,2BAA2BhxB,KAAKlT,KAAK6iC,KAAM,CACnD7iC,KAAKgjC,SAAShlC,KAAO,KACrB,IAAI+Y,EAAUmtB,EAAM,GAChBntB,EAAQmtB,MAAM,kBAAiBntB,EAAUA,EAAQ,GAAK,IAAMA,EAAQ,IACxE/W,KAAKgjC,SAASjsB,QAAUA,IAOpC,EA3TA,CADA,KACoC,S,YA4TpC,oB,8ECzTA,iBAII,WAAY/C,GACRhU,KAAKokC,QAAUpwB,EACfhU,KAAKqkC,UAAY,GACjBrkC,KAAKskC,UAAYnjB,SAASC,cAAc,OACxCphB,KAAKskC,UAAUnuB,MAAMouB,WAAa,kBAClCvkC,KAAKskC,UAAUnuB,MAAM8nB,SAAW,WAChCj+B,KAAKskC,UAAUnuB,MAAMrT,MAAQ,OAC7B9C,KAAKskC,UAAUnuB,MAAMpT,OAAS,OAC9B/C,KAAKskC,UAAUnuB,MAAMC,OAAS,OAC9BpW,KAAKskC,UAAUnuB,MAAMgZ,QAAU,OAC/B,IAAIqV,EAAQrjB,SAASC,cAAc,QACnCojB,EAAMruB,MAAMgZ,QAAU,aACtBqV,EAAMruB,MAAMsuB,cAAgB,SAC5BD,EAAMruB,MAAMuuB,UAAY,SACxBF,EAAMruB,MAAMijB,MAAQ,OACpBp5B,KAAKskC,UAAUjuB,YAAYmuB,GAC3BxkC,KAAKokC,QAAQ3hC,UAAU4T,YAAYrW,KAAKskC,WACxCtkC,KAAKokC,QAAQ5tB,KAAK5E,YAAY,QAAiB5R,KAAK2kC,SAAU3kC,MAiCtE,OA9BW,YAAA2X,WAAP,SAAkB3H,EAAcrP,GAE5B,GAAGqP,EAAM,CACLhQ,KAAKqkC,UAAYr0B,EACjBhQ,KAAKskC,UAAUnuB,MAAMgZ,QAAU,QAC/B,IAAIqV,EAAQxkC,KAAKskC,UAAUjvB,SAAS,GACjCmvB,EAAMI,iBACLJ,EAAMvrB,YAAYurB,EAAMK,WAAW,IAEvC,IAAIC,EAAQ3jB,SAAS4jB,eAAe/kC,KAAK4X,QAAQ5H,EAAMrP,IACvD6jC,EAAMnuB,YAAYyuB,KAInB,YAAAltB,QAAP,SAAe5H,EAAcrP,GAEzB,OAAOX,KAAKokC,QAAQ5tB,KAAK7X,EAAEqR,EAAKrP,GAAQ,KAAOqP,GAG5C,YAAAg1B,MAAP,WACIhlC,KAAKqkC,UAAY,GACjBrkC,KAAKskC,UAAUnuB,MAAMgZ,QAAU,QAI3B,YAAAwV,SAAR,SAAiBltB,GACVzX,KAAKqkC,WAA0B,0BAAb5sB,EAAIzH,MACrBhQ,KAAK2X,WAAW3X,KAAKqkC,YAGjC,EAtDA,G","file":"../packages/player/dist/player.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 32);\n","export enum TaskEvent {\n    EVENT_COMPLETE = 'EVENT_COMPLETE',\n    EVENT_FAIL = 'EVENT_FAIL',\n    EVENT_BREAK = 'EVENT_BREAK',\n    FUNCTION_RUN_COMPLETE = 'FUNCTION_RUN_COMPLETE',\n}\nexport class BaseTask extends vf.utils.EventEmitter {\n\n    protected _isRunning: boolean = false;\n    protected _isPaused: boolean = false;\n    protected _isCompleted: boolean = false;\n    protected _isFailed: boolean = false;\n    protected _asynchronous: boolean = false;\n\n    constructor() {\n        super();\n    }\n\n    public run(): void {\n        this._isRunning = true;\n        this._isCompleted = false;\n        this._isFailed = false;\n    }\n\n    public stop(): void {\n        this._isRunning = false;\n    }\n\n    public pause(): void {\n        this._isPaused = true;\n    }\n\n    public resume(): void {\n        this._isPaused = false;\n    }\n    public break() {\n        this._isRunning = false;\n        this.emit(TaskEvent.EVENT_BREAK);\n    }\n\n    public complete(): void {\n        this._isRunning = false;\n        this._isCompleted = true;\n        this.emit(TaskEvent.EVENT_COMPLETE);\n    }\n\n    public fail(type: string, data: any = null): void {\n        this._isRunning = false;\n        this._isFailed = true;\n        this.emit(TaskEvent.EVENT_FAIL, data);\n    }\n\n    public get asynchronous(): boolean {\n        return this._asynchronous;\n    }\n\n    public get isRunning(): boolean {\n        return this._isRunning;\n    }\n\n    public get isCompleted(): boolean {\n        return this._isCompleted;\n    }\n    public get isFailed(): boolean {\n        return this._isFailed;\n    }\n\n    public get isPaused(): boolean {\n        return this._isPaused;\n    }\n}\n\n","import { CurveType, TransitionType, ITransitionData, SceneEvent, ExpressItemType } from '../core/model/IVFData';\nimport { VFComponent } from '../display/VFComponent';\nimport { VFStage } from '../display/VFStage';\nimport { ITransition } from '../core/transition/ITransition';\nimport { CrossFadeFilter } from '../core/transition/filters/CrossFadeFilter';\nimport { CircleFadeFilter } from '../core/transition/filters/CircleFadeFilter';\nimport { CrossZoomFilter } from '../core/transition/filters/CrossZoomFilter';\nimport { DoomScreenFilter } from '../core/transition/filters/DoomScreenFilter';\nimport { HeartWipeFilter } from '../core/transition/filters/HeartWipeFilter';\nimport { LinearBlurFilter } from '../core/transition/filters/LinearBlurFilter';\nimport { PageCurlFilter } from '../core/transition/filters/PageCurlFilter';\nimport { WindFilter } from '../core/transition/filters/WindFilter';\nimport { ToTearFilter } from '../core/transition/filters/ToTearFilter';\nimport { PageFlipLeftFilter } from '../core/transition/filters/PageFlipLeftFilter';\nimport { PageFlipRightFilter } from '../core/transition/filters/PageFlipRightFilter';\nimport { Transition } from '../core/transition/Tranistion';\n\n/**\n * 获取从父级开始的对象\n */\nfunction getParentByTargetComponent(component: VFComponent, targets: string[]) {\n    let com: vf.gui.DisplayObject = component as any;\n    while (targets.length > 0) {\n        const childId = targets.shift();\n        if (com && com instanceof VFComponent && childId) {\n            com = (com as VFComponent).getChildById(childId) as any;\n        } else {\n            return undefined;\n        }\n    }\n    return com;\n}\n\n/**\n * 获取从舞台顶级开始的对象，请标注targets的数组首位为-1\n * @param component \n * @param targets \n */\nfunction getRootByTargetComponent(component: VFComponent, targets: string[]) {\n    targets.shift(); // type\n    if (!component.vfStage) {\n        return;\n    }\n    const curScene = component.vfStage.getCurScene();\n    let curCom: VFComponent | undefined;\n    const rootComID = targets.shift();\n    if (!curScene) {\n        return;\n    }\n    for (let i = 0, len = curScene.uiChildren.length; i < len; i++) {\n        curCom = curScene.uiChildren[i] as any;\n        if (curCom instanceof VFComponent && curCom.id === rootComID) {\n            break;\n        }\n    }\n    if (curCom === undefined) {\n        return undefined;\n    }\n    return getParentByTargetComponent(curCom, targets);\n}\n\n\nexport function getTargetComponent(component: VFComponent,\n                                   targetData: any[] | undefined): vf.gui.DisplayObject | undefined {\n    // 支持从变量，属性，数组，参数中获取 组件\n    if (component && Array.isArray(targetData) && targetData.length > 1) {\n        if (targetData[0] === ExpressItemType.VARIABLE || \n            targetData[0] === ExpressItemType.PROPERTY ||\n            targetData[0] === ExpressItemType.ARRAY_VALUE ||\n            targetData[0] === ExpressItemType.PARAM_VALUE ||\n            targetData[0] === ExpressItemType.OBJECT_VALUE ||\n            targetData[0] === ExpressItemType.COMPONENT) {\n            const vfStage = component.vfStage;\n            if (vfStage && vfStage.variableManager) {\n                const variableManager = vfStage.variableManager;\n                const comp = variableManager.getExpressItemValue(component, targetData);\n                if (comp && comp instanceof vf.gui.DisplayObject) {\n                    return comp;\n                }\n            }\n        }\n    }\n    return getComponentOrChild(component, targetData);\n}\n\nexport function getComponentOrChild(component: VFComponent,\n                                    targetData: string[] | undefined): vf.gui.DisplayObject | undefined {\n    if (!targetData) {\n        return component as any;\n    } else if (targetData.length <= 0) {\n        return component as any;\n    } else {\n        const targets = targetData.concat();\n        if (targets[0] === '-1') {// 从顶级开始\n            return getRootByTargetComponent(component, targets);\n        } else {// 从父级开始\n            return getParentByTargetComponent(component, targets);\n        }\n    }\n}\n\nexport function getCurveProgress(type: CurveType, pos: number): number {\n    let s: number = 0;\n    switch (type) {\n        case CurveType.None:\n            return 0;\n        case CurveType.Linear:\n            return pos;\n        case CurveType.EaseOutQuad:\n            return -(Math.pow((pos - 1), 2) - 1);\n        case CurveType.EaseInQuad:\n            return Math.pow(pos, 2);\n        case CurveType.EaseInOutQuad:\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * Math.pow(pos, 2);\n            }\n            return -0.5 * ((pos -= 2) * pos - 2);\n        case CurveType.EaseInCubic:\n            return Math.pow(pos, 3);\n        case CurveType.EaseOutCubic:\n            return (Math.pow((pos - 1), 3) + 1);\n        case CurveType.EaseInOutCubic:\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * Math.pow(pos, 3);\n            }\n            return 0.5 * (Math.pow((pos - 2), 3) + 2);\n        case CurveType.EaseInQuart:\n            return Math.pow(pos, 3);\n        case CurveType.EaseOutQuart:\n            return -(Math.pow((pos - 1), 4) - 1);\n        case CurveType.EaseInOutQuart:\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * Math.pow(pos, 4);\n            }\n            return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\n        case CurveType.EaseInQuint:\n            return Math.pow(pos, 5);\n        case CurveType.EaseOutQuint:\n            return (Math.pow((pos - 1), 5) + 1);\n        case CurveType.EaseInOutQuint:\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * Math.pow(pos, 5);\n            }\n            return 0.5 * (Math.pow((pos - 2), 5) + 2);\n        case CurveType.EaseInSine:\n            return -Math.cos(pos * (Math.PI / 2)) + 1;\n        case CurveType.EaseOutSine:\n            return Math.sin(pos * (Math.PI / 2));\n        case CurveType.EaseInOutSine:\n            return (-.5 * (Math.cos(Math.PI * pos) - 1));\n        case CurveType.EaseInExpo:\n            return (pos === 0) ? 0 : Math.pow(2, 10 * (pos - 1));\n        case CurveType.EaseOutExpo:\n            return (pos === 1) ? 1 : -Math.pow(2, -10 * pos) + 1;\n        case CurveType.EaseInOutExpo:\n            if (pos === 0) {\n                return 0;\n            }\n            if (pos === 1) {\n                return 1;\n            }\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * Math.pow(2, 10 * (pos - 1));\n            }\n            return 0.5 * (-Math.pow(2, -10 * --pos) + 2);\n        case CurveType.EaseInCirc:\n            return -(Math.sqrt(1 - (pos * pos)) - 1);\n        case CurveType.EaseOutCirc:\n            return Math.sqrt(1 - Math.pow((pos - 1), 2));\n        case CurveType.EaseInOutCirc:\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return -0.5 * (Math.sqrt(1 - pos * pos) - 1);\n            }\n            return 0.5 * (Math.sqrt(1 - (pos -= 2) * pos) + 1);\n        case CurveType.EaseOutBounce:\n            if ((pos) < (1 / 2.75)) {\n                return (7.5625 * pos * pos);\n            } else if (pos < (2 / 2.75)) {\n                return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\n            } else if (pos < (2.5 / 2.75)) {\n                return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\n            } else {\n                return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\n            }\n        case CurveType.EaseInBack:\n            s = 1.70158;\n            return (pos) * pos * ((s + 1) * pos - s);\n        case CurveType.EaseOutBack:\n            s = 1.70158;\n            return (pos = pos - 1) * pos * ((s + 1) * pos + s) + 1;\n        case CurveType.EaseInOutBack:\n            s = 1.70158;\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s));\n            }\n            return 0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\n        case CurveType.Elastic:\n        case CurveType.EaseOutElastic:\n            return -1 * Math.pow(4, -8 * pos) * Math.sin((pos * 6 - 1) * (2 * Math.PI) / 2) + 1;\n        case CurveType.EaseOutElasticTmp:\n            return -1 * Math.pow(6, -6 * pos) * Math.sin((pos * 6 - 1) * (2 * Math.PI) / 2) + 1;\n        case CurveType.SwingFromTo:\n            s = 1.70158;\n            // tslint:disable-next-line: no-conditional-assignment\n            return ((pos /= 0.5) < 1) ? 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s)) :\n                0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\n        case CurveType.SwingFrom:\n            s = 1.70158;\n            return pos * pos * ((s + 1) * pos - s);\n        case CurveType.SwingTo:\n            s = 1.70158;\n            return (pos -= 1) * pos * ((s + 1) * pos + s) + 1;\n        case CurveType.Bounce:\n            if (pos < (1 / 2.75)) {\n                return (7.5625 * pos * pos);\n            } else if (pos < (2 / 2.75)) {\n                return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\n            } else if (pos < (2.5 / 2.75)) {\n                return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\n            } else {\n                return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\n            }\n        case CurveType.BouncePast:\n            if (pos < (1 / 2.75)) {\n                return (7.5625 * pos * pos);\n            } else if (pos < (2 / 2.75)) {\n                return 2 - (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\n            } else if (pos < (2.5 / 2.75)) {\n                return 2 - (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\n            } else {\n                return 2 - (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\n            }\n        case CurveType.EaseFromTo:\n            // tslint:disable-next-line: no-conditional-assignment\n            if ((pos /= 0.5) < 1) {\n                return 0.5 * Math.pow(pos, 4);\n            }\n            return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\n        case CurveType.EaseFrom:\n            return Math.pow(pos, 4);\n        case CurveType.EaseTo:\n            return Math.pow(pos, 0.25);\n        case CurveType.Sinusoidal:\n            return (-Math.cos(pos * Math.PI) / 2) + 0.5;\n        case CurveType.Reverse:\n            return 1 - pos;\n        case CurveType.Wobble:\n            return (-Math.cos(pos * Math.PI * (9 * pos)) / 2) + 0.5;\n        case CurveType.Spring:\n            return 1 - (Math.cos(pos * 4.5 * Math.PI) * Math.exp(-pos * 6));\n        default:\n            return pos;\n    }\n}\n\nexport function applyTransition(vfStage: VFStage, prevTexture: vf.RenderTexture, data: ITransitionData): void {\n    const transition = new Transition(vfStage, prevTexture, data);\n    transition.run();\n}\n\nexport function renderTexture(app: vf.Application,\n    container: vf.Container,\n    width: number,\n    height: number): vf.RenderTexture {\n\n    const w: number = width || app.view.width;\n    const h: number = height || app.view.height;\n\n    const texture = vf.RenderTexture.create({\n        width: w,\n        height: h,\n        scaleMode: vf.SCALE_MODES.LINEAR,\n    });\n    app.renderer.render(container, texture);\n    return texture;\n}\nexport function getCanvasColor(app: vf.Application, container: vf.Container,\n    x: number, y: number): Uint8Array {\n    // const canvas = app.view;\n    // console.log('canvas', canvas)\n    // const ctx = canvas.getContext('2d');\n    // console.log('2d', ctx)\n    // const c = ctx.getImageData(x, y, 1, 1).data;\n    // return c;\n    const texture = vf.RenderTexture.create({\n        width: 1,\n        height: 1,\n        scaleMode: vf.SCALE_MODES.LINEAR,\n    });\n    app.renderer.render(container, texture);\n    const pixels = app.renderer.extract.pixels(texture);\n    return pixels as any;\n\n}\nexport function webglDebug(app: vf.Application, container: vf.Container): void {\n    const c = getCanvasColor(app, container, 0, 0);\n    // tslint:disable-next-line: no-console\n    console.log(' canvas 0,0, color:', 'r:', c[0] / 255, 'g:', c[1], 'b:', c[2], c);\n}\n\nexport function isObject(obj: any): boolean {\n    return Object.prototype.toString.call(obj) === '[object Object]';\n}\nexport function isNumber(obj: any): boolean {\n    return typeof obj === 'number' && !isNaN(obj);\n}\nexport function isString(obj: any): boolean {\n    return typeof obj === 'string';\n}\nexport function isBoolean(obj: any): boolean {\n    return typeof obj === 'boolean';\n}\nexport function isArray(obj: any): boolean {\n    return Array.isArray(obj);\n}\n/**\n *\t 按指定格式替换字符串\n* @param str 原字符串 var str:string=\"a{0}c{1}e\";\n* @param rest 替换参数 stringFormat(str,\"b\",\"d\")\n* @return \n* \n*/\nexport function stringFormat(str: string, ...rest:any[]): string {\n    if (str == null) return '';\n    if(rest === undefined) return str;\n    \n    var len: number = rest.length;\n    var args: string[];\n    if (len == 1 && Array.isArray(rest[0])) {\n        args = rest[0];\n        len = args.length;\n    }\n    else {\n        args = rest;\n    }\n\n    for (var i = 0; i < len; i++) {\n        str = str.replace(new RegExp(\"\\\\${\" + i + \"\\\\}\", \"g\"), args[i]);\n    }\n\n    return str;\n}\n","import { ITransition } from '../ITransition';\n\n\nexport interface AbstractFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n    }\n\nexport class AbstractFilter extends vf.Filter implements ITransition {\n\n        public static readonly vertexSrc: string = `\n            precision highp float;\n            \n            attribute vec2 aVertexPosition;\n            attribute vec2 aTextureCoord;\n            attribute vec4 aColor;\n            \n            uniform mat3 projectionMatrix;\n            uniform mat3 filterMatrix;\n            uniform vec4 inputSize;\n            uniform vec4 outputFrame;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            void main(void){\n                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n                // filterMatrix.xy = ((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw;\n                vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy / resolution;\n                // vFilterCoord = (((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw) * aTextureCoord / resolution;\n                vTextureCoord = aTextureCoord ;\n            }\n        `;\n\n        private static readonly crossFadeUniforms = {\n            filterMatrix: vf.Matrix.TEMP_MATRIX,\n            resolution: vf.settings.RESOLUTION,\n            previousTexture:  null,\n            progress: 0.0,\n        };\n\n        private target?: vf.DisplayObject;\n\n        constructor(vertexSrc?: string, fragmentSrc?: string, uniforms?: any) {\n            super(\n                vertexSrc   || AbstractFilter.vertexSrc,\n                fragmentSrc,\n                uniforms    || AbstractFilter.crossFadeUniforms,\n            );\n        }\n\n        public apply(filterManager: vf.systems.FilterSystem, input: vf.RenderTexture, output: vf.RenderTexture) {\n            const maskMatrix = new vf.Matrix();\n            (filterManager as any).calculateNormalizedScreenSpaceMatrix(maskMatrix);\n            this.uniforms.filterMatrix = maskMatrix;\n            this.uniforms.resolution = vf.settings.RESOLUTION;\n            // super.apply(filterManager, input, output, false); // 这样写ipad下会报错\n            filterManager.applyFilter(this, input, output, undefined);\n        }\n\n        public setPreviousTexture(value: any): void {\n            this.uniforms.previousTexture = value;\n        }\n        \n        public set progress(value: number) {\n            value = Math.min(1, value);\n            value = Math.max(0, value);\n            this.uniforms.progress = value;\n        }\n        public get progress(): number {\n            return this.uniforms.progress;\n        }\n\n        public applyTranisition(target: vf.DisplayObject): void {\n            this.target = target;\n            this.target.filters = [this];\n        }\n        public dispose(): void {\n            if (this.target) {\n                this.target.filters = [];\n            }\n        }\n    }\n\n","import { BaseTask, TaskEvent } from './BaseTask';\nimport { QueueTask } from './QueueTask';\n\nexport class ContainerTask extends BaseTask {\n\n        protected loopTask: QueueTask;\n\n        constructor() {\n            super();\n            this.loopTask = new QueueTask();\n            this.loopTask.on(TaskEvent.EVENT_BREAK, this.onBreak, this);\n        }\n    \n        public addSubTask(task: BaseTask) {\n            if (this.loopTask) {\n                this.loopTask.addTask(task);\n                if (this.loopTask.asynchronous) {\n                    this._asynchronous = true;\n                }\n            }\n        }\n    \n        public stop() {\n            super.stop();\n            if (this.loopTask) {\n                this.loopTask.off(TaskEvent.EVENT_BREAK);\n                this.loopTask.stop();\n            }\n        }\n    \n        public break() {\n            super.break();\n            if (this.loopTask) {\n                this.loopTask.off(TaskEvent.EVENT_BREAK);\n                this.loopTask.break();\n            }\n        }\n\n        public pause(): void {\n            super.pause();\n            if (this.loopTask) {\n                this.loopTask.pause();\n            }\n        }\n\n        public resume(): void {\n            super.resume();\n            if (this.loopTask) {\n                this.loopTask.resume();\n            }\n        }\n\n        protected onBreak(data: any) {\n            this.break();\n        }\n    }\n\n","\n    export class Frame<T> {\n\n        public time: number = -1;\n        public curve?: number[] = [];\n        public value: T  = null as any;\n\n        constructor() {\n            //\n        }\n\n        public getValue(progress: number, value: T): T {\n            return null as any;\n        }\n    }\n\n","import { IVariableData, ExpressItem, ExpressType, ExpressItemType, \n         SystemValueType, VariableType, VariableDataValue } from './model/IVFData';\nimport { FunctionTask } from './actionTask/FunctionTask';\nimport { VFComponent } from '../display/VFComponent';\nimport { getTargetComponent, isObject, isArray, isNumber, isBoolean, isString } from '../utils/VFUtil';\nimport { EventLevel } from '../event/EventLevel';\n\nexport class VariableManager {\n\n        public static GLOBAL_ID: string = 'global';\n\n        public static OPERATE_PRIORITY = {\n            '*' : 100,\n            '/' : 99,\n            '%' : 98,\n            '+' : 97,\n            '-' : 96,\n            '>=' : 95,\n            '<=' : 94,\n            '>' : 93,\n            '<' : 92,\n            '==' : 91,\n            '===' : 91,\n            '!=' : 90,\n            '!==' : 90,\n            '!' : 89,\n            '&&' : 88,\n            '||' : 87,\n            '=' : 86,\n        };\n\n        public variableConfig: {[id: string]: {[vid: string]: IVariableData}} = {};\n        public variableMap: {[id: string]: {[vid: string]: IVariableData}} = {};\n\n        private runFunctionId: number = 0;\n        private functionMap: {[name: string]: FunctionTask} = {};\n\n        constructor() {\n            //\n        }\n\n\n        /**\n         * Fisher-Yates shuffle\n         * @param arr \n         */\n        public shuffle(arr: any[]): void {\n            for (let i = arr.length - 1; i >= 0; i--) {\n                const randomIndex = Math.floor(Math.random() * (i + 1));\n                const itemAtIndex = arr[randomIndex];\n                arr[randomIndex] = arr[i];\n                arr[i] = itemAtIndex;\n            }\n        }\n        public clear(): void {\n            this.variableMap = {};\n            this.functionMap = {};\n        }\n        public getFunctionId(): number {\n            return ++this.runFunctionId;\n        }\n        \n        public getFunctionTask(name: string): FunctionTask {\n            return this.functionMap[name];\n        }\n\n        public setFunctionTask(name: string, task: FunctionTask): void {\n            this.functionMap[name] = task;\n        }\n\n        public addVariableConfig(id: string, variableData: {[id: string]: IVariableData}): void {\n            if (!this.variableConfig[id]) {\n                const normalConfig = this.normalizeVariableConfig(variableData);\n                this.variableConfig[id] = normalConfig;\n            }\n        }\n\n        public normalizeVariableConfig(variableData: {[id: string]: VariableDataValue}): {[id: string]: IVariableData} {\n            for (const id in variableData) {\n                if (variableData.hasOwnProperty(id)) {\n                    const v = variableData[id];\n                    const varV = this.createIVariableData(id, v);\n                    variableData[id] = varV;\n                }\n            }\n            return variableData;\n        }\n\n        public addVariableToGlobal(variableData: {[id: string]: IVariableData}): void {\n            const globalId: string = VariableManager.GLOBAL_ID;\n            this.variableMap[globalId] = this.deepCopy(variableData);\n\n            if (this.variableConfig[globalId]) {\n                const variables = this.variableConfig[globalId];\n                this.variableMap[globalId] = this.deepCopy(variables);\n            } else {\n                this.addVariableConfig(globalId, variableData);\n                if (this.variableConfig[globalId]) {\n                    const variables = this.variableConfig[globalId];\n                    this.variableMap[globalId] = this.deepCopy(variables);\n                } \n            }\n        }\n\n        public addVariableToComponent(component: VFComponent): void {\n            const libId = component.libId;\n            if (libId) {\n                if (this.variableConfig[libId.toString()]) {\n                    const variables = this.variableConfig[libId.toString()];\n                    this.variableMap[component.id.toString()] = this.deepCopy(variables);\n                }\n            }\n        }\n        \n        public addVariableDataToComponent(component: VFComponent, varId: string, type: VariableType, data: any): void {\n            const libId = component.libId;\n            const compId = component.id;\n            this.addVariable(libId, compId, varId, type, data);\n        }\n        public addVariableDataToGlobal(varId: string, type: VariableType, data: any): void {\n            this.addVariable(VariableManager.GLOBAL_ID, VariableManager.GLOBAL_ID, varId, type, data);\n        }\n            \n        public addVariable(libId: string, targetId: string, varId: string, type: VariableType, data: any): void {\n            const variableData: IVariableData = {\n                id: varId,\n                type,\n                value: data,\n            };\n            const variable2: IVariableData = {\n                id: varId,\n                type,\n                value: data,\n            };\n\n            let globalVarConfig = this.variableConfig[libId];\n            if (!globalVarConfig) {\n                globalVarConfig = {};\n                this.variableConfig[libId] = globalVarConfig;\n            }\n            globalVarConfig[varId] = variableData;\n            \n            let globalVarMap = this.variableMap[targetId];\n            if (!globalVarMap) {\n                globalVarMap = {};\n                this.variableMap[targetId] = globalVarMap;\n            }\n            globalVarMap[varId] = variable2;\n        }\n\n        public getGlobalVariable(id: string): IVariableData | undefined {\n            return this.getVariable(VariableManager.GLOBAL_ID, id);\n        }\n        public getVariable(hasCode: string, id: string): IVariableData | undefined {\n            const varData: {[id: string]: IVariableData} = this.variableMap[hasCode];\n            if (varData && varData[id]) {\n                return varData[id];\n            }\n        }\n        public getVariableByData(component: VFComponent, expressItem: ExpressItem): IVariableData | undefined {\n            if (expressItem[0] === ExpressItemType.PARAM_VALUE) {\n                return this.getVariable(VariableManager.GLOBAL_ID, expressItem[2]);\n            }\n            const varComponent: VFComponent  = getTargetComponent(component, expressItem[1]) as VFComponent;\n            const hashCode = varComponent ? varComponent.id.toString() : VariableManager.GLOBAL_ID;\n            const varItem = this.getVariable(hashCode, expressItem[2]);\n            return varItem;\n        }\n\n        public caculateExpress(component: VFComponent, express: ExpressType): any {\n            const stackOut: ExpressType = [];\n            const stackOperate: ExpressType = [];\n            for (let i: number = 0, len: number = express.length; i < len; i++) {\n                const expressItem = express[i];\n                switch (expressItem[0]) {\n                    case ExpressItemType.CONST:\n                    case ExpressItemType.VARIABLE:\n                    case ExpressItemType.STSTEN:\n                    case ExpressItemType.RANDOM:\n                    case ExpressItemType.PROPERTY:\n                    case ExpressItemType.ARRAY_LEN:\n                    case ExpressItemType.ARRAY_VALUE:\n                    case ExpressItemType.OBJECT_VALUE:\n                    case ExpressItemType.PARAM_VALUE:\n                    case ExpressItemType.ARRAY_FUNCTION:\n                    case ExpressItemType.COMPONENT:\n                        stackOut.push(expressItem);\n                        break;\n                    case ExpressItemType.OPERATION:\n                        switch (expressItem[1]) {\n                            case '(':\n                                stackOperate.push(expressItem);\n                                break;\n                            case ')':\n                                let v = stackOperate.pop();\n                                while ( v && v[1] !== '(') {\n                                    stackOut.push(v);\n                                    v = stackOperate.pop();\n                                }\n                                break;\n                            default:\n                                const operateStr = expressItem[1];\n                                const curPriority = (VariableManager.OPERATE_PRIORITY as any)[operateStr];\n                                if (!curPriority) {\n                                    // can not support this operation:\n                                    this.emitError(component, 'E1001', [operateStr], EventLevel.WARNING);\n                                    return 0;\n                                } else {\n                                    if (stackOperate.length > 0) {\n                                        let topOperate = stackOperate[stackOperate.length - 1];\n                                        let topOperatePriority = \n                                            (VariableManager.OPERATE_PRIORITY as any)[topOperate[1]];\n                                        if (curPriority > topOperatePriority) {\n                                            stackOperate.push(expressItem);\n                                        } else {\n                                            while (curPriority < topOperatePriority) {\n                                                stackOut.push(topOperate);\n                                                stackOperate.pop();\n                                                if (stackOperate.length > 0) {\n                                                    topOperate = stackOperate[stackOperate.length - 1];\n                                                    topOperatePriority = \n                                                        (VariableManager.OPERATE_PRIORITY as any)[topOperate[1]];\n                                                } else {\n                                                    break;\n                                                }\n                                            }\n                                            stackOperate.push(expressItem);\n                                        }\n                                    } else {\n                                        stackOperate.push(expressItem);\n                                    }\n                                }\n                                break;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            }\n            if (stackOperate.length > 0) {\n                while (stackOperate.length > 0) {\n                    const operateStr = stackOperate.pop();\n                    if (operateStr) {\n                        stackOut.push(operateStr);\n                    }\n                }\n            }\n            const value = this.caculateExpressValue(component, stackOut);\n            return value;\n        }\n        public getExpressItemValue(component: VFComponent, expressItem: ExpressItem): any {\n            let result: any;\n            switch (expressItem[0]) {\n                case ExpressItemType.CONST:\n                    result = (expressItem[1]);\n                    break;\n                case ExpressItemType.VARIABLE:\n\n                    const varItem = this.getVariableByData(component, expressItem);\n                    if (varItem) {\n                        result = (varItem.value);\n                    } else {\n                        this.emitError(component, 'E1002', [expressItem.join(',')], EventLevel.WARNING);\n                        // can not find variable:\n                    }\n                    \n                    break;\n                case ExpressItemType.STSTEN:\n                    const curDate = new Date();\n                    let systemValue = 0;\n                    switch (expressItem[1]) {\n                        case SystemValueType.TIME:\n                            systemValue = curDate.getTime();\n                            break;\n                        case SystemValueType.YEAR:\n                            systemValue = curDate.getFullYear();\n                            break;\n                        case SystemValueType.MONTH:\n                            systemValue = curDate.getMonth();\n                            break;\n                        case SystemValueType.DAY:\n                            systemValue = curDate.getDay();\n                            break;\n                        case SystemValueType.DATE:\n                            systemValue = curDate.getDate();\n                            break;\n                        default:\n                            break;\n                    }\n                    result = (systemValue);\n                    break;\n                case ExpressItemType.RANDOM:\n                    let randomValue = 0;\n                    if (expressItem.length >= 3) {\n                        const min = expressItem[1];\n                        const max = expressItem[2];\n                        randomValue = Math.round(Math.random() * (max - min)) + min;\n                    } else {\n                        randomValue = Math.random();\n                    }\n                    result = (randomValue);\n                    break;\n                case ExpressItemType.COMPONENT:\n                    const targetArr0 = expressItem[1];\n                    const targetComponent0 = getTargetComponent(component, targetArr0);\n                    result = targetComponent0;\n                    break;\n                case ExpressItemType.PROPERTY:\n                    const targetArr = expressItem[1];\n                    const targetProperty = expressItem[2];\n                    const targetComponent = getTargetComponent(component, targetArr);\n                    if (targetComponent) {\n                        result = (targetComponent as any)[targetProperty];\n                    }\n                    break;\n                case ExpressItemType.ARRAY_LEN:\n                    const arrItem = this.getVariableByData(component, expressItem);\n                    if (arrItem) {\n                        result = (arrItem.value.length);\n                    } else {\n                        this.emitError(component, 'E1002', [expressItem.join(',')], EventLevel.WARNING);\n                        // can not find variable:\n                    }\n                    break;\n                case ExpressItemType.ARRAY_VALUE:\n                    // expressItem 0:type, 1:componentId, 2: variableId, 3: index, 4?: property\n                    const arrItem1 = this.getVariableByData(component, expressItem);\n                    if (arrItem1) {\n                        const arr = arrItem1.value;\n                        let index: number = expressItem[3];\n                        if (Array.isArray(index)) {\n                            const indexVar = this.getExpressItemValue(component, index);\n                            if (isNumber(indexVar) ) {\n                                index = indexVar;\n                            } else {\n                                // can not find array index by variable:\n                                this.emitError(component, 'E1003', [index], EventLevel.WARNING);\n                                index = 0;\n                            }\n                        }\n                        result = arr[index];\n                        if (expressItem.length >= 5 && result) {\n                            result = result[expressItem[4]]; \n                        } \n                    } else {\n                        this.emitError(component, 'E1002', [expressItem.join(',')], EventLevel.WARNING);\n                        // can not find variable:\n                        \n                    }\n                    break;\n                case ExpressItemType.ARRAY_FUNCTION:\n                    const arrItem2 = this.getVariableByData(component, expressItem);\n                    if (arrItem2) {\n                        if (Array.isArray(arrItem2.value)) {\n                            const targetArray: any[] = arrItem2.value;\n                            switch (expressItem[3]) {\n                                case 'pop': // [10, [], 'arr', 'pop']\n                                    result = targetArray.pop();\n                                    break;\n                                case 'push': // [10, [], 'arr', 'push', [0, 4]]\n                                    if (expressItem.length > 4) {\n                                        const pushTarget = this.getExpressItemValue(component, expressItem[4]);\n                                        result = targetArray.push(pushTarget);\n                                    }\n                                    break;\n                                case 'shift': // [10, [], 'arr', 'shift']\n                                    result = targetArray.shift();\n                                    break;\n                                case 'unshift': // [10, [], 'arr', 'unshift', [0, 4]]\n                                    if (expressItem.length > 4) {\n                                        const unshiftTarget = this.getExpressItemValue(component, expressItem[4]);\n                                        result = targetArray.unshift(unshiftTarget);\n                                    }\n                                    break;\n                                case 'concat': // [10, [], 'arr', 'concat', [0, [1,2]]]\n                                    if (expressItem.length > 3) {\n                                        if (expressItem.length > 4) {\n                                            const concatTarget = this.getExpressItemValue(component, expressItem[4]);\n                                            result = targetArray.concat(concatTarget);\n                                        } else {\n                                            result = targetArray.concat();\n                                        }\n                                    }\n                                    break;\n                                case 'splice': // [10, [], 'arr', 'splice', [0, 1], [0,1] => $arr.splice(1,1);\n                                    if (expressItem.length === 5) {\n                                        const startValue = this.getExpressItemValue(component, expressItem[4]);\n                                        result = targetArray.splice(startValue);\n                                    } else if (expressItem.length === 6) {\n                                        const startValue = this.getExpressItemValue(component, expressItem[4]);\n                                        const deleteCount = this.getExpressItemValue(component, expressItem[5]);\n                                        result = targetArray.splice(startValue, deleteCount);\n                                    } else if (expressItem.length > 6) {\n                                        const startValue = this.getExpressItemValue(component, expressItem[4]);\n                                        const deleteCount = this.getExpressItemValue(component, expressItem[5]);\n                                        const addValue = this.getExpressItemValue(component, expressItem[6]);\n                                        result = targetArray.splice(startValue, deleteCount, addValue);\n                                    }\n                                    break;\n                                default:\n                                    // array has not function: \n                                    this.emitError(component, 'E1004', [expressItem[3]], EventLevel.WARNING);\n                                    break;\n                            }\n                        } else {\n                            // variable is not array: \n                            this.emitError(component, 'E1005', [expressItem.join(',')], EventLevel.WARNING);\n                        }\n                    } else {\n                        this.emitError(component, 'E1002', [expressItem.join(',')], EventLevel.WARNING);\n                        // can not find variable:\n                    }\n                    break;\n                case ExpressItemType.OBJECT_VALUE:\n                case ExpressItemType.PARAM_VALUE:\n                    // expressItem 0:type, 1:componentId, 2: variableId, 3: property, 4?: property\n                    const objItem = this.getVariableByData(component, expressItem);\n                    if (objItem) {\n                        let obj = objItem.value;\n                        for (let i: number = 3, len: number = expressItem.length; i < len; i++) {\n                            const key = expressItem[i];\n                            if (obj && key !== undefined) {\n                                obj = obj[key];\n                            }\n                        }\n                        result = obj;\n                    }\n                    break;\n                default:\n                    break;\n            }\n            return result;\n        }\n\n        private caculateExpressValue(component: VFComponent, stackExpress: ExpressType): any {\n            const stackOut: ExpressType = [];\n            if (stackExpress.length === 1) {\n                return this.getExpressItemValue(component, stackExpress[0]);\n            }\n            for (let i: number = 0, len: number = stackExpress.length; i < len; i++) {\n                const expres = stackExpress[i];\n                switch (expres[0]) {\n                    case ExpressItemType.OPERATION:\n                        let expItem0: ExpressItem | undefined;\n                        let expItem1: ExpressItem | undefined;\n                        if (expres[1] === '!') {\n                            expItem0 = stackOut.pop();\n                        } else {\n                            expItem1 = stackOut.pop();\n                            expItem0 = stackOut.pop();\n                        }\n                        const resultItem = this.caculateOneExpress(component, expres[1], expItem0, expItem1);\n                        stackOut.push(resultItem);\n                        break;\n                    default:\n                        stackOut.push(expres);\n                        break;\n                }\n            }\n            if (stackOut.length === 1) {\n                return stackOut[0][1];\n            } else {\n                // caculateExpressValue error'\n                this.emitError(component, 'E1006', undefined, EventLevel.WARNING);\n                return 0;\n            }\n        }\n\n        private caculateOneExpress(component: VFComponent, operateStr: string, \n                                   expItem0?: ExpressItem, expItem1?: ExpressItem): ExpressItem {\n            const resultItem: ExpressItem = [ExpressItemType.CONST, 0];\n            let result0: any;\n            let result1: any;\n            let result: any;\n            if (expItem0) {\n                result0 = this.getExpressItemValue(component, expItem0);\n            }\n            if (expItem1) {\n                result1 = this.getExpressItemValue(component, expItem1);\n            }\n            switch (operateStr) {\n                case '*' :\n                    result = result0 * result1;\n                    break;\n                case '/' :\n                    result = result0 / result1;\n                    break;\n                case '%' :\n                    result = result0 % result1;\n                    break;\n                case '+' :\n                    result = result0 + result1;\n                    break;\n                case '-' :\n                    result = result0 - result1;\n                    break;\n                case '>=' :\n                    result = result0 >= result1;\n                    break;\n                case '<=' :\n                    result = result0 <= result1;\n                    break;\n                case '>' :\n                    result = result0 > result1;\n                    break;\n                case '<' :\n                    result = result0 < result1;\n                    break;\n                case '==' :\n                    // tslint:disable-next-line: triple-equals\n                    result = result0 == result1;\n                    break;\n                case '===' :\n                    result = result0 === result1;\n                    break;\n                case '!=' :\n                    // tslint:disable-next-line: triple-equals\n                    result = result0 != result1;\n                case '!==' :\n                    result = result0 !== result1;\n                    break;\n                case '!' :\n                    result = !result0;\n                    break;\n                case '&&' :\n                    result = result0 && result1;\n                    break;\n                case '||' :\n                    result = result0 || result1;\n                    break;\n                case '=' :\n                    result = result1;\n                    if (expItem0) {\n                        switch (expItem0[0]) {\n                            case ExpressItemType.VARIABLE:\n                                const varItem = this.getVariableByData(component, expItem0);\n                                if (varItem) {\n                                    varItem.value = result;\n                                } else {\n                                    this.emitError(component, 'E1002', [expItem0.join(',')], EventLevel.WARNING);\n                                    // can not find variable:\n                                }\n                                break;\n                            case ExpressItemType.PROPERTY:\n                                const targetArr = expItem0[1];\n                                const targetProperty = expItem0[2];\n                                const targetComponent = getTargetComponent(component, targetArr);\n                                if (targetComponent) {\n                                    if (expItem0.length >= 3) {\n                                        let targetProp: any = targetComponent;\n                                        let prop: any = targetProperty;\n                                        for (let i: number = 2, len: number = expItem0.length; i < len; i++) {\n                                            prop = expItem0[i];\n                                            if (i === len - 1) {\n                                                break;\n                                            } else {\n                                                if (targetProp) {\n                                                    targetProp = targetProp[prop];\n                                                } else {\n                                                    // can not find property: \n                                                    this.emitError(component, 'E1007', [expItem0.join(',')], \n                                                                    EventLevel.WARNING);\n                                                }\n                                            }\n                                        }\n                                        if (targetProp && prop) {\n                                            targetProp[prop] = result;\n                                        } else {\n                                            // can not find property: \n                                            this.emitError(component, 'E1007', [expItem0.join(',')], \n                                                            EventLevel.WARNING);\n                                        }\n                                    } \n                                }\n                                break;\n                            case ExpressItemType.ARRAY_LEN:\n                                const arrItem = this.getVariableByData(component, expItem0);\n                                if (arrItem) {\n                                    arrItem.value.length = result;\n                                } else {\n                                    this.emitError(component, 'E1002', [expItem0.join(',')], EventLevel.WARNING);\n                                    // can not find variable:\n                                }\n                                break;\n                            case ExpressItemType.ARRAY_VALUE:\n                                // expItem0 0:type, 1:componentId, 2: variableId, 3: index, 4?: property\n                                const arrItem1 = this.getVariableByData(component, expItem0);\n                                if (arrItem1) {\n                                    const arr = arrItem1.value;\n                                    let index: number = expItem0[3] || 0;\n                                    if (Array.isArray(index)) {\n                                        const indexVar = this.getExpressItemValue(component, index);\n                                        if (isNumber(indexVar) ) {\n                                            index = indexVar;\n                                        } else {\n                                            // can not find array index by variable:\n                                            this.emitError(component, 'E1003', [index], \n                                                            EventLevel.WARNING);\n                                            index = 0;\n                                        }\n                                    }\n                                    if (expItem0.length >= 5) {\n                                        let obj = arr[index];\n                                        let key;\n                                        for (let i: number = 4, len: number = expItem0.length; i < len; i++) {\n                                            key = expItem0[i];\n                                            if (i < len - 1 && obj[key]) {\n                                                obj = obj[key];\n                                            }\n                                        }\n                                        if (obj && key !== undefined) {\n                                            obj[key] = result;\n                                        }\n                                    } else {\n                                        arr[index] = result;\n                                    }\n                                } else {\n                                    this.emitError(component, 'E1002', [expItem0.join(',')], EventLevel.WARNING);\n                                    // can not find variable:\n                                }\n                                break;\n                            case ExpressItemType.OBJECT_VALUE:\n                            case ExpressItemType.PARAM_VALUE:\n                                // expressItem 0:type, 1:componentId, 2: variableId, 3: property, 4?: property\n                                const objItem = this.getVariableByData(component, expItem0);\n                                if (objItem) {\n                                    let obj = objItem.value;\n                                    let key;\n                                    for (let i: number = 3, len: number = expItem0.length; i < len; i++) {\n                                        key = expItem0[i];\n                                        if (i < len - 1 && obj[key]) {\n                                            obj = obj[key];\n                                        }\n                                    }\n                                    if (obj && key !== undefined) {\n                                        obj[key] = result;\n                                    } else {\n                                        // 基本类型\n                                        objItem.value = result;\n                                    }\n                                }\n                                break;\n                            case ExpressItemType.CONST:\n                                // the left value can NOT be const:\n                                this.emitError(component, 'E1008', [expItem0.join(',')], EventLevel.WARNING);\n                                break;\n                            default:\n                                break;\n                        }\n                    }\n                    break;\n                default:\n                    // can not support this operation:\n                    this.emitError(component, 'E1001', [operateStr], EventLevel.WARNING);\n                    break;\n            }\n            resultItem[1] = result;\n            return resultItem;\n        }\n\n        private deepCopy(variableData: {[id: string]: IVariableData}): {[id: string]: IVariableData} {\n                const str = JSON.stringify(variableData);\n                const newVariableData = JSON.parse(str) as {[id: string]: IVariableData};\n                return newVariableData;\n        }\n\n        private isIVariableData(v: any): boolean {\n            if (isObject(v)  &&  \n               v.hasOwnProperty('type') && \n               v.hasOwnProperty('value') &&\n               ( v.type === VariableType.ARRAY ||\n                 v.type === VariableType.BOOLEAN ||\n                 v.type === VariableType.NUMBER ||\n                 v.type === VariableType.OBJECT ||\n                 v.type === VariableType.STRING)\n               ) {\n                return true;\n            }\n            return false;\n        }\n        private createIVariableData(id: string, v: any): IVariableData {\n            if (!this.isIVariableData(v)) {\n                const varData: IVariableData = {\n                    id,\n                    type: VariableType.OBJECT,\n                    value: v,\n                };\n                if (isBoolean(v)) {\n                    varData.type = VariableType.BOOLEAN;\n                } else if ( isString(v)) {\n                    varData.type = VariableType.STRING;\n                } else if ( isNumber(v)) {\n                    varData.type = VariableType.STRING;\n                } else if ( isArray(v)) {\n                    varData.type = VariableType.ARRAY;\n                } else {\n                    varData.type = VariableType.OBJECT;\n                }\n                return varData;\n            } else {\n                return v;\n            }\n        }\n        private emitError(component: VFComponent, code: string, params?: any[], level: EventLevel = EventLevel.ERROR) {\n            if (component && component.vfStage) {\n                const vfStage = component.vfStage;\n                vfStage.systemEvent.emitError(code, params, level);\n            } else {\n                throw new Error( code + ': ' + params?.join(' '));\n            }\n\n        }\n        \n    }\n\n","\nexport interface IVFDataV1 {\n    name: string;\n    version: string;\n    width: number;\n    height: number;\n    fps: number;\n    scaleMode: ScaleMode;\n    loadMode: LoadMode;\n    baseUrl: string;\n    conversion: string;\n    global?: { [id: string]: IVariableData };\n    assets: { [id: string]: IAsset };\n    components: { [id: string]: AllComponent };\n scenes: IScene[];\n}\n\nexport const enum ScaleMode {\n    SHOW_ALL = 'showAll',\n    NO_SCALE = 'noScale',\n    COVER = 'cover',\n    CONTAIN = 'contain',\n}\nexport const enum LoadMode {\n    SINGLE = 'single',\n    ALL = 'all',\n}\n\nexport const enum VariableType {\n    NUMBER = 'number',\n    STRING = 'string',\n    BOOLEAN = 'boolean',\n    ARRAY = 'array',\n    OBJECT = 'object',\n}\n// tslint:disable-next-line: array-type\nexport type VariableDataValue = number | string | boolean | Array<any> | any;\nexport interface IVariableData {\n    id?: string;\n    type: VariableType;\n    value: VariableDataValue;\n}\n\nexport interface CDN{\n    default:string[];\n    image:string[];\n    media:string[];\n    wx:string[];\n}\n\nexport const enum AssetType {\n    IMAGE = 'image',\n    SOUND = 'sound',\n    SHEET = 'sheet',\n    SVG = 'svg',\n    FONT = 'font',\n    AUDIO = 'audio',\n    VIDEO = 'video',\n    JS = 'js',\n}\nexport interface IAsset {\n    id?: string;\n    name?: string;\n    type: AssetType;\n    url: string;\n}\n/**\n * 加载失败项\n */\nexport interface IAssetFail {\n    id: string;\n    url: string;\n    extension:string;\n    count:number;\n}\n\nexport const enum ComponentType {\n    // UI\n    CONTAINER = 'container',\n    TABLE = 'table',\n    IMAGE = 'Image',\n    BUTTON = 'Button',\n    RADIO = 'CheckBox',\n    CHECKBOX = 'CheckBox',\n    INPUT = 'input',\n    SLIDER = 'slider',\n    TEXT = 'Text',\n    RECT = 'Rect',\n    CIRCLE = 'Circle',\n    // ANI\n    DRAGONBONES = 'dragonbones',\n    PARTICLE = 'particle',\n    SHEET = 'sheet',\n    // MEDIA\n    VIDEO = 'video',\n    AUDIO = 'audio',\n    MICROPHONE = 'microphone',\n    // NPM\n    NPM = 'npm',\n    // VECTOR\n    SVG = 'svg',\n    GRAPHIC = 'graphic',\n    // CUSTOM\n    CUSTOM = 'custom',\n}\nexport interface IComponent {\n    id: string;\n    name: string;\n    type?: ComponentType;\n    resourceIds?: number[];\n    libId?: number;\n    interactabled?: any;\n}\nexport interface IDisplayComponent extends IComponent {\n    x: number;\n    y: number;\n    scaleX: number;\n    scaleY: number;\n    alpha: number;\n    color: number | undefined;\n    visible: boolean;\n\n    rotation: any;\n    width: number;\n    height: number;\n\n}\n\nexport interface IImage extends vf.gui.Image {\n\n}\nexport interface IText extends vf.gui.Label {\n\n}\nexport interface IRadio extends vf.gui.CheckBox {\n\n}\nexport interface IRect extends vf.gui.Rect {\n\n}\nexport interface IAnimation {\n    name: string;\n    duration?: number;\n    autoPlay?: boolean;\n    loop?: boolean;\n    children: { [id: string]: ISubAnimation };\n}\nexport interface ISubAnimation {\n    duration?: number;\n    loop?: boolean;\n    timelines: ITimeline[];\n}\nexport interface ITimeline {\n    type: TimelineType;\n    loop?: boolean;\n    frames: IFrame[];\n}\nexport interface IEventData {\n    type: string;\n    data?: any;\n}\nexport const enum TimelineType {\n    X = 'x',\n    Y = 'y',\n    SCALE_X = 'scaleX',\n    SCALE_Y = 'scaleY',\n    ROTATION = 'rotation',\n    COLOR = 'color',\n    ALPHA = 'alpha',\n    VISIBLE = 'visible',\n    TEXT = 'text',\n    PROGRESS = 'progress',\n    SKEW_X = 'skewX',\n    SKEW_Y = 'skewY',\n    PLAY = 'play',\n    VOLUME = 'volume',\n    ENABLED = 'enabled',\n    FITERBLUR = 'filterBlur',\n    EVENT = 'event',\n}\nexport const enum CurveType {\n    None,\n    Linear,\n    EaseOutQuad,\n    EaseInQuad,\n    EaseInOutQuad,\n    EaseInCubic,\n    EaseOutCubic,\n    EaseInOutCubic,\n    EaseInQuart,\n    EaseOutQuart,\n    EaseInOutQuart,\n    EaseInQuint,\n    EaseOutQuint,\n    EaseInOutQuint,\n    EaseInSine,\n    EaseOutSine,\n    EaseInOutSine,\n    EaseInExpo,\n    EaseOutExpo,\n    EaseInOutExpo,\n    EaseInCirc,\n    EaseOutCirc,\n    EaseInOutCirc,\n    EaseOutBounce,\n    EaseInBack,\n    EaseOutBack,\n    EaseInOutBack,\n    Elastic,\n    EaseOutElastic,\n    EaseOutElasticTmp,\n    SwingFromTo,\n    SwingFrom,\n    SwingTo,\n    Bounce,\n    BouncePast,\n    EaseFromTo,\n    EaseFrom,\n    EaseTo,\n    Sinusoidal,\n    Reverse,\n    Wobble,\n    Spring,\n}\nexport interface IFrame {\n    frame: number;\n    value: any;\n    curve?: number[];\n}\n\nexport interface ICustomComponent extends IDisplayComponent {\n    children?: AllComponent[];\n    animations?: IAnimation[];\n    props?: { [id: string]: IVariableData };\n    actionList?: AllAction[] | string;\n}\n\nexport const enum TransitionType {\n    NONE = 'none',\n    FADE_OUT = 'fadeOut',\n    CIRCLE_WIPE = 'circleWipe',\n    CROSS_ZOOM = 'crossZoom',\n    DOOM_SCREEN = 'doomScreen',\n    HEART_WIPE = 'heartWipe',\n    LINEAR_BLUR = 'linearBlur',\n    PAGE_CURL = 'pageCurl',\n    TO_TEAR = 'toTear',\n    WIND = 'wind',\n    PAGE_FLIP_RIGHT = 'pageFlipRight',\n    PAGE_FLIP_LEFT = 'pageFlipLeft',\n}\nexport interface ITransitionData {\n    type: TransitionType;\n    duration: number;\n}\nexport interface IScene {\n    id: string;\n    libId: string;\n    transition?: ITransitionData;\n}\nexport interface ISoundTrackMedia {\n    id: string;\n    media: vf.sound.IMediaInstance;\n    sound: vf.sound.Sound;\n}\nexport type AllComponent = (IComponent | IDisplayComponent | ICustomComponent |\n    IRadio | IImage | IText | IRect);\n\n/// actionList ////////////////////////////////\n\nexport enum ExpressItemType {\n    CONST,     // 常量\n    VARIABLE,  // 变量\n    RANDOM,    // 随机值\n    STSTEN,    // 系统数值\n    PROPERTY,  // 组件属性\n    OPERATION, // 运算符\n    ARRAY_LEN,     // 数组长度\n    ARRAY_VALUE,   // 数组取值\n    OBJECT_VALUE,  // 对象取值\n    PARAM_VALUE,   // 参数取值\n    ARRAY_FUNCTION, // 数组 pop push shift unshift concat splice\n    COMPONENT, // 组件，仅在trace中使用\n}\nexport enum SystemValueType {\n    TIME,\n    YEAR,\n    MONTH,\n    DAY,\n    DATE,\n}\nexport type ExpressItem = any[];   // 表达式的项\nexport type ExpressType = ExpressItem[]; // 表达式\n\n/** 通用状态 */\nexport const enum VFStateCode {\n    INIT = 'init',\n    LOAD = 'load',\n    LOADED = 'loaded',\n    READY = 'ready',\n    DISABLED = 'disabled',\n    SCENE_CREATE = 'sceneCreate',\n}\n\nexport const enum ActionType {\n        Print,\n        Add,\n        Added,\n        Remove,\n        SetProperty,\n        Click,\n        Express,\n        IfGroup,\n        If,\n        ElseIf,\n        Else,\n        DefineFunction,\n        CallFunction,\n        AddEventListener,\n        RemoveEventListener,\n        EmitEvent,\n        PlaySound,\n        PlayAnimation,\n        JumpToNextScene,\n        JumpToPrevScene,\n        JumpToScene,\n        ArrayInit,\n        ArrayPop,\n        ArrayPush,\n        ArraySplice,\n        ArrayRandom,\n        ArrayConcat,\n        ArrayShift,\n        ArrayUnshift,\n        AddEventListenerCall,\n        CallProtoFunction,\n        GotoPlay,\n        GotoStop,\n        PauseSound,\n        ResumeSound,\n        Comment,\n        ActionList,\n        DefineVariable,\n        For,\n        Break,\n        Wait,\n        SetTimeout,\n        SetInterval,\n        EnterFrame,\n    }\nexport const enum ComponentEvent {\n    Add = 'Add',\n    Added = 'Added',\n    Remove = 'Remove',\n    Removed = 'Removed',\n    Click = 'click',\n}\n\nexport const enum SceneEvent {\n    TransitionStart = 'TransitionStart',\n    TransitionEnd = 'TransitionEnd',\n    LoadProgress = 'LoadProgress',\n    LoadComplete = 'LoadComplete',\n}\nexport const enum AnimationEvent {\n    AnimationComplete = 'AnimationComplete',\n    AnimationLoopComplete = 'AnimationLoopComplete',\n}\nexport const enum SoundEvent {\n    SoundEnd = 'SoundEnd',\n    SoundStart = 'SoundStart',\n}\nexport const enum AnimationStatus {\n    STOP,\n    PLAYING,\n}\n\n\nexport interface IActionSetProperty extends IAction {\n        property: string;\n        value: any;\n    }\nexport interface IActionPlayAnimation extends IAction {\n        name: string | ExpressItem;\n        times?: number;\n    }\nexport interface IActionExpress extends IAction {\n        express: ExpressType;\n    }\nexport interface IActionIFPart extends IAction {\n        condition: ExpressType;\n    }\nexport interface IActionFunction extends IAction {\n        name: string;\n    }\nexport interface IActionAddEventListener extends IAction {\n        event: string;\n        system?: boolean;\n        global?: boolean;\n        funName?: string;\n    }\nexport interface IActionEmitEvent extends IAction {\n        event: string;\n        system?: boolean;\n        global?: boolean;\n        eventData?: any;\n    }\nexport interface IActionJump extends IAction {\n        transition?: ITransitionData;\n    }\nexport interface IActionArraySplice extends IAction {\n        start: number;\n        deleteCount: number;\n    }\nexport interface IActionArrayConcat extends IAction {\n        concatArr: ExpressItem;\n    }\nexport interface IActionCallFunction extends IAction {\n        name: string | ExpressItem;\n        params?: ExpressItem[];\n    }\nexport interface IActionPlaySound extends IAction {\n        trackId?: string;\n        useNative?: boolean; \n        mode?: 'sound' | 'effect';\n    }\nexport interface IActionGoto extends IAction {\n        name: string | ExpressItem;\n        frame: number| ExpressItem;\n        times?: number | ExpressItem;\n    }\nexport interface IActionDefineVariable extends IAction {\n        variableType: VariableType;\n        varId: string;\n    }\nexport interface IActionFor extends IAction {\n        forin: ExpressItem;\n    }\nexport type AllAction = (IAction | IActionSetProperty | IActionExpress | IActionFunction\n    | IActionAddEventListener | IActionPlayAnimation);\n\nexport interface IAction {\n    type: ActionType;\n    execute?: AllAction[];\n    target?: string[];\n    value?: any;\n}\n\nexport interface IActionSetProperty extends IAction {\n    property: string;\n    value: any;\n}\nexport interface IActionPlayAnimation extends IAction {\n    name: string | ExpressItem;\n    times?: number;\n}\nexport interface IActionExpress extends IAction {\n    express: ExpressType;\n}\nexport interface IActionIFPart extends IAction {\n    condition: ExpressType;\n}\nexport interface IActionFunction extends IAction {\n    name: string;\n}\nexport interface IActionAddEventListener extends IAction {\n    event: string;\n    system?: boolean;\n    global?: boolean;\n    funName?: string;\n}\nexport interface IActionEmitEvent extends IAction {\n    event: string;\n    system?: boolean;\n    global?: boolean;\n    eventData?: any;\n}\nexport interface IActionJump extends IAction {\n    transition?: ITransitionData;\n}\nexport interface IActionArraySplice extends IAction {\n    start: number;\n    deleteCount: number;\n}\nexport interface IActionArrayConcat extends IAction {\n    concatArr: ExpressItem;\n}\nexport interface IActionCallFunction extends IAction {\n    name: string | ExpressItem;\n    params?: ExpressItem[];\n}\nexport interface IActionPlaySound extends IAction {\n    trackId?: string;\n    useNative?: boolean;\n    mode?: 'sound' | 'effect';\n}\nexport interface IActionGoto extends IAction {\n    name: string | ExpressItem;\n    frame: number | ExpressItem;\n    times?: number | ExpressItem;\n}\nexport interface IActionDefineVariable extends IAction {\n    variableType: VariableType;\n    varId: string;\n}\nexport interface IActionInterval extends IAction {\n    times?: number | ExpressItem;\n}\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction, IActionCallFunction, VariableType } from '../model/IVFData';\nimport { FunctionTask } from './FunctionTask';\nimport { VariableManager } from '../VariableManager';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class CallFunctionTask extends BaseTask {\n\n        public component: VFComponent;\n        public funName: string;\n        public data: IActionCallFunction;\n        protected _component: VFComponent | undefined;\n        protected runId: number = -1;\n        protected fun?: FunctionTask;\n        protected paramIds: string[] = [];\n        constructor(compontent: VFComponent, funName: string, data: IActionCallFunction) {\n            super();\n            this.component = compontent;\n            this.funName = funName;\n            this.data = data;\n        }\n\n        public run(): void {\n            super.run();\n            this._component = getTargetComponent(this.component, this.data.target) as VFComponent;\n            if (this._component && this._component.vfStage) {\n                const variableManager = this._component.vfStage.variableManager;\n                let funId = this.funName;\n                this.runId = variableManager.getFunctionId();\n                funId = this._component.hashCode + this.funName;\n                // 注入参数\n                this.paramIds.length = 0;\n                if (this.data.params) {\n                    const paramValues: any[] = [];\n                    for ( let i: number = 0, len: number = this.data.params.length; i < len; i++) {\n                        const param = this.data.params[i];\n                        let paramValue = param;\n                        if (Array.isArray(param)) {\n                            const paramVar = variableManager.getExpressItemValue(this.component, param);\n                            paramValue = paramVar;\n                        }\n                        paramValues.push(paramValue);\n                    }\n                    for (let i: number = 0, len: number = paramValues.length; i < len; i++) {\n                        const paramId = funId + this.runId + 'param_' + i;\n                        this.paramIds.push(paramId);\n                        if (!variableManager.variableMap[VariableManager.GLOBAL_ID]) {\n                            variableManager.variableMap[VariableManager.GLOBAL_ID] = {};\n                        }\n                        variableManager.variableMap[VariableManager.GLOBAL_ID][paramId] = {\n                            id: paramId,\n                            type: VariableType.OBJECT,\n                            value: paramValues[i],\n                        };\n                    }\n                }\n                this.fun = variableManager.getFunctionTask(funId);\n                if (this.fun) {\n                    // 替换表达式中的参数\n                    if (this.paramIds.length) {\n                        this.fun.injectParams(this.paramIds);\n                    }\n                    this.fun.on(TaskEvent.FUNCTION_RUN_COMPLETE, this.onRunComplete, this);\n                    this.fun.runWithId(this.runId);\n                } else {\n                    this.complete();\n                }\n            } else {\n                this.complete();\n            }\n        }\n\n        public stop(): void {\n            super.stop();\n            if (this.fun) {\n                this.fun.stopWithId(this.runId);\n            }\n            this.complete();\n        }\n\n        public break() {\n            super.break();\n            if (this.fun) {\n                this.fun.breakWithId(this.runId);\n            }\n            this.complete();\n        }\n\n        public complete(): void {\n            this.runId = 0;\n            if (this.fun) {\n                this.fun.off(TaskEvent.FUNCTION_RUN_COMPLETE,  this.onRunComplete, this);\n            }\n            // 删除参数\n            if (this.paramIds.length) {\n                if (this.component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    for (let i: number = 0, len: number = this.paramIds.length; i < len; i++) {\n                        const paramId = this.paramIds[i];\n                        delete variableManager.variableMap[VariableManager.GLOBAL_ID][paramId];\n                    }\n                }\n            }\n            super.complete();\n        }\n\n        private onRunComplete(data: any): void {\n            if (data === this.runId) {\n                this.complete();\n            }\n        }\n    }\n\n","/**\n * 信息、参数、配置对象基类\n *\n * @author 8088\n */\nimport StateEvent from '../event/StateEvent';\nimport {EventType} from '../event/EventType';\nimport {EventLevel} from '../event/EventLevel';\n\nexport default class BaseInfo{\n\n    /** 系统与对外事件 */\n    public readonly systemEvent = new StateEvent();\n\n    constructor(){\n\n    }\n\n    /**\n     * Add a listener for a given event.\n     */\n    public on(event: string, fn: any, context?: any): this {\n    \tthis.systemEvent.on(event, fn, context);\n    \treturn this;\n    }\n    public addListener(event: string, fn: Function, context?: any): this {\n    \treturn this.on(event, fn, context);\n    }\n\n    /**\n     * Remove the listeners of a given event.\n     */\n    public removeListener(event: string, fn?: Function, context?: any, once?: boolean): this{\n    \treturn this.off(event, fn, context, once);\n    }\n    public off(event: string, fn?: any, context?: any, once?: boolean): this{\n    \tthis.systemEvent.off(event, fn, context, once);\n    \treturn this;\n    }\n\n    /**\n     * 生成唯一标识ID\n     *\n     * @return 随机码\n     */\n    public createRandomId(): string {\n    \t// return String((new Date()).getTime()) + this.createRandomIdentifier(3);\n    \tvar specialChars:Array<string> = new Array('8', '9', 'A', 'B');\n    \treturn this.createRandomIdentifier(8, 15) + '-' + this.createRandomIdentifier(4, 15) + '-8' + this.createRandomIdentifier(3, 15) + '-' + specialChars[this.randomIntegerWithinRange(0, 3)] + this.createRandomIdentifier(3, 15) + '-' + this.createRandomIdentifier(12, 15);\n    }\n\n    /**\n     * 生成会话ID\n     *\n     * @return 随机码\n     */\n    public getSessionId(): string\n    {\n    \tlet _sessionId: string;\n    \tlet date:Date = new Date();\n    \t_sessionId = String(date.getTime()) + String(1000 + date.getMilliseconds()) + String(Math.floor(Math.random() * 9000) + 1000);\n    \treturn _sessionId;\n    }\n\n    /**\n     * 属性被更改后抛出changed事件\n     *\n     * @param\tpropertyName 对应已更改的属性名称\n     */\n    protected propertyChange(propertyName: string)\n    {\n    \tthis.systemEvent.emit(EventType.STATE, {\n    \t\tcode: this.getClassName(this) + this.PROPERTY_CHANGE,\n    \t\tlevel: EventLevel.STATUS,\n    \t\tdata: {name:propertyName, value:(<any> this)[propertyName]},\n    \t\t// message: 'mark:是否需要加详细的描述 打运行时日志 待定...'\n    \t});\n    }\n\n    /**\n     * 属性设置\n     * - 超出了对应支持的范围，上报此错误。\n     *\n     * @param\tpropertyName 属性名称\n     * @param\tsetValue 想要更改的值\n     */\n    protected propertyError(propertyName: string, setValue?: any)\n    {\n    \tthis.systemEvent.emit(EventType.STATE, {\n    \t\tcode: this.getClassName(this) + this.PROPERTY_SET_ERROR,\n    \t\tlevel: EventLevel.ERROR,\n    \t\tdata: {name:propertyName, value:setValue}\n    \t\t// message: 'mark:是否需要加详细的描述 打运行时日志 待定...'\n    \t});\n    }\n\n    public get info(): object {\n    \treturn {};\n    }\n\n    public output(ttl: string, obj: any) {\n        console.groupCollapsed(ttl);\n        for(const key in obj) {\n            console.log('%c' + key + ':', 'color: violet;', obj[key]);\n        }\n        console.groupEnd();\n    }\n\n\n    // Internals..\n    //\n\n    private createRandomIdentifier(length: number, radix: number = 61): string {\n    \tlet characters: Array<string> = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];\n    \tlet id: Array<string> = [];\n    \tradix = (radix > 61) ? 61 : radix;\n    \twhile (length--) {\n    \t\tid.push(characters[this.randomIntegerWithinRange(0, radix)]);\n    \t}\n    \treturn id.join('');\n    }\n\n    private randomIntegerWithinRange(min: number, max: number): number {\n    \treturn Math.floor(Math.random() * (1 + max - min) + min);\n    }\n\n    private getClassName(value: any) {\n    \tlet regex = /function (.{1,})\\(/;\n    \tlet results = regex.exec((<any> value).constructor.toString());\n    \treturn (results && results.length > 1) ? results[1] : '';\n    }\n\n    private PROPERTY_CHANGE: string = '.Property.Changed';\n    private PROPERTY_SET_ERROR: string = '.Property.SetError';\n}\n","/* eslint-disable no-unused-vars */\nimport { VFStage } from './display/VFStage';\nimport calculateUpdatePlayerSize from './utils/CalculatePlayerSize';\nimport importScript from './utils/ImportScript';\nimport IEvent from './event/IEvent';\nimport { IVFOptions, EngineAPI } from './IVFEngine';\nimport { IVFDataV1, ScaleMode, VFStateCode, ITransitionData } from './core/model/IVFData';\nimport Config from './core/Config';\nimport System from './core/System';\nimport { EventType } from './event/EventType';\nimport { EventLevel } from './event/EventLevel';\nimport ErrorDisplay from './error/ErrorDisplay';\nimport readFileSync from './utils/readFileSync';\n\ndeclare var VFBUILDDATE: any; //webpack全局变量，prod环境使用\n\nexport class Player implements EngineAPI {\n\n    /**\n     * 系统环境\n     * @type {System}\n     */\n    public static system: System;\n    /**\n     * @private\n     * @type {vf.Application}\n     */\n    private app?: vf.Application;\n\n    /**\n     * @private\n     * @type {VFStage}\n     */\n    private stage?: VFStage;\n\n    /**\n     * @private\n     * @type {IVFDataV1}\n     */\n    private _data?: IVFDataV1;\n\n    /**\n     * @private\n     * @type {VFStage}\n     */\n    private _readyState: VFStateCode;\n    public get readyState() {\n        return this._readyState;\n    }\n    public set readyState(value) {\n        this._readyState = value;\n        this.config.systemEvent.emit(EventType.STATUS, { code: value, level: EventLevel.STATUS, data: value });\n    }\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    private _errpanel: ErrorDisplay;\n\n    /**\n     * @private\n     * @type {Config}\n     */\n    private config: Config;\n\n    constructor(options: IVFOptions) {\n        // console.group('VF Player: - v' + options.engineVersion);\n        // 1、启动后检查并初始化运行环境\n        Player.system = System.getInstance();\n        // 影响卸载与垃圾回收\n        // Engine.system.systemEvent.on(EventType.STATE, this.onSystemCheck, this);\n\n        //  2、解析外部配置参数并初始化\n        this.config = new Config(options);\n        // 影响卸载与垃圾回收\n        // this.config.systemEvent.on(EventType.STATE, this.onConfigCheck, this);\n        this._errpanel = new ErrorDisplay(this.config);\n\n        this.initSystemEvent();\n\n        this._readyState = VFStateCode.INIT;\n        console.log('Build Date - ' + VFBUILDDATE);\n        console.groupEnd();\n        //  3、如果配了资源地址，则启动数据加载\n        if (this.config.src) { this.play(this.config.src); }\n\n    }\n\n    public async play(src?: any) {\n        if (this._readyState !== VFStateCode.INIT &&\n            this._readyState !== VFStateCode.LOADED) {\n            this.reload();\n        }\n        this.loadData(src);\n    }\n\n    public pause() {\n        if (this.stage) {\n            this.stage.pause();\n        }\n    }\n\n    public resume() {\n        if (this.stage) {\n            this.stage.resume();\n        }\n    }\n\n    public reset() {\n        if (this.stage) {\n            this.stage.reset();\n        }\n    }\n\n    public message(msg: IEvent) {\n        this.config.systemEvent.emit(EventType.ONMESSAGE, msg);\n    }\n\n    public runtimeLog(msg: IEvent) {\n        this.onMessage(msg);\n    }\n\n    public switchToNextScene(transition?: ITransitionData): void {\n        if (this.stage) {\n            this.stage.switchToNextScene(transition);\n        }\n    }\n\n    public switchToPrevScene(transition?: ITransitionData): void {\n        if (this.stage) {\n            this.stage.switchToPrevScene(transition);\n        }\n    }\n\n    public switchToSceneId(sceneId: string, transition?: ITransitionData): void {\n        if (this.stage) {\n            this.stage.switchToSceneId(sceneId, transition);\n        }\n    }\n\n    public dispose(removeView: boolean = false): void {\n\n        if (this.readyState === VFStateCode.DISABLED) {\n            return;\n        }\n        // if (vf.sound) {\n        //     vf.sound.close();\n        // }\n\n        this.config.systemEvent.removeAllListeners();\n\n        if (this.stage) {\n            this.stage.dispose();\n        }\n\n        if (this.app && this.app.stage) {\n            this.app.destroy(removeView, { children: true, texture: true, baseTexture: true });\n        }\n\n        this.onDispose();\n        this.readyState = VFStateCode.DISABLED;\n    }\n\n    /**\n     * 接口，避免写入逻辑\n     */\n    public onError = (err: any) => {\n        //\n    }\n\n    /**\n     * 接口，避免写入逻辑\n     */\n    public onInit = () => {\n        //\n    }\n\n    /**\n     * 接口，避免写入逻辑\n     */\n    public onReady = () => {\n        //\n    }\n\n    /**\n     * 接口，避免写入逻辑\n     */\n    public onSceneCreate = () => {\n        //\n    }\n\n    /**\n     * 接口，避免写入逻辑\n     */\n    public onMessage = (msg: IEvent) => {\n        //\n    }\n\n    /**\n     * 接口，避免写入逻辑\n     */\n    public onDispose = () => {\n        //\n    }\n\n    private initSystemEvent() {\n        const event = this.config.systemEvent;\n        event.on(EventType.MESSAGE, this.sendMessage, this);\n        event.on(EventType.STATUS, this.onStatus, this);\n    }\n\n    private reload(): void {\n\n        this.config.systemEvent.removeAllListeners();\n\n        if (this.stage) {\n            this.stage.dispose();\n        }\n\n        if (this.app) {\n            this.app.destroy(true, { children: true, texture: true, baseTexture: true });\n        }\n\n        this.initSystemEvent();\n    }\n\n    /**\n     * 启动\n     * TODO：\n     *   1、目前是打包到一起的pixi引擎，后面需改改成按配置异步加载\n     *   2、按配置对画布做自适应布局\n     *   3、重新定义版本号的输出结构（VF标识、版本、编译时间、环境支持信息..），提到版本控制模块里\n     */\n    private async start() {\n        if (!this._data) { return; }\n        // 0、更新配置\n        this.config.width = this._data.width; // 设计尺寸\n        this.config.height = this._data.height; // 设计尺寸\n        if (this.config.scaleMode === undefined) {\n            this.config.scaleMode = this._data.scaleMode || ScaleMode.NO_SCALE;\n        }\n\n        // 1、关闭PX的sayHello();\n        vf.utils.skipHello();\n\n        // 2、初始化渲染引擎，并将渲染器的画布添加到容器（目前是PIXI）\n        const options = {\n            width: this.config.width,\n            height: this.config.height,\n            backgroundColor: parseInt(this.config.bgcolor || '0', 16),\n            transparent: this.config.wmode === 'transparent' ? true : false,\n            antialias: true,\n        };\n        this.app = new vf.Application(options);\n        this.app.view.style.zIndex = '0';\n        this.config.container.appendChild(this.app.view);\n\n        // 3、初始化基于PX容器的VF场景\n        this.stage = new VFStage(this._data, this.config, this);\n        this.stage.app = this.app;\n        this.app.stage.addChild(this.stage.container);\n\n        // 4、 适配处理\n        calculateUpdatePlayerSize(this.app.view, this.stage, this.config.scaleMode);\n\n        // 5、初始化API模块，并通知外部'vf[hashid] api is ready'\n        this.readyState = VFStateCode.READY;\n\n        // 6、加载场景资源\n        this.stage.start();\n    }\n\n    private async loadData(src: any) {\n\n        this.readyState = VFStateCode.LOAD;\n\n        const onStatus = this.onStatus.bind(this);\n\n        await this.config.i18n.load(this.config.cdns.default, onStatus);\n\n        if (typeof src === 'string') {\n            this._data = await readFileSync(src, { responseType: 'json' }).catch((value) => { onStatus(value); });\n        } else if (typeof src === 'object') {\n            this._data = src;\n        }\n\n        const data = this._data;\n        if (data) {\n            if (data.conversion) {\n                if (typeof src === 'string') {\n                    const version = src.split('?')[1] || 'v=0';\n                    // tslint:disable-next-line: max-line-length\n                    const conversionPath = src.substr(0, src.lastIndexOf('/')) + '/' + data.conversion + '?' + version;\n                    await importScript(conversionPath).catch((e: IEvent) => {\n                        this.onStatus(e);\n                    });\n                    const vFConversion = await new (window as any).VFConversion();\n                    await vFConversion.analysis(this.config.conversionData, this._data);\n                } else {\n                    this.onStatus({ code: 'E0005', level: EventLevel.ERROR, data: data.conversion });\n                }\n            }\n            this.readyState = VFStateCode.LOADED;\n            await this.start();\n        }\n    }\n\n    private onSystemCheck(evt: any) {\n        // 检查系统环境不支持的报错\n        // this.onError(evt);\n    }\n\n    private onConfigCheck(evt: any) {\n        // 验证配置信息有问题的报错\n        // this.onError(evt);\n    }\n\n    // ------------------------- 外部与钩子 ---------------------------//\n    /**\n     * 接收到服务\n     * @param msg \n     */\n    private sendMessage(msg: IEvent) {\n        this.onMessage(msg);\n    }\n\n    /**\n     * 接收到的状态\n     * @param msg \n     */\n    private onStatus(msg: IEvent) {\n        if (msg.level === EventLevel.ERROR || msg.level === EventLevel.WARNING) {\n            if (msg.level === EventLevel.ERROR) {\n                this._errpanel.setMessage(msg.code, msg.data);\n            }\n            msg.message = this._errpanel.getText(msg.code, msg.data);\n            this.onError(msg);\n            return;\n        }\n        switch (msg.code) {\n        case VFStateCode.INIT:\n            this.onInit();\n            break;\n        case VFStateCode.READY:\n            this.onReady();\n            break;\n        case VFStateCode.SCENE_CREATE:\n            this.onSceneCreate();\n            break;\n        default:\n            this.onMessage(msg);\n        }\n    }\n\n\n}","/* eslint-disable no-unused-vars */\nimport { ActionList } from '../core/actionTask/ActionList';\nimport { Animation } from '../core/animation/Animation';\nimport { VFStage } from './VFStage';\nimport { IVariableData, ComponentEvent } from '../core/model/IVFData';\nimport { DisplayObjectAbstract } from 'src/core/DisplayObjectAbstract';\n\nexport class VFComponent extends vf.gui.Container {\n\n        public static maxHashCode: number = 10000;\n        public hashCode: number = ++VFComponent.maxHashCode;\n        public actionList: ActionList | undefined;\n        public animation: Animation | undefined;\n        public libId: string = '0';\n        public id: string = '0';\n        protected childrenMap: {[id: string]: DisplayObjectAbstract} = {};\n\n        protected _vfStage: VFStage | undefined;\n        protected pauseData?: {animation: string, frame: number, times: number} = undefined;\n        constructor() {\n            super();\n            this.interactabled = true;\n        }\n\n        public set vfStage(stage: VFStage | undefined) {\n            this._vfStage = stage; \n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.vfStage = stage;\n                    }\n                }\n            }\n        }\n\n        public get vfStage(): VFStage | undefined {\n            return this._vfStage;\n        }\n\n        public pause(): void {\n\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.pause();\n                    }\n                }\n            }\n\n            if (this.animation) {\n                this.pauseData = this.animation.getPauseData();\n                this.animation.stop();\n            }\n            if (this.actionList) {\n                this.actionList.pause();\n            }\n        }\n\n        public resume(): void {\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.resume();\n                    }\n                }\n            }\n            if (this.animation) {\n                if (this.pauseData) {\n                    this.animation.gotoPlay(this.pauseData.animation, this.pauseData.frame, this.pauseData.times);\n                    this.pauseData = undefined;\n                }\n            }\n            if (this.actionList) {\n                this.actionList.resume();\n            }\n            \n        }\n\n        public playDefaultAnimation(): void {\n            if (this.animation) {\n                this.animation.playDefaultAnimation();\n            }\n        }\n        public gotoPlay(name: string, frame: number, times: number = 1): void {\n            if (this.animation) {\n                this.animation.gotoPlay(name, frame, times);\n            }\n        }\n        public gotoStop(name: string, frame: number): void {\n            if (this.animation) {\n                this.animation.gotoStop(name, frame);\n            }\n        }\n        public play(name: string, times: number = 1): void {\n            if (this.animation) {\n                this.animation.play(name, times);\n            }\n        }\n\n        public stop(): void {\n            if (this.animation) {\n                this.animation.stop();\n            }\n        }\n\n        public getChildById(id: string): vf.gui.DisplayObject {\n            return this.childrenMap[id] as vf.gui.DisplayObject;\n        }\n\n        public getVariable(id: string): IVariableData | undefined {\n            if (this._vfStage) {\n                const vm = this._vfStage.variableManager;\n                const variable = vm.getVariable(this.hashCode.toString(), id);\n                return variable;\n            }\n            return undefined;\n        }\n\n        public getVariableValue(id: string): IVariableData | undefined {\n            const variable = this.getVariable(id);\n            if (variable) {\n                return variable.value;\n            }\n            return undefined;\n        }\n\n        public setVariableValue(id: string, value: any): void {\n            const variable = this.getVariable(id);\n            if (variable) {\n                variable.value = value;\n            }\n        }\n\n        public addChildAt<T extends DisplayObjectAbstract>(item: T, index: number): T {\n            // tslint:disable-next-line: no-string-literal\n            const cid = (item as any)['id'];\n            if (this.childrenMap[cid.toString()]) {\n                // throw new Error('duplicate id; ' + cid);\n            } else {\n                this.childrenMap[cid.toString()] = item;\n            }\n            if (item instanceof VFComponent) {\n                item.vfStage = this.vfStage;\n            }\n            const child = super.addChildAt(item, index);\n            if (item instanceof VFComponent) {\n                item.playDefaultAnimation();\n            }\n            return child as any;\n        }\n\n        public removeChild<T extends DisplayObjectAbstract>(UIObject: T): T {\n            // this.vfStage = undefined;\n            // tslint:disable-next-line: no-string-literal\n            const cid = (UIObject as any)['id'];\n            // delete this.childrenMap[cid.toString()];\n            return super.removeChild(UIObject);\n        }\n\n        public runAction(): void {\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.runAction();\n                    }\n                }\n            }\n            if (this.actionList) {\n                this.actionList.run();\n            }\n            this.on(ComponentEvent.Remove, this.onRemoved, this);\n        }\n\n        public emitAddToChildBefore(): void {\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.emitAddToChildBefore();\n                    }\n                }\n            }\n            this.emit(ComponentEvent.Add, this);\n        }\n\n        public emitAddToChild(): void {\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.emitAddToChild();\n                    }\n                }\n            }\n            this.emit(ComponentEvent.Added, this);\n        }\n\n        public emitRemoveToChild(): void {\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.emitRemoveToChild();\n                    }\n                }\n            }\n            this.emit(ComponentEvent.Removed, this);\n        }\n        public emitRemoveToChildBefore(): void {\n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.emitRemoveToChildBefore();\n                    }\n                }\n            }\n            this.emit(ComponentEvent.Remove, this);\n        }\n\n        public dispose(): void {\n            this._vfStage = undefined;\n            this.interactabled = false;\n            if (this.animation) {\n                this.animation.stop();\n            }\n            \n            for ( const id in this.childrenMap) {\n                if (this.childrenMap[id]) {\n                    const child = this.childrenMap[id];\n                    if (child instanceof VFComponent) {\n                        child.dispose();\n                    }\n                }\n            }\n\n            this.releaseAll();\n        }\n\n        private onRemoved(): void {\n            if (this.actionList) {\n                this.actionList.stop();\n            }\n            this.off(ComponentEvent.Remove);\n        }\n        \n}\n\n","import { ContainerTask } from './core/ContainerTask';\nimport { TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { EventType } from '../../event/EventType';\nimport IEvent from '../../event/IEvent';\nimport { IActionAddEventListener } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class AddListenerTask extends ContainerTask {\n        public data: IActionAddEventListener;\n        public eventName: string;\n        public component: VFComponent;\n        protected _component: vf.gui.DisplayObject | undefined;\n        protected _loopComplete: boolean;\n        protected system: boolean;\n        protected global: boolean;\n\n        constructor(component: VFComponent, data: IActionAddEventListener) {\n            super();\n            this.component = component;\n            this._loopComplete = false;\n            this.data = data;\n            this.eventName = data.event;\n            this.system = data.system === true;\n            this.global = data.global === true;\n        }\n    \n        public run() {\n            super.run();\n            \n            this._loopComplete = true;\n            if (this.component) {\n                if (this.loopTask) {\n                    this.loopTask.on(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n                }\n\n                if (this.system) {\n                    const vfStage = (this.component as VFComponent).vfStage;\n                    if (vfStage) {\n                        vfStage.systemEvent.on(this.eventName, this.onTriger, this);\n                    }\n                } else if (this.global) {\n                    const vfStage = (this.component as VFComponent).vfStage;\n                    if (vfStage) {\n                        vfStage.on(this.eventName, this.onTriger, this);\n                    }\n                } else {\n                    this._component = getTargetComponent(this.component, this.data.target);\n                    if (this._component) {\n                        this._component.on(this.eventName, this.onTriger, this);\n                    }\n                }\n            }\n            this.complete();\n        }\n\n    \n        public stop() {\n            this.complete();\n\n            if (this._component) {\n                if (this.system) {\n                    const vfStage = (this._component as VFComponent).vfStage;\n                    if (vfStage) {\n                        vfStage.systemEvent.off(this.eventName, this.onTriger, this);\n                    }\n                } else if (this.global) {\n                    const vfStage = (this._component as VFComponent).vfStage;\n                    if (vfStage) {\n                        vfStage.off(this.eventName, this.onTriger, this);\n                    }\n                } else {\n                    this._component.off(this.eventName, this.onTriger, this);\n                }\n            }\n            if (this.loopTask) {\n                this.loopTask.off(TaskEvent.EVENT_COMPLETE, this.onLoopComplete);\n                this.loopTask.complete();\n            }\n\n            super.stop();\n        }\n        public break() {\n            this.complete();\n            super.break();\n        }\n    \n        protected onLoopComplete() {\n            this._loopComplete = true;\n        }\n\n        protected onSystemTriger(evt: IEvent) {\n            if (evt.code === this.eventName) {\n                this.onTriger();\n            }\n        }\n    \n        protected onTriger() {\n            if (this._isPaused) {\n                return;\n            }\n            if (this.loopTask && this._loopComplete) {\n                this._loopComplete = false;\n                this.loopTask.run();\n            }\n        }    \n    }\n\n","import { BaseTask, TaskEvent } from './BaseTask';\n\nexport class QueueTask extends BaseTask {\n\n        private _tasks: BaseTask[] = [];\n        private _currentTask: BaseTask = null as any;\n        private _curTaskIndex: number = 0;\n\n        constructor() {\n            super();\n        }\n        \n        public get tasks(): BaseTask[] {\n            return this._tasks;\n        }\n\n        public run(): void {\n            if (this.isRunning) {\n                return;\n            }\n            this._curTaskIndex = 0;\n            super.run();\n            this._nextTask();\n        }\n\n        public stop(): void {\n            super.stop();\n\n            if (this._currentTask) {\n                this.clearEvent(this._currentTask);\n                this._currentTask.stop();\n                this._currentTask = null as any;\n            }\n            this._curTaskIndex = Number.MAX_VALUE;\n            this.off(TaskEvent.EVENT_COMPLETE);\n            this.off(TaskEvent.EVENT_BREAK);\n            this.off(TaskEvent.EVENT_FAIL);\n            this.complete();\n        }\n\n        public pause(): void {\n            super.pause();\n            if (this._tasks) {\n                for (let i: number = 0, len: number = this._tasks.length; i < len; i++) {\n                    this._tasks[i].pause();\n                }\n            }\n        }\n\n        public resume(): void {\n            super.resume();\n            if (this._tasks) {\n                for (let i: number = 0, len: number = this._tasks.length; i < len; i++) {\n                    this._tasks[i].resume();\n                }\n            }\n        }\n\n        public break(): void {\n            super.break();\n\n            if (this._currentTask) {\n                this.clearEvent(this._currentTask);\n                this._currentTask.break();\n                this._currentTask = null as any;\n            }\n            this._curTaskIndex = Number.MAX_VALUE;\n            this.off(TaskEvent.EVENT_COMPLETE);\n            this.off(TaskEvent.EVENT_BREAK);\n            this.off(TaskEvent.EVENT_FAIL);\n            this.complete();\n        }\n\n        public addTask(task: BaseTask): BaseTask {\n            if (task) {\n                if (task.asynchronous) {\n                    this._asynchronous = true;\n                }\n                if (this._tasks.indexOf(task) < 0) {\n                    this._tasks.push(task);\n                } else {\n                    throw new Error('duplicate task');\n                }\n            } else {\n                throw new Error('ArgumentError');\n            }\n            return task;\n        }\n        private _nextTask(prevTask?: BaseTask): void {\n\n            let task: BaseTask = null as any;\n            if (this._curTaskIndex < this._tasks.length) {\n                task = this._tasks[this._curTaskIndex];\n            }\n            if (task) {\n                this._currentTask = task;\n                this._currentTask.on(TaskEvent.EVENT_COMPLETE, this.onOneTaskComplete, this);\n                this._currentTask.on(TaskEvent.EVENT_FAIL, this.onOneTaskFail, this);\n                this._currentTask.on(TaskEvent.EVENT_BREAK, this.onOneTaskBreak, this);\n\n                this._currentTask.run();\n            } else {\n                this.complete();\n            }\n        }\n\n        private clearEvent(task: BaseTask): void {\n            if (task) {\n                task.off(TaskEvent.EVENT_COMPLETE, this.onOneTaskComplete, this);\n                task.off(TaskEvent.EVENT_FAIL, this.onOneTaskFail, this);\n                task.off(TaskEvent.EVENT_BREAK, this.onOneTaskBreak, this);\n            }\n        }\n\n        private onOneTaskBreak(data: any): void {\n            if (this._currentTask) {\n                this.clearEvent(this._currentTask);\n                this.emit(TaskEvent.EVENT_BREAK);\n                this.complete();\n            }\n        }\n\n        private onOneTaskFail(data: any): void {\n            if (this._currentTask) {\n                this.clearEvent(this._currentTask);\n                this.fail(data.type, data.data);\n            } else {\n                // debug\n                throw new Error('no task');\n            }\n        }\n\n        private onOneTaskComplete(data: any): void {\n            this.clearEvent(this._currentTask);\n            this._curTaskIndex++;\n            this._nextTask(this._currentTask);\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionSetProperty } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class SetPropertyTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionSetProperty;\n\n        constructor(compontent: VFComponent, data: IActionSetProperty) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            const component = getTargetComponent(this.component, this.data.target);\n            if (component) {\n                (component as any)[this.data.property] = this.getValue();\n            }\n            this.complete();\n        }\n\n        private getValue(): any {\n            if (Array.isArray(this.data.value)) {\n                if (this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    return variableManager.getExpressItemValue(this.component, this.data.value);\n                }\n                \n            } \n            return this.data.value;\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionExpress } from '../model/IVFData';\n\nexport class ExpressTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionExpress;\n\n        constructor(compontent: VFComponent, data: IActionExpress) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component && this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                variableManager.caculateExpress(this.component, this.data.express);\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { ExpressType } from '../model/IVFData';\nimport { QueueTask } from './core/QueueTask';\n\nexport class IfTask extends BaseTask {\n        \n        public component: VFComponent;\n        public conditions: ExpressType[] = [];\n        public conditionsRun: QueueTask[] = [];\n        public elseRun?: QueueTask;\n        private curRun?: QueueTask;\n\n        constructor(compontent: VFComponent) {\n            super();\n            this.component = compontent;\n        }   \n\n        public addCondition(condition: ExpressType, run: QueueTask): void {\n            if (condition && condition.length) {\n                this.conditions.push(condition);\n                this.conditionsRun.push(run);\n            } else {\n                this.addElse(run);\n            }\n        }\n        public addElse(run: QueueTask): void {\n            this.elseRun = run;\n        }\n\n        public run(): void {\n            super.run();\n            this.curRun = this.findTask();\n            if (this.curRun) {\n                this.curRun.on(TaskEvent.EVENT_COMPLETE, this.onTaskComplete, this);\n                this.curRun.on(TaskEvent.EVENT_BREAK, this.onTaskBreak, this);\n                this.curRun.run();\n            } else {\n                this.complete();\n            }\n        }\n        private findTask(): QueueTask | undefined {\n            if (this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                for (let i: number = 0, len: number = this.conditions.length; i < len; i++) {\n                    const condition = this.conditions[i];\n                    const result = variableManager.caculateExpress(this.component, condition);\n                    if (result) {\n                        return this.conditionsRun[i];\n                    }\n                }\n                if (this.elseRun) {\n                    return this.elseRun;\n                }\n            }\n            \n        }\n        private onTaskComplete(data: any): void {\n            if (this.curRun) {\n                this.curRun.off(TaskEvent.EVENT_COMPLETE, this.onTaskComplete, this);\n            }\n            this.complete();\n        }\n        private onTaskBreak(data: any): void {\n            this.break();\n            this.complete();\n        }\n    }\n\n","import { QueueTask } from './QueueTask';\nimport { BaseTask } from './BaseTask';\nimport { ExpressTask } from '../ExpressTask';\nimport { IfTask } from '../IfTask';\nimport { SetPropertyTask } from '../SetPropertyTask';\nimport { PlayAnimationTask } from '../PlayAnimationTask';\nimport { PlaySoundTask } from '../PlaySoundTask';\nimport { CallFunctionTask } from '../CallFunctionTask';\nimport { PrintTask } from '../PrintTask';\nimport { ExpressType, ExpressItem, ExpressItemType } from '../../model/IVFData';\nimport { ForTask } from '../ForTask';\nimport { CallProtoFunctionTask } from '../CallProtoFunctionTask';\nimport { AddListenerTask } from '../AddListenerTask';\nimport { AddListenerCallTask } from '../AddListenerCallTask';\nimport { RemoveListenerTask } from '../RemoveListenerTask';\nimport { EmitEventTask } from '../EmitEventTask';\n\nexport function injectParamsToQueueTask(queue: QueueTask, paramIds: string[]): void {\n    const tasks = queue.tasks;\n    if (tasks) {\n        for (let i: number = 0, len: number = tasks.length; i < len; i++) {\n            injectParamsToTask(tasks[i], paramIds);\n        }\n    }\n}\nfunction injectParamsToTask(task: BaseTask, paramIds: string[]): void {\n    if (task instanceof ExpressTask) {\n        const express = (task).data.express;\n        modifyParamValue(express, paramIds);\n    } else if (task instanceof IfTask) {\n        const conditions = task.conditions;\n        for (let j: number = 0, jlen: number = conditions.length; j < jlen; j++)  {\n            const exp = conditions[j];\n            modifyParamValue(exp, paramIds);\n        }\n        if (task.conditionsRun) {\n            const conditionRun = task.conditionsRun;\n            for (let i: number = 0, len: number = conditionRun.length; i < len; i++) {\n                const oneRun = conditionRun[i];\n                injectParamsToQueueTask(oneRun, paramIds);\n            }\n        }\n        if (task.elseRun) {\n            injectParamsToQueueTask(task.elseRun, paramIds);\n        }\n    } else if (task instanceof SetPropertyTask) {\n        if (task.data.value && Array.isArray(task.data.value)) {\n            modiyExpressItemParamValue(task.data.value, paramIds);\n        }\n    } else if (task instanceof PlayAnimationTask) {\n        if (task.data.name && Array.isArray(task.data.name)) {\n            modiyExpressItemParamValue(task.data.name as any, paramIds);\n        }\n        if (task.data && task.data.target) {\n            modiyExpressItemParamValue(task.data.target, paramIds);\n        }\n    } else if (task instanceof PlaySoundTask) {\n        if (task.soundId && Array.isArray(task.soundId)) {\n            modiyExpressItemParamValue(task.soundId, paramIds);\n        }\n    } else if ( task instanceof CallFunctionTask) {\n        if (task.data && task.data.params) {\n            modifyParamValue(task.data.params, paramIds);\n        }\n        if (task.data && task.data.target) {\n            modiyExpressItemParamValue(task.data.target, paramIds);\n        }\n    } else if ( task instanceof PrintTask) {\n        if (task.data && task.data.value) {\n            modiyExpressItemParamValue(task.data.value, paramIds);\n        }\n    } else if (task instanceof ForTask) {\n        task.injectParams(paramIds);\n    } else if (task instanceof AddListenerTask || \n               task instanceof AddListenerCallTask ||\n               task instanceof RemoveListenerTask ||\n               task instanceof EmitEventTask || \n               task instanceof CallProtoFunctionTask) {\n            \n        if (task.data && task.data.target) {\n            modiyExpressItemParamValue(task.data.target, paramIds);\n        }\n    }\n}\nfunction modifyParamValue(express: ExpressType, paramIds: any[]): void {\n    if (!express || !Array.isArray(express)) {\n        return;\n    }\n    for (let j: number = 0, jlen: number = express.length; j < jlen; j++) { \n        const expressItem = express[j];\n        modiyExpressItemParamValue(expressItem, paramIds);\n    }\n}\nfunction modiyExpressItemParamValue(expressItem: ExpressItem, paramIds: any[]): void {\n    if (expressItem[0] === ExpressItemType.PARAM_VALUE) {\n        const paramIndex = expressItem[1];\n        if (paramIds.length > paramIndex) {\n            expressItem[2] = paramIds[paramIndex];\n        }\n    } else if (expressItem[0] === ExpressItemType.ARRAY_VALUE) {\n        // expressItem 0:type, 1:componentId, 2: variableId, 3: index, 4?: property\n        if (Array.isArray(expressItem[3])) {\n            modiyExpressItemParamValue(expressItem[3], paramIds);\n        }\n    }\n}\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionPlayAnimation } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class PlayAnimationTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionPlayAnimation;\n        protected _component: VFComponent | undefined;\n\n        constructor(compontent: VFComponent, data: IActionPlayAnimation) {\n            super();\n            this.component = compontent;\n            this.data = data;\n            \n        }   \n       \n        public run(): void {\n            super.run();\n            this._component = getTargetComponent(this.component, this.data.target) as VFComponent;\n            const name = this.getValue();\n            const times = this.getTimes();\n            if (this._component && this._component.vfStage) {\n                this._component.play(name, times);\n            }\n            \n            this.complete();\n        }\n\n        private getValue(): any {\n            if (Array.isArray(this.data.name)) {\n                if (this._component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    return variableManager.getExpressItemValue(this._component, this.data.name);\n                }\n                \n            } \n            return this.data.name;\n        }\n        private getTimes(): any {\n            if (Array.isArray(this.data.times)) {\n                if (this._component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    return variableManager.getExpressItemValue(this._component, this.data.times);\n                }\n                \n            } \n            return this.data.times;\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionPlaySound } from '../model/IVFData';\n\nexport class PlaySoundTask extends BaseTask {\n        \n        public component: VFComponent;\n        public soundId: number | any[];\n        public trackId: string = '-1';\n        private data: IActionPlaySound;\n\n        constructor(compontent: VFComponent, soundId: number | any[], trackId?: string, data ?: any) {\n            super();\n            this.component = compontent;\n            this.soundId = soundId;\n            this.data = data;\n            if (trackId) {\n                this.trackId = trackId;\n            }\n            \n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage) {\n                const soundManager = this.component.vfStage.soundManager;\n                const variableManager = this.component.vfStage.variableManager;\n                let soundId: number | undefined;\n                if (Array.isArray(this.soundId)) {\n                    const soundIdVar = variableManager.getExpressItemValue(this.component, this.soundId);\n                    if (soundIdVar && soundIdVar.value !== undefined) {\n                        soundId = soundIdVar.value;\n                    } else {\n                        soundId = soundIdVar;\n                    }\n                } else {\n                    soundId = this.soundId;\n                }\n                if (soundId !== undefined) {\n                    soundManager.playSound(soundId, this.trackId, this.data);\n                }\n                this.complete();\n            } else {\n                this.complete();\n            }\n            \n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport trace from '../../utils/Trace';\nimport { IAction } from '../model/IVFData';\nimport { VFComponent } from '../../display/VFComponent';\n\nexport class PrintTask extends BaseTask {\n        public data: IAction;\n        private component: VFComponent;\n        constructor(component: VFComponent, data: IAction) {\n            super();\n            this.component = component;\n            this.data = data;\n        }\n\n        public run(): void {\n            // mark: 运行日志统一移到日志模块处理\n            if(this.component.vfStage?.config.debug) trace(this.getValue());\n            this.complete();\n        }\n\n        private getValue(): any {\n            if (Array.isArray(this.data.value)) {\n                if (this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    return variableManager.getExpressItemValue(this.component, this.data.value);\n                }\n                \n            } \n            return this.data.value;\n        }\n    }\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionFor, VariableType } from '../model/IVFData';\nimport { ContainerTask } from './core/ContainerTask';\nimport { VariableManager } from '../VariableManager';\nimport { injectParamsToQueueTask } from './core/ActionListUtils';\n\nexport class ForTask extends ContainerTask {\n    \n    public component: VFComponent;\n    public data: IActionFor;\n    private _totalTimes: number = 0;\n    private _curTimes: number = 0;\n    private _paramId: string = '';\n    private _paramIds: string[] = [];\n    constructor(compontent: VFComponent, data: IActionFor) {\n        super();\n        this.component = compontent;\n        this.data = data;\n    }\n\n    public run() {\n        super.run();\n        this._totalTimes = this.getforin();\n        this._curTimes = -1;\n        if (this.loopTask) {\n            this.loopTask.on(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n            this.loopTask.on(TaskEvent.EVENT_FAIL, this.onLoopComplete, this);\n        }\n        this.addParams();\n        this.runFor();\n    }\n\n    public break() {\n        this._isRunning = false;\n        if (this.loopTask) {\n            this.loopTask.stop();\n        }\n        this.complete();\n    }\n    public complete(): void {\n        this.removeParams();\n        super.complete();\n    }\n\n    public injectParams(paramIds: string[]): void {\n        if (paramIds && paramIds.length) {\n            this._paramIds = paramIds;\n        }\n    }\n\n    private runFor(): void {\n        if (this._totalTimes > 0 && this._curTimes < this._totalTimes - 1) {\n            if (this.loopTask) {\n                this._curTimes++;\n                if (this.component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    const paramI = variableManager.getGlobalVariable(this._paramId);\n                    if (paramI) {\n                        paramI.value = this._curTimes;\n                    }\n                }\n                this.loopTask.run();\n            } else {\n                this.complete();\n            }\n        } else {\n            this.complete();\n        }\n    }\n    private getforin(): number {\n        if (this.component.vfStage) {\n            const variableManager = this.component.vfStage.variableManager;\n            const forin = variableManager.getExpressItemValue(this.component, this.data.forin);\n            if (Array.isArray(forin)) {\n                return forin.length;\n            } else {\n                return parseInt(forin, 10);\n            }\n        }\n        return 0;\n    }\n    private onLoopComplete() {\n        this.runFor();\n    }\n    private addParams(): void {\n        if (this.component && this.component.vfStage) {\n            const variableManager = this.component.vfStage.variableManager;\n            const paramValues: any[] = [];\n            const runId = variableManager.getFunctionId();\n            const paramId = runId + '_for';\n            this._paramId = paramId;\n            if (!variableManager.variableMap[VariableManager.GLOBAL_ID]) {\n                variableManager.variableMap[VariableManager.GLOBAL_ID] = {};\n            }\n            variableManager.variableMap[VariableManager.GLOBAL_ID][paramId] = {\n                id: paramId,\n                type: VariableType.OBJECT,\n                value: 0,\n            };\n            ///\n            if (this.loopTask) {\n                const paramIds: string[] = this._paramIds.concat([this._paramId]);\n                injectParamsToQueueTask(this.loopTask, paramIds);\n            }\n        }\n    }\n    private removeParams(): void {\n        if (this.component && this.component.vfStage) {\n            const variableManager = this.component.vfStage.variableManager;\n            const paramId = this._paramId;\n            delete variableManager.variableMap[VariableManager.GLOBAL_ID][paramId];\n        }\n    }\n}\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionPlayAnimation, IActionCallFunction } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class CallProtoFunctionTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionCallFunction;\n\n        constructor(compontent: VFComponent, data: IActionCallFunction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n            \n        }   \n       \n        public get target(): any {\n            return getTargetComponent(this.component, this.data.target);\n        }\n        public run(): void {\n            super.run();\n            if (this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                const runTarget = this.target;\n                let  funName = this.data.name;\n                if (Array.isArray(funName)) {\n                    funName = variableManager.getExpressItemValue(this.component, funName);\n                }\n                const funParam = [];\n                if (this.data.params) {\n                    for (let i: number = 0, len: number = this.data.params.length; i < len; i++) {\n                        const param = variableManager.getExpressItemValue(this.component, this.data.params[i]);\n                        funParam.push(param);\n                    }\n                }\n                if (runTarget && funName && runTarget[funName as string]) {\n                    // tslint:disable-next-line: ban-types\n                    (runTarget[funName as string] as Function).apply(runTarget, funParam);\n                }\n                \n            }\n            \n            this.complete();\n        }\n    }\n\n","/* eslint-disable no-mixed-spaces-and-tabs */\nimport { ContainerTask } from './core/ContainerTask';\nimport { TaskEvent } from './core/BaseTask';\nimport { CallFunctionTask } from './CallFunctionTask';\nimport { ActionType, IActionCallFunction, IActionAddEventListener } from '../model/IVFData';\nimport { VFComponent } from '../../display/VFComponent';\nimport { EventType } from '../../event/EventType';\nimport IEvent from '../../event/IEvent';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\n\nexport class AddListenerCallTask extends ContainerTask {\n    public data: IActionAddEventListener;\n    public component: VFComponent;\n    public eventName: string;\n    public funName: string | undefined;\n    protected _component: vf.gui.DisplayObject | undefined;\n    protected _loopComplete: boolean;\n    protected system: boolean;\n    protected global: boolean;\n    protected runId: number = -1;\n    protected callfun?: CallFunctionTask;\n    protected callfunData?: IActionCallFunction;\n\n    constructor(component: VFComponent, data: IActionAddEventListener) {\n        super();\n        this._loopComplete = false;\n        this.data = data;\n        this.component = component;\n        this.eventName = data.event;\n        this.system = data.system === true;\n        this.global = data.global === true;\n        this.funName = data.funName;\n    }\n\n    public run() {\n        super.run();\n        this._loopComplete = true;\n        if (this.loopTask.tasks.length === 0 && this.component && this.funName) {\n            this.callfunData = {\n                type: ActionType.CallFunction,\n                name: this.funName,\n                params: [],\n            };\n\n            const callfunctionTask: CallFunctionTask = \n                new CallFunctionTask(this.component as any, this.funName, this.callfunData);\n            this.callfun = callfunctionTask;\n            this.loopTask.addTask(callfunctionTask);\n        }\n        if (this.loopTask) {\n            this.loopTask.on(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n        }\n        if (this.component) {\n            if (this.system) {\n                const vfStage = (this.component as VFComponent).vfStage;\n                if (vfStage) {\n                    vfStage.systemEvent.on(this.eventName, this.onTriger, this);\n                }\n            } else if (this.global) {\n                const vfStage = (this.component as VFComponent).vfStage;\n                if (vfStage) {\n                    vfStage.on(this.eventName, this.onTriger, this);\n                }\n            } else {\n                this._component = getTargetComponent(this.component, this.data.target);\n                if (this._component) {\n                    this._component.on(this.eventName, this.onTriger, this);\n                }\n            }\n        }\n        this.complete();\n    }\n\n\n    public stop() {\n        this.complete();\n\n        if (this._component) {\n            if (this.system) {\n                const vfStage = (this._component as VFComponent).vfStage;\n                if (vfStage) {\n                    vfStage.systemEvent.off(this.eventName, this.onTriger, this);\n                }\n            } else if (this.global) {\n                const vfStage = (this._component as VFComponent).vfStage;\n                if (vfStage) {\n                    vfStage.off(this.eventName, this.onTriger, this);\n                }\n            } else {\n                this._component.off(this.eventName, this.onTriger, this);\n            }\n        }\n        if (this.loopTask) {\n            this.loopTask.off(TaskEvent.EVENT_COMPLETE, this.onLoopComplete);\n            this.loopTask.complete();\n        }\n\n        super.stop();\n    }\n    public break() {\n        this.complete();\n        super.break();\n    }\n\n    protected onLoopComplete() {\n        this._loopComplete = true;\n    }\n    \n    protected onSystemTriger(evt: IEvent) {\n        if (evt.code === this.eventName) {\n            this.onTriger(evt);\n        }\n    }\n\n    protected onTriger(...params: any) {\n        if (this._isPaused) {\n            return;\n        }\n        if (params && params.length > 0 && this.callfunData) {\n            this.callfunData.params = params;\n        }\n        if (this.loopTask && this._loopComplete) {\n            this._loopComplete = false;\n            this.loopTask.run();\n        }\n    }   \n}\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionAddEventListener } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\n\nexport class RemoveListenerTask extends BaseTask {\n        public data: IActionAddEventListener;\n        public eventName: string;\n        public component: VFComponent;\n        protected _component: vf.gui.DisplayObject | undefined;\n        protected _loopComplete: boolean;\n        protected system: boolean;\n        protected global: boolean;\n\n        constructor(component: VFComponent, data: IActionAddEventListener) {\n            super();\n            this._loopComplete = false;\n            this.component = component;\n            this.data = data;\n            this.eventName = data.event;\n            this.system = data.system === true;\n            this.global = data.global === true;\n        }\n    \n        public run() {\n            super.run();\n            if (this.component) {\n                if (this.system) {\n                    const vfStage = (this.component as VFComponent).vfStage;\n                    if (vfStage) {\n                        vfStage.systemEvent.off(this.eventName);\n                    }\n                } else if (this.global) {\n                    const vfStage = (this.component as VFComponent).vfStage;\n                    if (vfStage) {\n                        vfStage.off(this.eventName);\n                    }\n                } else {\n                    this._component = getTargetComponent(this.component, this.data.target);\n                    if (this._component) {\n                        this._component.off(this.eventName);\n                    }\n                }\n            }\n            this.complete();\n        }   \n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { EventType } from '../../event/EventType';\nimport IEvent from '../../event/IEvent';\nimport { EventLevel } from '../../event/EventLevel';\nimport { IActionEmitEvent } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class EmitEventTask extends BaseTask {\n        public data: IActionEmitEvent;\n        public eventName: string;\n        public eventData: any;\n\n        protected target: vf.utils.EventEmitter | undefined;\n        protected component: VFComponent;\n        protected system: boolean;\n        protected global: boolean;\n\n\n        constructor(component: VFComponent, data: IActionEmitEvent) {\n            super();\n            this.component = component;\n            this.data = data;\n            this.eventName = data.event;\n            this.eventData = data.eventData;\n            this.system = data.system === true;\n            this.global = data.global === true;\n        }\n    \n        public run() {\n            super.run();\n            const {component} = this;\n            if (component) {\n                const emitEventData = this.getEmitEventData();\n                if (this.system) {\n                    if (component.vfStage ){\n                        const systemEvent = component.vfStage.systemEvent;\n                        if (typeof emitEventData === 'object') {\n                            (emitEventData as IEvent).type = this.eventName;\n                            if (this.eventName !== EventType.MESSAGE) {\n                                systemEvent.emit(this.eventName, emitEventData);\n                            }\n                            systemEvent.emit(EventType.MESSAGE, emitEventData); // 外部 \n                        } else {\n                            systemEvent.emitError('S0003', [this.eventName, \n                                                            JSON.stringify(emitEventData)], EventLevel.WARNING, this);\n                        }\n                    }\n                } else if (this.global) {\n                    if (component.vfStage) {\n                        component.vfStage.emit(this.eventName, emitEventData);\n                    }\n                } else {\n                    this.target = getTargetComponent(this.component, this.data.target);\n                    if (this.target) {\n                        this.target.emit(this.eventName, emitEventData);\n                    }\n                    \n                }\n            }\n            this.complete();\n        }\n\n        public stop() {\n            this.complete();\n            super.stop();\n        }\n        public break() {\n            this.complete();\n            super.break();\n        }\n        private getEmitEventData(): any {\n            if (Array.isArray(this.eventData)) {\n                if (this.component) {\n                    const vfStage = (this.component).vfStage;\n                    if (vfStage) {\n                        const data = vfStage.variableManager.getExpressItemValue(this.component, this.eventData);\n                        return data;\n                    }\n                }\n            }\n            return this.eventData;\n        }\n    }\n\n","import { Timeline } from './Timeline';\nimport { IEventData } from '../model/IVFData';\nimport { EventFrame } from './EventFrame';\n\nexport class EventTimeline extends Timeline<IEventData[]> {\n    \n    private nextFrame?: EventFrame;\n    private nextFrameIndex: number = 0;\n    private skipEmit: boolean = false;\n    constructor() {\n        super();\n        this._curValue = [];\n    }\n\n    public skipNextEmit(): void {\n        //\n        this.lastTime = 0;\n        this.nextFrame = undefined;\n    }\n\n    protected getProgress(cur: number, min: number, max: number, curve: number[] | null = null): number {\n        return cur;\n    }\n\n    protected updateCurFrame(): void {\n        if (this.frames.length === 0) {\n            return;\n        }\n    }\n    protected updateCurValue(): void {\n        this._curValue.length = 0;\n        if (this.frames.length === 0) {\n            return;\n        }\n        if (this.nextFrame === undefined) {\n            this.nextFrame = this.frames[0];\n            this.nextFrameIndex = 0;\n        }\n        \n        if (this.curTime >= this.lastTime) {\n            if (this.curTime > this.nextFrame.time) {\n                this.findEvents(this.nextFrameIndex, false);\n            }\n        } else {\n            this.findEvents(0, true);\n        }\n    }\n\n    private findEvents(startIndex: number, turnBack: boolean = false): void {\n        if (turnBack) {\n            for (let i = this.nextFrameIndex, len: number = this.frames.length; i < len; i++) {\n                const frame = this.frames[i];\n                this.addEvent(frame);\n            }\n        }\n        for (let i = startIndex, len: number = this.frames.length; i < len; i++) {\n            const frame = this.frames[i];\n            if (frame.time < this.curTime && (turnBack || frame.time >= this.lastTime) ) {\n                this.addEvent(frame);\n            } else if (frame.time > this.curTime) {\n                this.nextFrame = frame;\n                this.nextFrameIndex = i;\n                break;\n            }\n            this.nextFrameIndex = Number.MAX_VALUE;\n        }\n    }\n    private addEvent(frame: EventFrame): void {\n        if (frame.value) {\n            for (let j: number = 0, jlen: number = frame.value.length; j < jlen; j++) {\n                this._curValue.push(frame.value[j]);\n            }\n        }\n    }\n}\n","import { TimelineType } from '../model/IVFData';\nimport { Frame } from './Frame';\nimport { getCurveProgress } from '../../utils/VFUtil';\n\nexport class Timeline<T> {\n\n        public set defaultValue(value: T) {\n            this._defaultValue = value;\n            this._curValue = value;\n        }\n        public get curValue(): T {\n            return this._curValue;\n        }\n\n        public set globalTime(v: number) {\n            this._globalTime = v;\n            this.tick();\n            this._lastGlobalTime = v;\n        }\n\n        public type: TimelineType = null as any;\n        public frames: Array<Frame<T>> = [];\n        public curTime: number = 0;\n        public lastTime: number = 0;\n        public loop: boolean = false;\n        public totalTime: number = 0;\n        protected _defaultValue: T = null as any;\n        protected _globalTime: number = 0;\n\n        protected _lastGlobalTime: number = 0; \n        protected _lastFrame: Frame<T> | null = null as any;\n        protected _curFrame: Frame<T> | null = null;\n        protected _nextFrame: Frame<T> = null as any;\n        protected _times: number = -1;\n\n        protected _curValue: T = null as any;\n\n        constructor() {\n            //\n        }\n\n        protected getProgress(cur: number, min: number, max: number, curve: number[] | null = null): number {\n            let lineProgress: number = 0;\n            let curveProgress: number = 0;\n            if (max === min) {\n                lineProgress =  0;\n            } else {\n                lineProgress =  (cur - min) / (max - min);\n            }\n            curveProgress = lineProgress;\n            if (curve && curve.length) {\n                if (curve.length === 1) {\n                    const curveType = curve[0];\n                    curveProgress = getCurveProgress(curveType, lineProgress);\n                }\n                // todo bezier\n            }\n            return curveProgress;\n        }\n\n        protected tick(): void {\n            this.curTime = this._globalTime;\n            if (this.loop) {\n                this._times = Math.floor(this.curTime / this.totalTime);\n                this.curTime = this.curTime - this.totalTime * this._times;\n            }\n            this.updateCurFrame();\n            this.updateCurValue();\n            this.lastTime = this.curTime;\n        }\n        protected updateCurFrame(): void {\n            if (this.frames.length === 0) {\n                return;\n            }\n            this._lastFrame = this._curFrame;\n            let i: number = 0;\n            let len: number = 0;\n            for (i = 0, len = this.frames.length; i < len; i++) {\n                if (this.frames[i].time > this.curTime) {\n                    if (i === 0) {\n                        this._curFrame = null;\n                        this._nextFrame = this.frames[i];\n                    } else {\n                        this._curFrame = this.frames[i - 1];\n                        this._nextFrame = this.frames[i];\n                    }\n                    return;\n                }\n            }\n            this._curFrame = this.frames[this.frames.length - 1];\n            this._nextFrame = this._curFrame;\n        }\n\n        protected updateCurValue(): void {\n            if (this._curFrame && this._nextFrame) {\n                const p = this.getProgress(this.curTime, this._curFrame.time, \n                                           this._nextFrame.time, this._curFrame.curve);\n\n                this._curValue = this._curFrame.getValue(p, this._nextFrame.value);\n            }\n        }\n    }\n\n","import {AssetsType} from './IAssets'; \n// import * as IRES from './IRES';\n// import readFileSync from '../../src/utils/readFileSync';\n\nexport function getAssetType(extensionName:string){\n    switch(extensionName){\n        case 'gif':\n        case 'png':\n        case 'bmp':\n        case 'jpg':\n        case 'jpeg':\n        case 'tif':\n        case 'tiff':\n        case 'webp':\n        case 'tga':\n        case 'svg':\n        case 'svg+xml':\n            return AssetsType.Image;\n        case 'mp3':\n        case 'ogg':\n        case 'wav':\n            return AssetsType.Audio;\n        case 'mp4':\n        case 'webm':\n        case 'mov':   \n            return AssetsType.Video;\n        case 'json':\n            return AssetsType.Json;\n        default:\n            return AssetsType.Unknown;\n\n    }\n}\n// export class RES{\n\n//     private _defaultCdn:string[] = [];\n//     private _tempAnchor: HTMLAnchorElement | null = null;\n//     private _loadStrategyMap: Partial<Record<string, AbstractLoadStrategyCtor>> = {\n//         // images\n//         gif:        ImageLoadStrategy,\n//         png:        ImageLoadStrategy,\n//         bmp:        ImageLoadStrategy,\n//         jpg:        ImageLoadStrategy,\n//         jpeg:       ImageLoadStrategy,\n//         tif:        ImageLoadStrategy,\n//         tiff:       ImageLoadStrategy,\n//         webp:       ImageLoadStrategy,\n//         tga:        ImageLoadStrategy,\n//         svg:        ImageLoadStrategy,\n//         'svg+xml':  ImageLoadStrategy, // for SVG data urls\n\n//         // audio\n//         mp3:        AudioLoadStrategy,\n//         ogg:        AudioLoadStrategy,\n//         wav:        AudioLoadStrategy,\n\n//         // videos\n//         mp4:        VideoLoadStrategy,\n//         webm:       VideoLoadStrategy,\n//         mov:        VideoLoadStrategy,\n//     }\n\n//     public async getRes<K extends keyof XMLHttpRequestEventTargetEventMap>(url: string, options: Options = {}, listener?: Array<[ K , (this: XMLHttpRequestEventTarget, ev: XMLHttpRequestEventTargetEventMap[K]) => any]>): Promise < any > {\n//         const cdns = this._defaultCdn;\n//         for (const value of cdns) {\n//             const data = await readFileSync( (value || '') + url, options, listener);\n//             if (data) {\n//                 return data;\n//             }\n//         }\n//         return;\n//     }\n    \n\n// }","/* eslint-disable no-unused-vars */\n/* eslint-disable no-prototype-builtins */\nimport { EventLevel } from '../event/EventLevel';\nimport { getUrl } from './getUrl';\nimport { CDN } from '../core/model/IVFData';\n\nfunction checkModule() {\n\n    const w = window as any;\n    if(w.require === undefined){\n        w.require = function(){};\n    }\n    if(w.exports === undefined){\n        w.exports = {};\n    }\n    if(w.module === undefined){\n        w.module = {};\n    }\n    if(w.module.exports === undefined){\n        w.module.exports = {};\n    }\n}\n\n/**\n * 加载script js 或js模块\n * 1. 支持普通的全局js加载，常规script标签方式引入\n * 2. 支持通过 “tsc xxx.ts -m umd” 编译生成的文件动态加载 \n * \n * @param url url地址\n * @param moduleName 模块名，可加载umd模块，访问形式为gui.moduleName\n * \n * @example \n * let Cls = await importScript('http://127.0.0.1:5501/dist/test2.js',\"Test\");\n * let text = new Cls(); //或 let text = new vf.gui.Test();\n * \n */\nexport default async function importScript(url: string, cdns?: CDN, moduleName?: string, loadCompleteCallBack?: Function): Promise<boolean | any> {\n\n\n    checkModule();\n\n    const _namespace = vf.gui as any;\n    if (moduleName && _namespace[moduleName]) {\n        return _namespace[moduleName];\n    }\n\n    let errorUrls: any[] = [];\n\n    return new Promise((resolve, reject) => {\n\n        let errorLoadCount = 0;\n\n        const loadScript = function (index: number) {\n            let s = document.createElement('script');\n            s.async = false;\n            s.src = index === 0 ? url : getUrl(url, '', cdns, index - 1);\n            s.addEventListener('load', loadComplete, false);\n            s.addEventListener('error', loadError, false);\n            document.body.appendChild(s);\n        };\n\n        const loadComplete = function (this: HTMLScriptElement, e: Event) {\n            removeEvent(this);\n            if (loadCompleteCallBack) {\n                loadCompleteCallBack();\n            }\n            if(moduleName){\n                const w = window as any;\n                const exports = w.module.exports;\n                if(exports.hasOwnProperty(moduleName)){\n                    _namespace[moduleName] = exports[moduleName];\n                    return resolve(_namespace[moduleName]);\n                }\n                return resolve(false);\n            }\n            resolve(true);\n        };\n        const loadError = function (this: HTMLScriptElement, e: Event) {\n            removeEvent(this);\n            if (errorLoadCount > 3) {\n                reject({ code: '404', level: EventLevel.ERROR, data: [errorUrls.join('\\n')] });\n            } else {\n                if (errorUrls.indexOf(this.src) === -1) {\n                    errorUrls.push(this.src);\n                }\n                loadScript(1);\n                errorLoadCount++;\n            }\n        };\n        const removeEvent = function (thisObj: any) {\n            thisObj.parentNode.removeChild(thisObj);\n            thisObj.removeEventListener('load', loadComplete, false);\n            thisObj.removeEventListener('error', loadError, false);\n        };\n\n        loadScript(0);\n    });\n}\n","import { getFileExtension } from \"./getFileExtension\";\nimport { getAssetType } from \"../../../assets/Assets\";\nimport { CDN } from \"../core/model/IVFData\";\nimport { AssetsType } from \"../../../assets/IAssets\";\n\nexport function getUrl(url: string, baseUrl = '', cdns?: CDN, index = 0) {\n\n    if (baseUrl !== '') {\n        if (url.indexOf('http') === -1 && url.indexOf('//') === -1) {\n            url = baseUrl + url;\n        }\n    }\n    if (cdns) {\n        url = getCdnUrl(url, cdns, index);\n    }\n    return url;\n}\n\nexport function getCdnUrl(url: string, cdns: CDN, index = 0) {\n    if (url.indexOf('data:') === 0) {\n        return url;\n    }\n    const type = getAssetType(getFileExtension(url));\n    let cdn: string[] | string;\n    switch (type) {\n        case AssetsType.Image:\n            cdn = cdns.image;\n            break;\n        case AssetsType.Audio:\n        case AssetsType.Video:\n            cdn = cdns.media;\n            break;\n        default:\n            cdn = cdns.default;\n    }\n    cdn = cdn[Math.max(index, cdn.length - 1) % cdn.length];\n    if (url.indexOf('http') !== -1 || url.indexOf('//') === 0) {\n        cdn += url.substr(url.indexOf('/', url.indexOf('.')));\n    } else {\n        cdn += url;\n    }\n    return cdn;\n}\n","import { IPlug } from './IPlug';\nimport { VFStage } from '../VFStage';\nimport { VFStateCode } from '../../core/model/IVFData';\n\n/** \n * 基于接口的抽象实现\n * @author yangxiao\n */\nexport class Plug implements IPlug {\n\n    public id: string;\n    public parent: VFStage;\n    public status: VFStateCode;\n\n    constructor(className: string, parent: VFStage) {\n        this.id = className;\n        this.parent = parent;\n        this.status = VFStateCode.INIT;\n    }\n\n    public load(data: any) {\n        if (this.status !== VFStateCode.INIT) {\n            return;\n        }\n        this.onLoad(data);\n        this.status = VFStateCode.READY;\n        this.parent.plugs.set(this.id, this);\n        return this;\n    }\n\n    public release() {\n        if (this.status === VFStateCode.INIT) {\n            return;\n        }\n        this.onRelease();\n        this.parent.plugs.delete(this.id);\n        this.parent = null as any;\n        this.status = VFStateCode.INIT;\n    }\n\n    /**\n     * 子类实现\n     */\n    protected onLoad(data: any) {\n        //\n    }\n    \n    /**\n     * 子类实现\n     */\n    protected onRelease() {\n        //\n    }\n\n}\n","import { EventLevel } from \"../event/EventLevel\";\nimport IEvent from \"../event/IEvent\";\n\nexport interface Options {\n    timeout?: number;\n    responseType?: \"\" | \"arraybuffer\" | \"blob\" | \"json\" | \"text\";\n    method?: 'GET' | 'POST';\n    errorCount?: number;\n}\n\nfunction parseJson(text: any, result:IEvent):IEvent{\n\n    try{\n        result.data = ((typeof text) === 'string') ? JSON.parse(text) : text;\n        return result;\n    }\n    catch (e){\n        result.code = 'S0000';\n        result.level = EventLevel.ERROR;\n        result.data = e;\n        return result;\n    }\n}\n\nfunction geXHRtData(target: XMLHttpRequest) {\n    const xhr = target;\n    \n    if (xhr.readyState === 4 && xhr.status >= 400) { return; }\n\n    const msg :IEvent = {\n        code: '0',\n        level: EventLevel.COMMAND,\n        message: undefined,\n        data:null\n    };\n\n    try {\n        const response = xhr.response || xhr.responseText;\n\n        switch (xhr.responseType) {\n            case 'json':\n                parseJson(response,msg);\n                break;\n            default:\n                msg.data = response;\n        }\n    \n        return msg;\n\n    } catch (error) {\n        msg.code = 'S0002';\n        msg.level = EventLevel.ERROR;\n        msg.data = xhr.responseURL +' , '+ error;\n        return msg;\n    }\n\n}\n\n// tslint:disable-next-line: max-line-length\nfunction removeEventListener<K extends keyof XMLHttpRequestEventTargetEventMap>(xhr: XMLHttpRequest, listener?: Array<[ K , (this: XMLHttpRequestEventTarget, ev: XMLHttpRequestEventTargetEventMap[K]) => any]>){\n    if (listener) {\n        listener.forEach((value) => {\n            xhr.removeEventListener(value[0], value[1]);\n        });\n        listener.length = 0;\n    }\n    xhr.onload = null;\n    xhr.onerror = null;\n    xhr.onreadystatechange = null;\n}\n\n/**\n * 赌球文件\n * @param url 文件路径\n * @param cdns  CDN路径 ，如果设置CDN，最终的地址为 cdn + url\n * @param options 选项\n * @param listener 可选监听\n * @example \n * const data = await readFileSyncExt('assets/xxx.mp3', []).catch(value=>{console.log(value)});\n */\n// tslint:disable-next-line: max-line-length\nexport async function readFileSyncExt<K extends keyof XMLHttpRequestEventTargetEventMap>(url: string, cdns: string[], options: Options = {}, listener?: Array<[ K , (this: XMLHttpRequestEventTarget, ev: XMLHttpRequestEventTargetEventMap[K]) => any]>): Promise < any > {\n    if (cdns.length === 0) {\n        return await readFileSync(url, options, listener);\n    }\n    \n    let err: any;\n    for (const value of cdns) {\n        const data = await readFileSync( (value || '') + url, options, listener).catch((error:IEvent)=>{ err = error});\n        if (data) {\n            return data;\n        }\n    }\n    return new Promise((resolve, reject) => {reject(err)});;\n}\n/**\n * 读取文件\n * @param url 文件路径\n * @param options 文件配置\n * @param listener 监听回调\n */\n// tslint:disable-next-line: max-line-length\nexport default function readFileSync<K extends keyof XMLHttpRequestEventTargetEventMap>(url: string, options: Options = {}, listener?: Array<[ K , (this: XMLHttpRequestEventTarget, ev: XMLHttpRequestEventTargetEventMap[K]) => any]>): Promise < any > {\n\n    return new Promise<any>((resolve, reject) => {\n\n        const errorCount = {cur:0,max:options.errorCount || 1}\n        const xhr = new XMLHttpRequest();\n        \n        const method = options.method || 'GET';\n        xhr.timeout = options.timeout || 0;\n        xhr.responseType = options.responseType || 'text';\n\n        if (listener) {\n            listener.forEach((value) => {\n                xhr.addEventListener(value[0], value[1]);\n            });\n        }\n        \n        xhr.onload = (evt: ProgressEvent) => {\n            const msg = geXHRtData(evt.target as XMLHttpRequest);\n            if (msg) {\n                if(msg.level === EventLevel.ERROR){\n                    return reject(msg);\n                }else{\n                    removeEventListener(xhr, listener);\n                    return resolve(msg.data);\n                }\n            }\n        };\n\n        xhr.onreadystatechange = (evt: Event) => {\n            const xhr = evt.currentTarget as XMLHttpRequest;\n            if ((xhr.readyState === 2 || xhr.readyState === 4) && xhr.status >= 400) {\n                if (errorCount.cur >= errorCount.max) {\n                    removeEventListener(xhr, listener);  \n                    return reject({code: 'S0001',level: EventLevel.ERROR,data: [xhr.responseURL,xhr.status],});\n                }\n                errorCount.cur++;\n                xhr.abort();\n                xhr.open(method, url,true);\n                xhr.send();\n            } \n        };\n\n        xhr.onerror = (evt: Event) => {\n            const xhr = evt.currentTarget as XMLHttpRequest;\n            if (errorCount.cur >= errorCount.max) {\n                removeEventListener(xhr, listener);  \n                return reject({code: 'S0001',level: EventLevel.ERROR,data: [xhr.responseURL,xhr.status],});\n            }\n            errorCount.cur++;\n            xhr.abort();\n            xhr.open(method, url,true);\n            xhr.send();\n        };\n\n        xhr.open(method, url,true);\n        xhr.send();\n    });\n}\n\n","export * from './Player';\n\nconst w = (window as any);\n\nif (w.vf === undefined) {\n    w.vf = {};\n}\nw.vf.player = this;\n","import { ITransitionData, IVFDataV1, SceneEvent, VFStateCode } from '../core/model/IVFData';\nimport { VariableManager } from '../core/VariableManager';\nimport { SoundManager } from '../sound/SoundManager';\nimport { VFScene } from './VFScene';\nimport { RES } from '../core/RES';\nimport { renderTexture, applyTransition } from '../utils/VFUtil';\nimport Config from '../core/Config';\nimport * as Plugs from './plugs/PlugIndex';\nimport { IPlug } from './plugs/IPlug';\nimport { EventLevel } from '../event/EventLevel';\nimport { EventType } from '../event/EventType';\nimport { Player } from '../Player';\nimport IEvent from '../event/IEvent';\n\nenum STAGE_STATUS {\n    NONE,\n    LOADING,\n    READY,\n    PLAYING,\n    PAUSED,\n    STOP,\n}\n\nexport class VFStage extends vf.gui.Stage {\n\n    public variableManager: VariableManager;\n    public soundManager: SoundManager;\n    public tween: vf.gui.Tween;\n    public fps: number = 30;\n    public readonly config: Config;\n    public readonly player:Player;\n    /**\n     * 插件列表 \n     */\n    public readonly plugs = new Map<string, IPlug>();\n    //\n    private data: IVFDataV1;\n    private curScene?: VFScene;\n    private status: STAGE_STATUS = STAGE_STATUS.NONE;\n\n    private res: RES;\n\n\n    constructor(data: IVFDataV1, config: Config, player:Player) {\n        super(config.width, config.height);\n        this.data = data;\n        this.width = config.width;\n        this.height = config.height;\n        this.config = config; \n        this.player = player;\n        vf.gui.Utils.debug = config.debug;\n        // 配置数据后，创建各种管理器\n        this.res = new RES(this);\n        this.variableManager = new VariableManager();\n        this.soundManager = new SoundManager(this.res, this);\n        this.tween = new vf.gui.Tween();\n        // tslint:disable-next-line: no-unused-expression\n        new Plugs.PlugIndex();\n    }\n\n    public get systemEvent() {\n       return this.config.systemEvent;\n    }\n\n    /**\n     * 即使没有引用也不要删除这个接口，GUI在调用\n     * @param msg \n     */\n    public inputLog(msg: IEvent){\n        if(msg.message === undefined){\n            msg.message = '';\n        }\n        if(msg.target && msg.target['libId']){\n            msg.message +=  `, id = ${ msg.target['id']} , libId = ${ msg.target['libId']}`;\n        }\n        this.player.runtimeLog(msg);\n    }\n\n    public start(): void {\n\n        if (this.app) {\n            this.app.ticker.add(this.onGUITickerUpdata, this);\n        }\n        \n        // TODO: 适配\n        // 初始化加载界面\n        this.status = STAGE_STATUS.LOADING;\n        this.res.on(SceneEvent.LoadComplete, this.loadAssetCompleted, this);\n        this.res.on(SceneEvent.LoadProgress, this.loadProgress, this);\n        // 开始加载\n        this.res.loadData(this.data);\n    }\n    public pause(): void {\n        if (this.curScene) {\n            this.status = STAGE_STATUS.PAUSED;\n            this.curScene.pause();\n            this.soundManager.pause();\n        }\n    }\n    public resume(): void {\n        if (this.curScene) {\n            this.curScene.resume();\n            this.soundManager.resume();\n            this.status = STAGE_STATUS.PLAYING;\n        }\n\n    }\n    public reset(): void {\n        if (this.status === STAGE_STATUS.NONE ||\n            this.status === STAGE_STATUS.LOADING) {\n            return;\n        }\n        if (this.curScene) {\n            this.curScene.dispose();\n            this.curScene = undefined;\n        }\n        this.variableManager.clear();\n        this.soundManager.clear();\n        this.createScene();\n    }\n    public dispose(): void {\n\n        this.releaseAll();\n        \n        if (this.curScene) {\n            this.curScene.dispose();\n        }\n        if (this.tween) {\n            this.tween.release();\n        }\n        \n        // this.removeChildren();\n\n        if (this.app && this.app.ticker) {\n            this.app.ticker.remove(this.onGUITickerUpdata, this);\n            this.app.ticker.stop();\n            // this.app.ticker.destroy();\n        }\n        if (this.res) {\n            this.res.off(SceneEvent.LoadComplete, this.loadAssetCompleted, this);\n            this.res.off(SceneEvent.LoadProgress, this.loadProgress, this);\n            this.res.destroy();\n            this.res = null as any;\n        }\n        this.plugs.forEach((value) => {\n            value.release();  \n        });\n    }\n\n    /** 获取当前的场景 */\n    public getCurScene() {\n        return this.curScene;\n    }\n\n    public switchToNextScene(transition?: ITransitionData): void {\n        if (this.curScene) {\n            const curSceneId = this.curScene.id;\n            const nextScene = this.res.createNextScene(curSceneId, this);\n            if (nextScene) {\n                this.switchToScene(nextScene, transition);\n            }\n        }\n    }\n\n    public switchToPrevScene(transition?: ITransitionData): void {\n        if (this.curScene) {\n            const curSceneId = this.curScene.id;\n            const prevScene = this.res.createPrevScene(curSceneId, this);\n            if (prevScene) {\n                this.switchToScene(prevScene, transition);\n            }\n        }\n    }\n\n    public switchToSceneId(sceneId: string, transition?: ITransitionData): void {\n        const scene = this.res.createScene(sceneId, this);\n        if (scene) {\n            this.switchToScene(scene, transition);\n        }\n    }\n\n    private switchToScene(scene: VFScene, transition?: ITransitionData): void {\n        if (scene && this.app) {\n            let transitionData = transition;\n            let prevTexture: vf.RenderTexture | undefined;\n            if (this.curScene) {\n                if (this.curScene.transition || transitionData) {\n                    if (transitionData == null) {\n                        transitionData = this.curScene.transition;\n                    }\n                    prevTexture = renderTexture(this.app, this.container, this.container.width, this.container.height);\n                }\n                this.removeChild(this.curScene);\n                this.curScene.dispose();\n            }\n            this.curScene = scene;\n            this.curScene.width = this.width;\n            this.curScene.height = this.height;\n            this.addChild(scene);\n            if (transitionData && prevTexture) {\n                applyTransition(this, prevTexture, transitionData);\n            } else {\n                this.emit(SceneEvent.TransitionStart);\n                this.emit(SceneEvent.TransitionEnd);\n            }\n        }\n    }\n\n    private loadAssetCompleted(e: any): void {\n        this.systemEvent.emit(EventType.STATUS, {\n            code: SceneEvent.LoadComplete, level: EventLevel.STATUS, data: null,\n        });\n        // 加载完毕\n        this.status = STAGE_STATUS.READY;\n        this.createScene();\n        this.createPlugs();\n        this.systemEvent.emit(EventType.STATUS, {\n            code: VFStateCode.SCENE_CREATE, level: EventLevel.STATUS, data: null,\n        });\n    }\n\n    private loadProgress(e: any): void {  \n        this.systemEvent.emit(EventType.STATUS, {\n            code: SceneEvent.LoadProgress, level: EventLevel.STATUS, data: e,\n        });\n    }\n    \n    private createPlugs() {\n        const plugsData =  this.config.plugs;\n        for (const value of plugsData) {\n            const PlugsClass = ((Plugs as any)[value.id]);\n            if (PlugsClass) { \n                const plug: IPlug = new PlugsClass(value.id, this);\n                plug.load(value);\n            }\n\n        }\n    }\n\n    private createScene(): void {\n        // 创建场景\n        const scene = this.res.createFirstScene(this);\n        if (scene) {\n            this.curScene = scene;\n            this.addChild(scene);\n        }\n        this.status = STAGE_STATUS.PLAYING;\n    }\n\n    private onGUITickerUpdata(deltaTime: number) {\n        if (this.app) {\n            vf.gui.TickerShared.update(deltaTime, \n                this.app.ticker.lastTime,\n                this.app.ticker.elapsedMS);\n        }\n        \n    }\n}\n\n","/* eslint-disable no-unused-vars */\nimport {VFStage} from '../../display/VFStage';\nimport { ITransitionData, TransitionType, SceneEvent } from '../model/IVFData';\nimport { ITransition } from './ITransition';\nimport { CrossFadeFilter } from './filters/CrossFadeFilter';\nimport { CircleFadeFilter } from './filters/CircleFadeFilter';\nimport { CrossZoomFilter } from './filters/CrossZoomFilter';\nimport { DoomScreenFilter } from './filters/DoomScreenFilter';\nimport { HeartWipeFilter } from './filters/HeartWipeFilter';\nimport { LinearBlurFilter } from './filters/LinearBlurFilter';\nimport { PageCurlFilter } from './filters/PageCurlFilter';\nimport { ToTearFilter } from './filters/ToTearFilter';\nimport { WindFilter } from './filters/WindFilter';\nimport { PageFlipLeftFilter } from './filters/PageFlipLeftFilter';\nimport { PageFlipRightFilter } from './filters/PageFlipRightFilter';\nimport { FadeoutTran } from './trans/FadeoutTran';\nimport trace from '../../utils/Trace';\nimport { EventType } from '../../event/EventType';\nimport { EventLevel } from '../../event/EventLevel';\n\nexport class Transition {\n\n    private vfStage: VFStage;\n    private prevTexture: vf.RenderTexture;\n    private data: ITransitionData;\n    constructor(vfStage: VFStage, prevTexture: vf.RenderTexture, data: ITransitionData) {\n        this.vfStage = vfStage;\n        this.prevTexture = prevTexture;\n        this.data = data;\n    }\n\n    public run(): void {\n        const transition = this.getTransition(this.data.type);\n        if (transition) {\n            const systemEvent = this.vfStage.systemEvent;\n            transition.setPreviousTexture(this.prevTexture);\n            transition.progress = 0;\n            transition.applyTranisition(this.vfStage.container);\n            const tween = this.vfStage.tween;\n            tween.setObject(transition);\n            tween.once(vf.gui.Tween.Event.complete, () => {\n                transition.dispose();\n                systemEvent.emit(EventType.STATUS, {\n                    code: SceneEvent.TransitionEnd, level: EventLevel.STATUS, data: null,\n                });\n            });\n            tween.to({progress: 1}, this.data.duration).start();\n            systemEvent.emit(EventType.STATUS, {\n                code: SceneEvent.TransitionStart, level: EventLevel.STATUS, data: null,\n            });\n        }\n    }\n\n    private getTransition(type: TransitionType): ITransition | null {\n        if (this.vfStage && (\n            this.vfStage.scaleX !== 1 || this.vfStage.scaleY !== 1 ||\n            !(this.vfStage.app?.renderer.context as any).webGLVersion)) {\n            return new FadeoutTran();\n        }\n        switch (type) {\n            case TransitionType.NONE:\n                return null;\n            case TransitionType.FADE_OUT:\n                return new CrossFadeFilter();\n            case TransitionType.CIRCLE_WIPE:\n                return new CircleFadeFilter();\n            case TransitionType.CROSS_ZOOM:\n                return new CrossZoomFilter();\n            case TransitionType.DOOM_SCREEN:\n                return new DoomScreenFilter();\n            case TransitionType.HEART_WIPE:\n                return new HeartWipeFilter();\n            case TransitionType.LINEAR_BLUR:\n                return new LinearBlurFilter();\n            case TransitionType.PAGE_CURL:\n                return new PageCurlFilter();\n            case TransitionType.TO_TEAR:\n                return new ToTearFilter();\n            case TransitionType.WIND:\n                return new WindFilter();\n            case TransitionType.PAGE_FLIP_LEFT:\n                return new PageFlipLeftFilter();\n            case TransitionType.PAGE_FLIP_RIGHT:\n                return new PageFlipRightFilter();\n            default:\n                return null;\n        }\n        return null;\n    }\n}\n\n","import { AbstractFilter } from './AbstractFilter';\n\nexport class CrossFadeFilter extends AbstractFilter {\n\n        private static readonly fragmentSrc: string = `\n            precision mediump float;\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            varying vec2 vFilterCoord;\n            varying vec2 vTextureCoord;\n            void main()\n            {\n                vec4 col = texture2D(previousTexture, vFilterCoord);\n                vec4 col2 = texture2D(uSampler, vTextureCoord);\n                gl_FragColor = vec4(mix(col, col2, progress));\n            }\n        `;\n\n        constructor() {\n            super('', CrossFadeFilter.fragmentSrc);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\nexport class CircleFadeFilter extends AbstractFilter {\n\n        private static readonly fragmentSrc: string = `\n            precision mediump float;\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n\n            uniform highp vec4 inputSize;\n            uniform highp vec4 outputFrame;\n\n            varying vec2 vFilterCoord;\n            varying vec2 vTextureCoord;\n\n            void main()\n            {\n                float m = outputFrame.z / 2000.0;\n                float t = inputSize.y / inputSize.x;\n                vec2 circle = vFilterCoord - 0.5;\n                circle.y = circle.y * t;\n                float d = length(circle);\n                float p2 = progress * progress;\n                if(d > p2) {\n                    gl_FragColor = texture2D(previousTexture, vFilterCoord);\n                } else {\n                    gl_FragColor = texture2D(uSampler, vTextureCoord);\n                }\n                gl_FragColor = vec4(m, 0.0, 0.0, 1.0);\n            }\n        `;\n\n        constructor() {\n            super('', CircleFadeFilter.fragmentSrc);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface CrossZoomFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n        strength: number;\n    }\n\nexport class CrossZoomFilter extends AbstractFilter {\n\n        private static readonly linearBlurUniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n            strength:        0.4,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            uniform float strength;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float PI = 3.141592653589793;\n            \n            float Linear_ease(in float begin, in float change, in float duration, in float time) {\n                return change * time / duration + begin;\n            }\n            \n            float Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {\n                if (time == 0.0)\n                    return begin;\n                else if (time == duration)\n                    return begin + change;\n                time = time / (duration / 2.0);\n                if (time < 1.0)\n                    return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;\n                return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;\n            }\n            \n            float Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {\n                return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;\n            }\n            \n            float random(in vec3 scale, in float seed) {\n                return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n            }\n            \n            vec3 crossFade(in vec2 uv1, in vec2 uv2, in float dissolve) {\n                return mix(texture2D(previousTexture, uv1).rgb, texture2D(uSampler, uv2).rgb, dissolve);\n            }\n            \n            void main() {\n            \n                vec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);\n                float dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);\n            \n                float strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);\n                \n                vec3 color = vec3(0.0);\n                float total = 0.0;\n                vec2 toCenter = center - vTextureCoord;\n        \n                float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n            \n                for (float t = 0.0; t <= 40.0; t++) {\n                    float percent = (t + offset) / 40.0;\n                    float weight = 4.0 * (percent - percent * percent);\n                    vec2 p = toCenter * percent * strength;\n                    color += crossFade(vFilterCoord + p, vTextureCoord + p, dissolve) * weight;\n                    total += weight;\n                }\n                gl_FragColor = vec4(color / total, 1.0);\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, CrossZoomFilter.fragmentSrc, CrossZoomFilter.linearBlurUniforms);\n        }\n    }\n\n","/* eslint-disable no-unused-vars */\nimport { ITransition } from '../ITransition';\nimport { AbstractFilter } from './AbstractFilter';\n\n\nexport interface DoomScreenFilterUniforms {\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n        barWidth: number;\n        amplitude: number;\n        noise: number;\n        frequency: number;\n    }\n\nexport class DoomScreenFilter extends vf.Filter implements ITransition {\n\n        private static readonly linearblurUniforms = {\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n            barWidth:        10,\n            amplitude:       2.0,\n            noise:           0.1,\n            frequency:       1.0,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            uniform int barWidth;\n            uniform float amplitude;\n            uniform float noise;\n            uniform float frequency;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            float rand(int num) {\n                return fract(mod(float(num) * 67123.313, 12.0) * sin(float(num) * 10.3) * cos(float(num)));\n            }\n            \n            float wave(int num) {\n                float fn = float(num) * frequency * 0.1  * float(barWidth);\n                return cos(fn * 0.5) * cos(fn * 0.13) * sin((fn+10.0) * 0.3) / 2.0 + 0.5;\n            }\n            \n            float pos(int num) {\n                return noise == 0.0 ? wave(num) : mix(wave(num), rand(num), noise);\n            }\n            \n            void main() {\n                int bar = int(vFilterCoord.x) / barWidth;\n                float scale = 1.0 + pos(bar) * amplitude;\n                float phase = progress * scale;\n                float posY = vFilterCoord.y / resolution;\n                vec2 p;\n                vec4 c;\n                if (phase + posY < 1.0) {\n                    p = vec2(vFilterCoord.x, vFilterCoord.y + mix(0.0, resolution, phase)) / resolution;\n                    c = texture2D(previousTexture, p);\n                } else {\n                    p = vTextureCoord.xy / resolution;\n                    c = texture2D(uSampler, p);\n                }\n                gl_FragColor = c;\n            }\n        `;\n\n        private target?: vf.DisplayObject;\n        constructor() {\n            super(AbstractFilter.vertexSrc, DoomScreenFilter.fragmentSrc, DoomScreenFilter.linearblurUniforms);\n            this.padding = 0;\n        }\n\n        /**\n         * @param {vf.FilterManager} filterManager\n         * @param {vf.RenderTarget} input\n         * @param {vf.RenderTarget} output\n         * @override\n         */\n        public apply(filterManager: vf.systems.FilterSystem, input: vf.RenderTexture, output: vf.RenderTexture) {\n            const maskMatrix = new vf.Matrix();\n            // filterManager.calculateNormalizedScreenSpaceMatrix(maskMatrix);\n            this.uniforms.filterMatrix = maskMatrix;\n            this.uniforms.resolution = vf.settings.RESOLUTION;\n            super.apply(filterManager, input, output, vf.CLEAR_MODES.NO);\n        }\n\n        /**\n         * 设置前置纹理\n         * @param value\n         */\n        public setPreviousTexture(value: any): void {\n            this.uniforms.previousTexture = value;\n        }\n\n        /**\n         * 设置变化进度\n         * @param {number} value\n         */\n        public setProgress(value: number): void {\n            value = Math.min(1, value);\n            value = Math.max(0, value);\n            this.uniforms.progress = value;\n        }\n        public set progress(value: number) {\n            value = Math.min(1, value);\n            value = Math.max(0, value);\n            this.uniforms.progress = value;\n        }\n        public get progress(): number {\n            return this.uniforms.progress;\n        }\n\n        public applyTranisition(target: vf.DisplayObject): void {\n            this.target = target;\n            this.target.filters = [this];\n        }\n        public dispose(): void {\n            if (this.target) {\n                this.target.filters = [];\n            }\n        }\n}\n    \n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface HeartWipeFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n        strength: number;\n    }\n\nexport class HeartWipeFilter extends AbstractFilter {\n\n        private static readonly linearBlurUniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            bool inHeart (vec2 p, vec2 center, float size) {\n                if (size == 0.0) return false;\n                vec2 o = (p-center)/(1.6*size);\n                return pow(o.x*o.x+o.y*o.y-0.3, 3.0) < o.x*o.x*pow(o.y, 3.0);\n            }\n            \n            void main() {\n                vec2 p1 = vFilterCoord.xy / resolution;\n                vec2 p2 = vTextureCoord.xy / resolution;\n                float m = inHeart(p1, vec2(0.5, 0.4), progress) ? 1.0 : 0.0;\n                gl_FragColor = mix(texture2D(previousTexture, p1), texture2D(uSampler, p2), m);\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, HeartWipeFilter.fragmentSrc, HeartWipeFilter.linearBlurUniforms);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface LinearBlurFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n        intensity: number;\n    }\n\nexport class LinearBlurFilter extends AbstractFilter {\n\n        private static readonly linearBlurUniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n            intensity:       0.1,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            uniform float intensity;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const int PASSES = 8;\n            \n            void main() {\n                vec2 p1 = vFilterCoord.xy;\n                vec2 p2 = vTextureCoord.xy;\n                vec4 c1 = vec4(0.0), c2 = vec4(0.0);\n                float disp = intensity*(0.5-distance(0.5, progress));\n                for (int xi=0; xi<PASSES; ++xi) {\n                        float x = float(xi) / float(PASSES) - 0.5;\n                    for (int yi=0; yi<PASSES; ++yi) {\n                        float y = float(yi) / float(PASSES) - 0.5;\n                        vec2 v = vec2(x,y);\n                        float d = disp;\n                        c1 += texture2D(previousTexture, p1 + d*v);\n                        c2 += texture2D(uSampler, p2 + d*v);\n                    }\n                }\n                c1 /= float(PASSES*PASSES);\n                c2 /= float(PASSES*PASSES);\n                gl_FragColor = mix(c1, c2, progress);\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, LinearBlurFilter.fragmentSrc, LinearBlurFilter.linearBlurUniforms);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface PageCurlFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n    }\n\nexport class PageCurlFilter extends AbstractFilter {\n\n        private static readonly linearBlurUniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float MIN_AMOUNT = -0.16;\n            const float MAX_AMOUNT = 1.3;\n            float amount = progress * (MAX_AMOUNT - MIN_AMOUNT) + MIN_AMOUNT;\n            \n            const float PI = 3.141592653589793;\n            \n            const float scale = 512.0;\n            const float sharpness = 3.0;\n            \n            float cylinderCenter = amount;\n            float cylinderAngle = 2.0 * PI * amount;\n            \n            const float cylinderRadius = 1.0 / PI / 2.0;\n            \n            vec3 hitPoint(float hitAngle, float yc, vec3 point, mat3 rrotation)\n            {\n                float hitPoint = hitAngle / (2.0 * PI);\n                point.y = hitPoint;\n                return rrotation * point;\n            }\n            \n            vec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n            {\n                distanc *= scale;\n                if (distanc < 0.0) return color2;\n                if (distanc > 2.0) return color1;\n                float dd = pow(1.0 - distanc / 2.0, sharpness);\n                return ((color2 - color1) * dd) + color1;\n            }\n            \n            float distanceToEdge(vec3 point)\n            {\n                float dx = abs(point.x > 0.5 ? 1.0 - point.x : point.x);\n                float dy = abs(point.y > 0.5 ? 1.0 - point.y : point.y);\n                if (point.x < 0.0) dx = -point.x;\n                if (point.x > 1.0) dx = point.x - 1.0;\n                if (point.y < 0.0) dy = -point.y;\n                if (point.y > 1.0) dy = point.y - 1.0;\n                if ((point.x < 0.0 || point.x > 1.0) && (point.y < 0.0 || point.y > 1.0)) {\n                    return sqrt(dx * dx + dy * dy);\n                }\n                return min(dx, dy);\n            }\n            \n            vec4 seeThrough(float yc, vec2 p, mat3 rotation, mat3 rrotation)\n            {\n                float hitAngle = PI - (acos(yc / cylinderRadius) - cylinderAngle);\n                vec3 point = hitPoint(hitAngle, yc, rotation * vec3(p, 1.0), rrotation);\n                if (yc <= 0.0 && (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0))\n                {\n                    return texture2D(uSampler, vTextureCoord);\n                }\n            \n                if (yc > 0.0) return texture2D(previousTexture, p);\n            \n                vec4 color = texture2D(previousTexture, point.xy);\n                vec4 tcolor = vec4(0.0);\n            \n                return antiAlias(color, tcolor, distanceToEdge(point));\n            }\n            \n            vec4 seeThroughWithShadow(float yc, vec2 p, vec3 point, mat3 rotation, mat3 rrotation)\n            {\n                float shadow = distanceToEdge(point) * 30.0;\n                shadow = (1.0 - shadow) / 3.0;\n            \n                if (shadow < 0.0) shadow = 0.0; else shadow *= amount;\n            \n                vec4 shadowColor = seeThrough(yc, p, rotation, rrotation);\n                shadowColor.r -= shadow;\n                shadowColor.g -= shadow;\n                shadowColor.b -= shadow;\n            \n                return shadowColor;\n            }\n            \n            vec4 backside(float yc, vec3 point)\n            {\n                vec4 color = texture2D(previousTexture, point.xy);\n                float gray = (color.r + color.b + color.g) / 15.0;\n                gray += (8.0 / 10.0) * (pow(1.0 - abs(yc / cylinderRadius), 2.0 / 10.0) / 2.0 + (5.0 / 10.0));\n                color.rgb = vec3(gray);\n                return color;\n            }\n            \n            vec4 behindSurface(float yc, vec3 point, mat3 rrotation)\n            {\n                float shado = (1.0 - ((-cylinderRadius - yc) / amount * 7.0)) / 6.0;\n                shado *= 1.0 - abs(point.x - 0.5);\n            \n                yc = (-cylinderRadius - cylinderRadius - yc);\n            \n                float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n                point = hitPoint(hitAngle, yc, point, rrotation);\n            \n                if (yc < 0.0 && point.x >= 0.0 && point.y >= 0.0 && \n                    point.x <= 1.0 && point.y <= 1.0 && (hitAngle < PI || amount > 0.5))\n                {\n                    shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / (71.0 / 100.0));\n                    shado *= pow(-yc / cylinderRadius, 3.0);\n                    shado *= 0.5;\n                }\n                else\n                {\n                    shado = 0.0;\n                }\n                return vec4(texture2D(uSampler, vTextureCoord).rgb - shado, 1.0);\n            }\n            \n            void main()\n            {\n                const float angle = 30.0 * PI / 180.0;\n                float c = cos(-angle);\n                float s = sin(-angle);\n            \n                mat3 rotation = mat3( c, s, 0, -s, c, 0, 0.12, 0.258, 1);\n                c = cos(angle);\n                s = sin(angle);\n            \n                mat3 rrotation = mat3(\tc, s, 0, -s, c, 0, 0.15, -0.5, 1);\n            \n                vec3 point = rotation * vec3(vFilterCoord, 1.0);\n            \n                float yc = point.y - cylinderCenter;\n            \n                if (yc < -cylinderRadius)\n                {\n                    gl_FragColor = behindSurface(yc, point, rrotation);\n                    return;\n                }\n            \n                if (yc > cylinderRadius)\n                {\n                    gl_FragColor = texture2D(previousTexture, vFilterCoord);\n                    return;\n                }\n            \n                float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n            \n                float hitAngleMod = mod(hitAngle, 2.0 * PI);\n                if ((hitAngleMod > PI && amount < 0.5) || (hitAngleMod > PI/2.0 && amount < 0.0))\n                {\n                    gl_FragColor = seeThrough(yc, vFilterCoord, rotation, rrotation);\n                    return;\n                }\n            \n                point = hitPoint(hitAngle, yc, point, rrotation);\n            \n                if (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0)\n                {\n                    gl_FragColor = seeThroughWithShadow(yc, vFilterCoord, point, rotation, rrotation);\n                    return;\n                }\n            \n                vec4 color = backside(yc, point);\n            \n                vec4 otherColor;\n                if (yc < 0.0)\n                {\n                    float shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / 0.71);\n                    shado *= pow(-yc / cylinderRadius, 3.0);\n                    shado *= 0.5;\n                    otherColor = vec4(0.0, 0.0, 0.0, shado);\n                }\n                else\n                {\n                    otherColor = texture2D(previousTexture, vFilterCoord);\n                }\n            \n                color = antiAlias(color, otherColor, cylinderRadius - abs(yc));\n            \n                vec4 cl = seeThroughWithShadow(yc, vFilterCoord, point, rotation, rrotation);\n                float dist = distanceToEdge(point);\n            \n                gl_FragColor = antiAlias(color, cl, dist);\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, PageCurlFilter.fragmentSrc, PageCurlFilter.linearBlurUniforms);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\nexport class ToTearFilter extends AbstractFilter {\n\n        private static readonly fragmentSrc: string = `\n            precision highp float;\n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            \n            void main() {\n                vec4 displacement1 = texture2D( previousTexture, vTextureCoord);\n                vec4 displacement2 = texture2D( uSampler, vFilterCoord);\n                vec4 displacement = mix(displacement1, displacement2, vec4(progress));\n                vec2 mixTexture = mix(displacement.xy, vTextureCoord.xy, vec2(progress));\n                vec2 testPos1 = mixTexture + (1.0 - progress) * displacement.xy * 0.5;\n                vec2 testPos = mix(testPos1, vec2(1.0), vec2(1.0 - progress));\n                vec2 distUv = vec2(testPos.x, vTextureCoord.y);\n                vec4 color = texture2D(uSampler, distUv);\n                vec4 color1 = texture2D(previousTexture, distUv);\n                gl_FragColor = vec4(mix(color, vec4(vec3(color1), 0.0), 0.18));\n            }\n        `;\n\n        constructor() {\n            super('', ToTearFilter.fragmentSrc);\n            this.padding = 0;\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface WindFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n        size: number;\n    }\n\nexport class WindFilter extends AbstractFilter {\n\n        private static readonly linearBlurUniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n            size:            0.2,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            uniform float size;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            float rand (vec2 co) {\n                return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n            }\n            \n            void main() {\n                float r = rand(vec2(0, vTextureCoord.y));\n                float m = smoothstep(0.0, -size, vTextureCoord.x*(1.0-size) + size*r - (progress * (1.0 + size)));\n                gl_FragColor = mix(texture2D(previousTexture, vFilterCoord), texture2D(uSampler, vTextureCoord), m);\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, WindFilter.fragmentSrc, WindFilter.linearBlurUniforms);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface PageFlipFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n    }\n\nexport class PageFlipLeftFilter extends AbstractFilter {\n\n        private static readonly uniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float PI = 3.141592653589793;\n            const float MIN_ANGLE = PI / 4.0;\n            const float MAX_ANGLE = PI / 2.0;\n            const float MIN_X = 0.5;\n            const float MAX_X = 0.95;\n            const float sharpness = 3.0;\n            const float scale = 512.0;\n            // float easeProgress = ( pow((progress - 1.0), 3.0) + 1.0 );\n            // float easeProgress = (progress == 1.0) ? 1.0 : -pow(2.0, -10.0 * progress) + 1.0;\n            float p = progress > 0.99 ? 0.99 : progress;\n            float easeProgress =  sqrt(1.0 - pow((p - 1.0), 2.0));\n            float curX = (1.0 - easeProgress) * (MAX_X - MIN_X) + MIN_X;\n            float angle = (easeProgress) * (MAX_ANGLE - MIN_ANGLE) + MIN_ANGLE;\n                     \n            float distanceToLine(vec2 point)\n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                return abs(a * point.x + b * point.y + c) / sqrt(a * a + b * b);\n            }\n\n            vec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n            {\n                distanc *= scale;\n                if (distanc < 0.0) return color2;\n                if (distanc > 2.0) return color1;\n                float dd = pow(1.0 - distanc / 2.0, sharpness);\n                return ((color2 - color1) * dd) + color1;\n            }\n\n            vec2 getMirro(vec2 point ) \n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2;\n            }\n\n            vec4 curPageBack(vec2 point)\n            {\n                vec2 mirror = getMirro(point);\n                vec4 color = texture2D(uSampler, vec2(1.0 - mirror.x, mirror.y));\n                return color;\n            }\n\n            vec4 curPage(vec2 point)\n            {\n                vec4 color = texture2D(previousTexture, point.xy);\n                return color;\n            }\n            vec4 nextPage(vec2 point)\n            {\n                vec4 color = texture2D(uSampler, point);\n                float d = distanceToLine(point);\n                vec4 shadow = vec4(1.0, 0.0, 0.0, d);\n                if(d < 0.02) {\n                    float c = (0.1 - (0.02 - d)) * (10.0 + progress * 1.5);\n                    return vec4(color.r * c, color.g * c, color.b * c, 1.0);\n                };\n                return color;\n            }\n            bool isNextPage(vec2 point) \n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                vec2 p2 = vec2(point.x - p0.x, point.y - p0.y);\n                vec2 p3 = vec2(point.x - p1.x, point.y - p1.y);\n                return p2.x * p3.y - p3.x * p2.y < 0.0;\n            }\n            bool isCurPageBack(vec2 point)\n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2.x > 0.0 && p2.x < 1.0 && p2.y > 0.0 && p2.y < 1.0;\n            }\n            \n            void main()\n            {\n            \n                vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\n                if (isNextPage(vTextureCoord)) {\n                    color = nextPage(vTextureCoord);\n                } else if (isCurPageBack(vTextureCoord)) {\n                    color = curPageBack(vTextureCoord);\n                } else {\n                    color = curPage(vTextureCoord);\n                }\n                gl_FragColor = color;\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, PageFlipLeftFilter.fragmentSrc, PageFlipLeftFilter.uniforms);\n        }\n    }\n\n","import { AbstractFilter } from './AbstractFilter';\n\n\nexport interface PageFlipRightFilterUniforms {\n        filterMatrix: vf.Matrix;\n        resolution: number;\n        previousTexture: vf.RenderTexture;\n        progress: number;\n    }\n\nexport class PageFlipRightFilter extends AbstractFilter {\n\n        private static readonly uniforms = {\n            filterMatrix:    vf.Matrix.TEMP_MATRIX,\n            resolution:      vf.settings.RESOLUTION,\n            previousTexture: null,\n            progress:        0.0,\n        };\n\n        private static readonly fragmentSrc: string = `\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float PI = 3.141592653589793;\n            const float MIN_ANGLE = PI / 4.0;\n            const float MAX_ANGLE = PI / 2.0;\n            const float MIN_X = 0.5;\n            const float MAX_X = 0.95;\n            const float sharpness = 3.0;\n            const float scale = 512.0;\n\n            // float easeProgress = ( pow((progress - 1.0), 3.0) + 1.0 );\n            // float easeProgress = (progress == 1.0) ? 1.0 : -pow(2.0, -10.0 * progress) + 1.0;\n            float p = progress > 0.99 ? 0.99 : progress;\n            float easeProgress =  sqrt(1.0 - pow((p - 1.0), 2.0));\n            float curX = (1.0 - easeProgress) * (MAX_X - MIN_X) + MIN_X;\n            float angle = (easeProgress) * (MAX_ANGLE - MIN_ANGLE) + MIN_ANGLE;\n                     \n            float distanceToLine(vec2 point)\n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                return abs(a * point.x + b * point.y + c) / sqrt(a * a + b * b);\n            }\n\n            vec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n            {\n                distanc *= scale;\n                if (distanc < 0.0) return color2;\n                if (distanc > 2.0) return color1;\n                float dd = pow(1.0 - distanc / 2.0, sharpness);\n                return ((color2 - color1) * dd) + color1;\n            }\n\n            vec2 getMirro(vec2 point ) \n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2;\n            }\n\n            vec4 curPageBack(vec2 point)\n            {\n                vec2 mirror = getMirro(point);\n                vec4 color = texture2D(uSampler, vec2(1.0 - mirror.x, mirror.y));\n                return color;\n            }\n\n            vec4 curPage(vec2 point)\n            {\n                vec4 color = texture2D(previousTexture, point);\n                float d = distanceToLine(point);\n                vec4 shadow = vec4(1.0, 0.0, 0.0, 1.0);\n                // return shadow;\n                // if(d < 0.2) {\n                //     float c = (0.1 - (0.02 - d)) * (10.0 + progress * 1.5);\n                //     return vec4(color.r * c, color.g * c, color.b * c, 1.0);\n                // };\n                return color;\n            }\n            vec4 nextPage(vec2 point)\n            {\n                vec4 color = texture2D(uSampler, point);\n                float d = distanceToLine(point);\n                vec4 shadow = vec4(1.0, 0.0, 0.0, d);\n                if(d < 0.02) {\n                    float c = (0.1 - (0.02 - d)) * (10.0 + progress * 1.5);\n                    return vec4(color.r * c, color.g * c, color.b * c, 1.0);\n                };\n                return color;\n            }\n            bool isNextPage(vec2 point) \n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                vec2 p2 = vec2(point.x - p0.x, point.y - p0.y);\n                vec2 p3 = vec2(point.x - p1.x, point.y - p1.y);\n                return p2.x * p3.y - p3.x * p2.y > 0.0;\n            }\n            bool isCurPageBack(vec2 point)\n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2.x > 0.0 && p2.x < 1.0 && p2.y > 0.0 && p2.y < 1.0;\n            }\n            \n            \n            void main()\n            {\n            \n                vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\n                if (isNextPage(vTextureCoord)) {\n                    color = nextPage(vTextureCoord);\n                } else if (isCurPageBack(vTextureCoord)) {\n                    color = curPageBack(vTextureCoord);\n                } else {\n                    color = curPage(vTextureCoord);\n                }\n                gl_FragColor = color;\n            }\n        `;\n\n        constructor() {\n            super(AbstractFilter.vertexSrc, PageFlipRightFilter.fragmentSrc, PageFlipRightFilter.uniforms);\n        }\n    }\n\n","import { ITransition } from '../ITransition';\n\nexport class FadeoutTran implements ITransition {\n\n    private prevTexture?: vf.RenderTexture;\n    private target?: vf.DisplayObject;\n    private prevSprite?: vf.Sprite;\n    private _progress: number = 0;\n\n    public set progress(v: number) {\n        this._progress = v;\n        if (this.prevSprite) {\n            this.prevSprite.alpha = (1 - this._progress);\n        }\n    }\n    public get progress(): number {\n        return this._progress;\n    }\n    public setPreviousTexture(value: any): void {\n        this.prevTexture = value;\n        if (this.prevTexture) {\n            this.prevSprite = vf.Sprite.from(this.prevTexture);\n        }\n    }\n    public applyTranisition(target: vf.DisplayObject): void {\n        this.target = target;\n        if (this.target && this.target.parent && this.prevSprite) {\n            this.prevSprite.x = this.target.x;\n            this.prevSprite.y = this.target.y;\n            this.target.parent.addChild(this.prevSprite);\n        }\n    }\n    public dispose(): void {\n        if (this.prevSprite && this.prevSprite.parent) {\n            this.prevSprite.parent.removeChild(this.prevSprite);\n            this.prevTexture?.destroy();\n            this.prevTexture = undefined;\n            this.prevSprite = undefined;\n        }\n    }\n\n\n}\n","/* eslint-disable no-unused-vars */\nimport { RES } from '../core/RES';\nimport { VFStage } from '../display/VFStage';\nimport { ISoundTrackMedia, SoundEvent, IActionPlaySound } from '../core/model/IVFData';\nimport EmptyAudio from '../../../../assets/empty-audio.mp3';\nimport { EventLevel } from '../event/EventLevel';\nimport { EventType } from '../event/EventType';\n\nexport class SoundManager {\n\n    private res: RES;\n    private vfStage: VFStage;\n    private trackMap: {[id: string]: ISoundTrackMedia} = {};\n    \n    constructor(res: RES, vfStage: VFStage) {\n        this.res = res;\n        this.vfStage = vfStage;\n        if(vfStage.config.vfvars.useNativeAudio){\n            return; // 如果使用了native播放，不要加载和设置PIXI.sound， 在互动课件中会有问题，教室中使用audioContext会出错。\n        }\n        \n        // webAudio 在ipad下有时播放会有杂音， 该用Audio 模式\n        // vf.sound.useLegacy = true; \n        /*\n        TODO:\n            1、使用空音频文件探测容器环境是否支持音频自动播放，如果支持就不用管了。\n            2、如不支持捕获一次全局页面点击，用于触发音频自动播放。\n         */\n    }\n/*\n    public async audioPlayplaySound(assetId: number) {\n        const s = this.res.getSoundAsset(assetId);\n        if (s) {\n            const media = await s.play();\n            media.volume = 0.5;\n        }\n    }\n*/\n\n    public clear(): void {\n        this.pause();\n        this.trackMap = {};\n    }\n    \n    public pause(): void {\n        for (const id in this.trackMap) {\n            if (this.trackMap[id]) {\n                const track = this.trackMap[id];\n                if (track.sound && track.sound.isPlaying) {\n                    track.sound.pause();\n                }\n            }\n        }\n    }\n    \n    public resume(): void {\n        for (const id in this.trackMap) {\n            if (this.trackMap[id]) {\n                const track = this.trackMap[id];\n                if (track.sound && track.sound.paused) {\n                    track.sound.resume();\n                }\n            }\n        }\n    }\n\n\n    public pauseSound(assetId: number, trackId: string , data: IActionPlaySound = {} as any) {\n        if(typeof assetId === 'string' && assetId === ''){\n            return;\n        }    \n        const asset = this.res.getAsset(assetId);\n        if (asset === undefined || asset.url === undefined || asset.url === '') {\n            return;\n        }\n\n        if (this.nativeEmit(assetId, 'pauseAudio', data)) {\n            return;\n        }\n\n        if (this.weixinEmit()) {\n            return;\n        }\n\n        const audio = this.res.getSoundAsset(assetId);\n        if (!audio) { return; } // TODO: throw error\n\n        const trackMedia = this.trackMap[trackId];\n        if (trackMedia) {\n\n            // tslint:disable-next-line: no-string-literal\n            if (trackMedia.sound && trackMedia.sound.isPlaying ) {\n                trackMedia.sound.pause();\n            }\n        }\n    }\n    public resumeSound(assetId: number, trackId: string , data: IActionPlaySound = {} as any) {\n         \n        const asset = this.res.getAsset(assetId);\n        if (asset === undefined || asset.url === undefined || asset.url === '') {\n            return;\n        }\n\n        if (this.nativeEmit(assetId, 'resumeAudio', data)) {\n            return;\n        }\n\n        if (this.weixinEmit()) {\n            return;\n        }\n        \n        const audio = this.res.getSoundAsset(assetId);\n\n        if (!audio) { return; } // TODO: throw error\n\n        const trackMedia = this.trackMap[trackId];\n        if (trackMedia) {\n            // tslint:disable-next-line: no-string-literal\n            if (trackMedia.sound && trackMedia.sound.paused ) {\n                trackMedia.sound.resume(); \n                \n            }\n        }\n            \n    }\n\n    // tslint:disable-next-line: max-line-length\n    public async playSound(assetId: number, trackId: string , data: IActionPlaySound = {} as any) {\n\n        const asset = this.res.getAsset(assetId);\n        if (asset === undefined || asset.url === undefined || asset.url === '') {\n            return;\n        }\n        \n        if (this.nativeEmit(assetId, 'playAudio', data)) {\n            return;\n        }\n\n        if (this.weixinEmit()) {\n            return;\n        }\n\n        const audio = this.res.getSoundAsset(assetId);\n\n        if (!audio) { return; } // TODO: throw error\n\n        const trackMedia = this.trackMap[trackId];\n        if (trackMedia) {\n            trackMedia.sound.stop();\n            delete this.trackMap[trackId];\n        }\n        const soundTrackMedia = await this.createSoundTrackMedia(audio, trackId);\n        this.trackMap[trackId] = soundTrackMedia;\n        // const touchPlay = () => {\n        //     audio.play();\n        //     document.removeEventListener('touchstart', touchPlay, false);\n        // };\n        // if (audio.paused) {\n        //     document.addEventListener('touchstart', touchPlay, false);\n        // }\n    }\n\n    public async createSoundTrackMedia(audio: vf.sound.Sound, trackId: string): Promise<ISoundTrackMedia> {\n        audio.autoPlay = false;\n        const audioM = await audio.play();\n        this.vfStage.systemEvent.emitExt(SoundEvent.SoundStart, trackId);\n        audioM.once('end', () => {\n            this.vfStage.systemEvent.emitExt(SoundEvent.SoundEnd, trackId);\n        }, this);\n        return {\n            id: trackId,\n            media: audioM,\n            sound: audio,\n        };\n    }\n\n    public isWeixin(): boolean {\n        const ua = window.navigator.userAgent.toLowerCase();\n        return /micromessenger/.test(ua);\n    }\n\n    private testAutoPlay() {\n        return new Promise((resolve) => {\n            const audio = document.createElement('audio');\n            audio.src = EmptyAudio;\n            document.body.appendChild(audio);\n            let autoplay = true;\n            audio.play().then(() => {\n                autoplay = true;\n                audio.remove();\n                resolve(autoplay);\n            }).catch(() => {\n                autoplay = false;\n                audio.remove();\n                resolve(autoplay);\n            });\n            /* mark: es2018才支持\n            .finally(() => {\n                audio.remove();\n                resolve(autoplay);\n            });*/\n\n        });\n    }\n\n    private weixinEmit() {\n        return false;\n        if (this.isWeixin()) {\n            // document.addEventListener('WeixinJSBridgeReady', () => {audio.play(); }, false);\n            // if (( window as any).WeixinJSBridge &&\n            //     typeof ( window as any).WeixinJSBridge === 'object' &&\n            //     typeof ( window as any).WeixinJSBridge.invoke === 'function') {\n            //     ( window as any).WeixinJSBridge.invoke('getNetworkType', {}, () => {audio.pause(); });\n            // }\n        }\n    }\n\n    private nativeEmit(assetId: number, typeTag: string, data: IActionPlaySound = {} as any) {\n        let useNative = this.vfStage.config.vfvars.useNativeAudio;\n        if (data.useNative) {\n            useNative = data.useNative;\n        }\n\n        if (useNative) { // 先放这里，后期soundManager完成后，合并\n            const asset = this.res.getAsset(assetId);\n            this.vfStage.systemEvent.emit(EventType.MESSAGE, {\n                code : EventLevel.NATIVE,\n                type : EventLevel.NATIVE,\n                level: EventLevel.COMMAND,\n                data : { \n                    type: typeTag,\n                    id: data.trackId || 0,\n                    src: asset.url,\n                    mode: data.mode || 'sound',\n                },\n            }); \n            return true;\n        }\n        return false;\n    }\n\n}\n","export default \"data:audio/mpeg;base64,//tQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAoAAAREAAMDAwMDAwMDAwMDAwMDBAQEBYWHR0dIyMpKSkvLzU1NTs7QUFBR0dNTU1TU1lZWWBgZmZmbGxycnJ4eH5+foSEioqKkJCWlpadnaOjo6mpr6+vtbW7u7vBwcfHx83N09PT2dkAAAAsTEFNRTMuODIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/6EMSYTQADwAABpBwAAAAAADSAAAAATEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxEJiKIPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDE0RlRA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMSgMHmDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxHfqogPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDEg8XKg8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjgyVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuODJVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy44MlVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//oQxE9o1wPAAAGkAAAAAAAANIAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+hDET2jXA8AAAaQAAAAAAAA0gAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/6EMRPaNcDwAABpAAAAAAAADSAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\"","/* eslint-disable no-undef */\n/* eslint-disable no-unused-vars */\nimport {\n    IVFDataV1, IAsset, IAssetFail, IScene, ComponentType, ICustomComponent, IDisplayComponent,\n    AssetType, SceneEvent, IAction, ActionType, IActionDefineVariable, AllAction,\n} from './model/IVFData';\nimport { VFStage } from '../display/VFStage';\nimport { VFScene } from '../display/VFScene';\nimport { VariableManager } from './VariableManager';\nimport { VFComponent } from '../display/VFComponent';\nimport { ActionList } from './actionTask/ActionList';\nimport { Animation } from './animation/Animation';\nimport { EventLevel } from '../event/EventLevel';\nimport { getAssetType } from '../../../assets/Assets';\nimport { AssetsType } from '../../../assets/IAssets';\nimport importScript from '../utils/ImportScript';\nimport IEvent from '../event/IEvent';\nimport { getUrl } from '../utils/getUrl';\n\nexport class RES extends vf.utils.EventEmitter {\n    public pixiResources: { [id: string]: vf.LoaderResource } = {};\n\n    public data: IVFDataV1 = null as any;\n    public vfActions: IAction[] = [];\n    private stage: VFStage;\n\n    private _resources: IAsset[] = [];\n    private _sceneMap: { [id: string]: VFScene } = {};\n    private _loadNum = 0;\n    private _loader?: vf.Loader;\n    private _assetFails = new Map<string, IAssetFail>();\n\n    constructor(stage: VFStage) {\n        super();\n        vf.gui.Utils.setSourcePath(this.getImageAsset.bind(this) as any);\n        vf.gui.Utils.setDisplayObjectPath(this.getDisplayObject.bind(this) as any);\n        this.stage = stage;\n    }\n\n    public destroy(): void {\n        if (this.pixiResources) {\n            for (const id in this.pixiResources) {\n                if (this.pixiResources[id]) {\n                    const resource = this.pixiResources[id];\n\n                    if (resource.texture) {\n                        resource.texture.destroy(true);\n                        delete this.pixiResources[id];\n                    }\n                    else if ((resource as any).sound) {\n                        if ((resource as any).sound.media) {\n                            (resource as any).sound.destroy();\n                        }\n                        delete this.pixiResources[id];\n                    }\n                }\n            }\n        }\n        vf.utils.destroyTextureCache();\n        vf.utils.clearTextureCache();\n        if (this._loader) {\n            this._loader.destroy();\n        }\n        this.stage = undefined as any;\n        this._sceneMap = {};\n    }\n    public addResource(asset: IAsset): void {\n        this._resources.push(asset);\n    }\n\n    public async loadData(data: IVFDataV1): Promise<void> {\n        this.data = data;\n        if (this.data && this.data.assets) {\n            await this.loadAllScript(); // 先加载脚本 loadAllAsset 非同步，后续单独提取assets同步加载，此处js并不算入进度\n            await this.loadAllAsset();\n        }\n        else {\n            this.emit(SceneEvent.LoadComplete, null);\n        }\n    }\n\n    public createFirstScene(vfStage: VFStage): VFScene | null {\n        this.initGlobalVariable();\n        if (this.data.scenes && this.data.scenes.length > 0) {\n            return this.createScene(this.data.scenes[0].id, vfStage);\n        }\n\n        return null;\n    }\n\n    public createNextScene(curId: string, vfStage: VFStage): VFScene | null {\n        const nextSceneData = this.getNextSceneData(curId);\n\n        if (nextSceneData) {\n            return this.createScene(nextSceneData.id, vfStage);\n        }\n\n        return null;\n    }\n\n    public createPrevScene(curId: string, vfStage: VFStage): VFScene | null {\n        const nextSceneData = this.getPrevSceneData(curId);\n\n        if (nextSceneData) {\n            return this.createScene(nextSceneData.id, vfStage);\n        }\n\n        return null;\n    }\n\n    public createScene(id: string, vfStage: VFStage): VFScene | null {\n        const sceneData = this.getSceneData(id);\n\n        if (sceneData) {\n            let vfScene: VFScene = this._sceneMap[id];\n\n            if (vfScene == null) {\n                vfScene = new VFScene(vfStage);\n                vfScene.transition = sceneData.transition;\n            }\n            vfScene.id = id;\n            this._sceneMap[id] = vfScene;\n            if (sceneData.libId) {\n                const scene: VFComponent = this.createComponent(sceneData.libId, sceneData.id) as any;\n\n                if (scene) {\n                    scene.width = vfStage.width;\n                    scene.height = vfStage.height;\n                    vfScene.addComponent(scene);\n                }\n            }\n\n            return vfScene;\n        }\n\n        return null;\n    }\n\n    public getImageAsset(index: number | string): vf.Texture | string | undefined {\n        // base64\n        if (index.toString().substr(0, 4) === 'data') {\n            return index.toString();\n        }\n\n        const resource = this.getAsset(index);\n\n        if (resource) {\n            const assetData = this.data.assets[index];\n\n            switch (assetData.type) {\n                case AssetType.IMAGE:\n                    return resource.texture as vf.Texture;\n                case AssetType.SHEET:\n                    return resource.spritesheet;\n                default:\n                    return resource;\n            }\n        }\n\n        return undefined;\n    }\n\n    public getDisplayObject(id: string, target?: vf.gui.DisplayObject): any | undefined {\n        if (id == undefined) {\n            return undefined;\n        }\n        // 单独写组件ID为创建一个组件复制到显示对象，如果是从场景ID - ID - ID为查找\n        if (id.toString().substr(0, 4) === 'this' && target && target.parent instanceof VFComponent) {\n            const childIds = id.split('#');\n\n            childIds.shift();\n            let child = target.parent as VFComponent;\n\n            while (childIds.length > 0 && child) {\n                const id = childIds.shift() as string;\n\n                child = child.getChildById(id) as VFComponent;\n            }\n            if (child) {\n                return child;\n            }\n            this.stage.systemEvent.emitError('E0006', [id], EventLevel.WARNING);\n\n            return undefined;\n        }\n\n        return this.creategui(id);\n    }\n\n    public getAsset(index: number | string): any {\n        const assetData = this.data.assets[index];\n\n        if (assetData === undefined || assetData.id == null) {\n            this.stage.systemEvent.emitError('E0003', [index], EventLevel.WARNING);\n\n            return undefined;\n        }\n\n        return this.pixiResources[assetData.id.toString()];\n    }\n\n    public getSoundAsset(index: number): vf.sound.Sound | undefined {\n        const assetData = this.getAsset(index);\n\n        if (assetData) {\n            return assetData.sound as vf.sound.Sound;\n        }\n\n        return undefined;\n    }\n\n    private async loadAllScript(): Promise<void> {\n        const assets = this.data.assets;\n        const cdns = this.stage.config.cdns;\n        let assetsItem: IAsset;\n\n        for (const id in assets) {\n            assetsItem = assets[id];\n            if (assetsItem && assetsItem.type === AssetType.JS && assetsItem.name) {\n                const cls = await importScript(assetsItem.url, cdns, assetsItem.name).catch((e: IEvent) => {\n                    this.stage.systemEvent.error(e);\n                });\n\n                if (cls) {\n                    if (cls.isFilter) {\n                        vf.gui.Filter.list.set(assetsItem.name, cls); // 添加到滤镜列表\n                    }\n                }\n            }\n        }\n    }\n\n    private async loadAllAsset(): Promise<void> {\n        const assets = this.data.assets;\n        let assetsItem: IAsset;\n\n        for (const id in assets) {\n            if (assets[id]) {\n                assetsItem = assets[id];\n                if (assetsItem === undefined || assetsItem.type === undefined || assetsItem.url === undefined) {\n                    this.stage.systemEvent.emitError('E0001', [id]);\n                    continue;\n                }\n                if (assetsItem.url === '') {\n                    this.stage.systemEvent.emitError('E0003', [id], EventLevel.WARNING);\n                    continue;\n                }\n                if (assetsItem.type === AssetType.SOUND && this.stage.config.vfvars.useNativeAudio) {\n                    this.stage.systemEvent.emitError('S0004', [id], EventLevel.WARNING);\n                    continue;\n                }\n                if (assetsItem.type === AssetType.JS) {\n                    continue;\n                }\n                assetsItem.id = id;\n                this.addResource(assets[id]);\n            }\n        }\n        this.loadResources();\n    }\n\n    private initGlobalVariable(): void {\n        if (this.data.global) {\n            this.stage.variableManager.addVariableConfig(VariableManager.GLOBAL_ID, this.data.global);\n            this.stage.variableManager.addVariableToGlobal(this.data.global);\n        }\n        if (this.vfActions) {\n            for (let i = 0, len: number = this.vfActions.length; i < len; i++) {\n                const action = this.vfActions[i];\n\n                if (action && action.type === ActionType.DefineVariable) {\n                    const defAction: IActionDefineVariable = action as IActionDefineVariable;\n\n                    this.stage.variableManager.addVariableDataToGlobal(defAction.varId,\n                        defAction.variableType,\n                        defAction.value);\n                }\n            }\n        }\n    }\n    private getSceneData(id: string): IScene | null {\n        if (this.data.scenes) {\n            for (let i = 0, len: number = this.data.scenes.length; i < len; i++) {\n                if (this.data.scenes[i].id === id) {\n                    return this.data.scenes[i];\n                }\n            }\n        }\n\n        return null;\n    }\n    private getNextSceneData(curId: string): IScene | null {\n        if (this.data.scenes) {\n            for (let i = 0, len: number = this.data.scenes.length; i < len; i++) {\n                if (this.data.scenes[i].id === curId) {\n                    if (i < len - 1) {\n                        return this.data.scenes[i + 1];\n                    }\n                }\n            }\n        }\n\n        return null;\n    }\n    private getPrevSceneData(curId: string): IScene | null {\n        if (this.data.scenes) {\n            for (let i = 0, len: number = this.data.scenes.length; i < len; i++) {\n                if (this.data.scenes[i].id === curId) {\n                    if (i > 0) {\n                        return this.data.scenes[i - 1];\n                    }\n                }\n            }\n        }\n\n        return null;\n    }\n\n    private createComponent(libId: string, id: string): vf.gui.DisplayObject | null {\n        const componentData = this.data.components[libId] as ICustomComponent;\n        let component: vf.gui.DisplayObject | null = null;\n\n        if (componentData) {\n            switch (componentData.type) {\n                case ComponentType.CUSTOM:\n                    component = this.createCustomComponent(libId, id);\n                    if (componentData.interactabled !== undefined) {\n                        component.interactabled = componentData.interactabled; // 性能优化，有部分业务，并不需要自定义组件有事件功能，可提前禁用\n                    }\n                    break;\n                default:\n                    component = this.creategui(libId);\n                    break;\n            }\n        }\n\n        return component;\n    }\n\n    private creategui(id: string): vf.gui.DisplayObject | null {\n        const componentData = this.data.components[id] as ICustomComponent;\n\n        if (!componentData) {\n            return null;\n        }\n        const type: any = componentData.type;\n        // tslint:disable-next-line: new-parens\n        let ui: any;\n\n        try {\n            const cls = vf.gui.Utils.getGuiClass(type);\n\n            ui = new cls();\n        }\n        catch (e) {\n            this.stage.systemEvent.emitError('E0004', [id]);\n            throw new Error(`guiNamespace['${type}'] === undefined`);\n        }\n        if (ui) {\n            for (const key in componentData) {\n                if (key in componentData) {\n                    switch (key) {\n                        case 'id':\n                            // tslint:disable-next-line: no-string-literal\n                            ui.libId = componentData[key];\n                            break;\n                        case 'name':\n                            // tslint:disable-next-line: no-string-literal\n                            ui.libName = componentData[key];\n                            break;\n                        case 'type':\n                        case 'children':\n                        case 'animations':\n                        case 'actions':\n                        case 'libs':\n                            break;\n                        default:\n                            ui[key] = (componentData as any)[key];\n                            break;\n                    }\n                }\n            }\n        }\n\n        return ui;\n    }\n    private createCustomComponent(libId: string, id: string): vf.gui.Container {\n        const componentData = this.data.components[libId];\n        const customData = componentData as ICustomComponent;\n        const vfComponent: VFComponent = new VFComponent();\n\n        vfComponent.name = customData.name;\n        vfComponent.libId = libId;\n        vfComponent.id = id;\n\n        if (customData.props) {\n            this.stage.variableManager.addVariableConfig(libId.toString(), customData.props);\n            this.stage.variableManager.addVariableToComponent(vfComponent);\n        }\n\n        if (customData.children) {\n            for (let i = 0, len: number = customData.children.length; i < len; i++) {\n                const childData: any = customData.children[i];\n\n                if ('libId' in childData) {\n                    const childComponentData = this.data.components[childData.libId] as ICustomComponent;\n                    const child = this.createComponent(childData.libId, childData.id);\n\n                    if (child) {\n                        switch (childComponentData.type) {\n                            default:\n                                this.applyDisplayComponentProperty(child, childData);\n                                break;\n                        }\n                        vfComponent.addChild(child);\n                    }\n                }\n            }\n        }\n        if (customData.actionList && customData.actionList !== '') {\n            const actionList = new ActionList(vfComponent, customData.actionList);\n\n            vfComponent.actionList = actionList;\n        }\n        else if (libId !== undefined) {\n            const actions = this.getVfsByComponentId(libId.toString());\n\n            if (actions) {\n                const actionList = new ActionList(vfComponent, actions);\n\n                vfComponent.actionList = actionList;\n            }\n        }\n        if (customData.animations) {\n            const animation = new Animation(vfComponent, customData.animations, this.data.fps);\n\n            vfComponent.animation = animation;\n        }\n\n        return vfComponent;\n    }\n\n    private applyDisplayComponentProperty(display: vf.gui.DisplayObject, data: IDisplayComponent): void {\n        for (const key in data) {\n            if (key in data) {\n                switch (key) {\n                    // case 'id':\n                    // case 'name':\n                    case 'libId':\n                    case 'type':\n                    case 'children':\n                    case 'animations':\n                    case 'actions':\n                        break;\n                    default:\n                        if (key.indexOf('filter') === 0) {\n                            this.applyFilter(display, key, (data as any)[key]);\n                        }\n                        else {\n                            (display as any)[key] = (data as any)[key];\n                        }\n                        break;\n                }\n            }\n        }\n    }\n\n    private applyFilter(display: vf.gui.DisplayObject, filterKey: string, value: any): void {\n        const filterKeys = filterKey.split('.');\n        let target = display as any;\n\n        for (let i = 0, len: number = filterKeys.length; i < len - 1; i++) {\n            const curkey = filterKeys[i];\n\n            if (target && target[curkey]) {\n                target = target[curkey];\n            }\n        }\n        if (target) {\n            target[filterKeys[filterKeys.length - 1]] = value;\n        }\n    }\n\n    private loadResources(): void {\n        if (this._loader === undefined) {\n            this._loader = new vf.Loader();\n        }\n        const loader = this._loader;\n        const urls: any = {};\n\n        this._loadNum = 0;\n\n        for (let i = 0, len: number = this._resources.length; i < len; i++) {\n            const res = this._resources[i];\n            const id = res.id === undefined ? 'undefined' : res.id.toString();\n\n            if (urls[res.url]) {\n                urls[res.url].push(res.id);\n                continue;\n            }\n            loader.add(id, getUrl(res.url, this.data.baseUrl));\n            urls[res.url] = [id];\n        }\n        let progressId = 0;\n        let completeId = 0;\n        let errorId = 0;\n\n        progressId = loader.onProgress.add(() => {\n            this._loadNum++;\n            this.emit(SceneEvent.LoadProgress, [this._loadNum / (this._resources.length), this._resources.length]);\n        });\n        completeId = loader.onComplete.add((loader2: vf.Loader, resources: any) => {\n            this.pixiResources = resources;\n            if (!this.loadFailResources()) {\n                for (const key in urls) {\n                    const id = urls[key].shift();\n\n                    while (urls[key].length > 0) {\n                        this.pixiResources[urls[key].shift()] = resources[id];\n                    }\n                }\n                loader.onComplete.detach(progressId);\n                loader.onComplete.detach(completeId);\n                loader.onComplete.detach(errorId);\n                this.emit(SceneEvent.LoadComplete, null);\n            }\n        });\n        errorId = loader.onError.add((error: Error, loader2: vf.Loader, loaderResource: vf.LoaderResource)=>{\n            const assetFail = this._assetFails.get(loaderResource.name);\n\n            if (assetFail) {\n                if (assetFail.count >= 4) {\n                    this._assetFails.delete(loaderResource.name);\n                    this.stage.systemEvent.emitError('404', [loaderResource.url]);\n                }\n                assetFail.count++;\n            }\n            else {\n                this._assetFails.set(loaderResource.name, { id: loaderResource.name,\n                    url: loaderResource.url,\n                    extension: loaderResource.extension, count: 1 });\n            }\n        });\n        loader.load();\n    }\n\n    /** */\n    private loadFailResources(): boolean {\n        if (this._loader === undefined) {\n            return false;\n        }\n\n        if (this._assetFails.size <= 0) {\n            return false;\n        }\n        const loader = this._loader;\n        const cdns = this.stage.config.cdns;\n\n        this._assetFails.forEach((res) => {\n            const type = getAssetType(res.extension);\n            let cdn: any[];\n\n            switch (type) {\n                case AssetsType.Image:\n                    cdn = cdns.image;\n                    break;\n                case AssetsType.Audio:\n                case AssetsType.Video:\n                    cdn = cdns.media;\n                    break;\n                default:\n                    cdn = cdns.default;\n            }\n            let url = cdn[(res.count - 1) % cdn.length];\n\n            if (res.url.indexOf('http') !== -1 || res.url.indexOf('//') === 0) {\n                url += res.url.substr(res.url.indexOf('/', res.url.indexOf('.')));\n            }\n            else {\n                url += res.url;\n            }\n            delete loader.resources[res.id];\n            loader.add(res.id, url);\n        });\n\n        return true;\n    }\n\n    private getVfsByComponentId(libId: string): AllAction[] | undefined {\n        if (this.vfActions) {\n            for (let i = 0, len: number = this.vfActions.length; i < len; i++) {\n                const action = this.vfActions[i];\n\n                if (action && action.type === ActionType.ActionList && action.value === libId) {\n                    return action.execute;\n                }\n            }\n        }\n\n        return undefined;\n    }\n}\n\n","import { VFStage } from './VFStage';\nimport { ITransitionData } from '../core/model/IVFData';\nimport { VFComponent } from './VFComponent';\n\nexport class VFScene extends vf.gui.Container {\n\n        public vfStage: VFStage;\n        public id: string = '-1';\n        public transition: ITransitionData | undefined;\n        \n        private component: VFComponent = null as any;\n\n        constructor(vfStage: VFStage) {\n            super();\n            this.vfStage = vfStage;\n        }\n\n        public pause(): void {\n            if (this.component) {\n                this.component.pause();\n            }\n        }\n\n        public resume(): void {\n            if (this.component) {\n                this.component.resume();\n            }\n        }\n\n        public addComponent(vfComponent: VFComponent): void {\n            this.component = vfComponent;\n            this.component.vfStage = this.vfStage;\n            this.component.runAction();\n            this.component.emitAddToChildBefore();\n            const child = this.addChild(vfComponent);\n            this.component.emitAddToChild();\n            this.component.playDefaultAnimation();\n        }\n\n        public removeComponent(): void {\n            if (this.component) {\n                this.component.emitRemoveToChildBefore();\n                const child = this.removeChild(this.component);\n                this.component.emitRemoveToChild();\n                this.component.stop();\n                this.component.vfStage = undefined;\n            }\n        }\n        public dispose(): void {\n            if (this.component) {\n                this.removeComponent();\n                this.component.dispose();\n            }\n            this.component = null as any;\n        }\n    }\n\n","import { VFComponent } from '../../display/VFComponent';\nimport { IAction, ActionType, ComponentEvent, IActionSetProperty, IActionExpress, \n         IActionIFPart, IActionFunction, IActionAddEventListener, IActionPlayAnimation, \n         IActionJump, IActionArraySplice, IActionArrayConcat, IActionEmitEvent, \n         IActionPlaySound, IActionDefineVariable, IVariableData, IActionGoto, IActionCallFunction, IActionFor } from '../model/IVFData';\nimport { BaseTask } from './core/BaseTask';\nimport { AddListenerTask } from './AddListenerTask';\nimport { SetPropertyTask } from './SetPropertyTask';\nimport { ExpressTask } from './ExpressTask';\nimport { IfTask } from './IfTask';\nimport { QueueTask } from './core/QueueTask';\nimport { DefineFunctionTask } from './DefineFunctionTask';\nimport { FunctionTask } from './FunctionTask';\nimport { CallFunctionTask } from './CallFunctionTask';\nimport { PrintTask } from './PrintTask';\nimport { PlaySoundTask } from './PlaySoundTask';\nimport { PlayAnimationTask } from './PlayAnimationTask';\nimport { JumpToNextSceneTask } from './JumpToNextSceneTask';\nimport { JumpToPrevSceneTask } from './JumpToPrevSceneTask';\nimport { JumpToSceneTask } from './JumpToSceneTask';\nimport { ArrayPopTask } from './ArrayPopTask';\nimport { ArrayPushTask } from './ArrayPushTask';\nimport { ArraySpliceTask } from './ArraySpliceTask';\nimport { ArrayRandomTask } from './ArrayRandomTask';\nimport { ArrayInitTask } from './ArrayInitTask';\nimport { ArrayConcatTask } from './ArrayConcatTask';\nimport { ArrayShiftTask } from './ArrayShiftTask';\nimport { ArrayUnshiftTask } from './ArrayUnshiftTask';\nimport { AddListenerCallTask } from './AddListenerCallTask';\nimport { EmitEventTask } from './EmitEventTask';\nimport { DefineVariableTask } from './DefineVariableTask';\nimport { CallProtoFunctionTask } from './CallProtoFunctionTask';\nimport { PauseSoundTask } from './PauseSoundTask';\nimport { ResumeSoundTask } from './ResumeSoundTask';\nimport { RemoveListenerTask } from './RemoveListenerTask';\nimport { ForTask } from './ForTask';\nimport { BreakTask } from './BreakTask';\nimport { WaitTask } from './WaitTask';\nimport { SetTimeoutTask } from './SetTimeoutTask';\nimport { ContainerTask } from './core/ContainerTask';\nimport { SetIntervalTask } from './SetIntervalTask';\nimport { EnterFrameTask } from './EnterFrameTask';\n\n\nexport class ActionList {\n        public component: VFComponent;\n        public data: IAction[] | string;\n\n        private _actionList: BaseTask[] = [];\n\n        constructor(component: VFComponent, data: IAction[] | string)  {\n            this.component = component;\n            this.data = data;\n            this.parseData();\n        }\n\n        public run(): void {\n            if (this._actionList && this._actionList.length) {\n                for ( let i: number = 0, len: number = this._actionList.length; i < len; i++) {\n                    const task = this._actionList[i];\n                    task.run();\n                }\n            }\n        }\n\n        public stop(): void {\n            if (this._actionList && this._actionList.length) {\n                for ( let i: number = 0, len: number = this._actionList.length; i < len; i++) {\n                    const task = this._actionList[i];\n                    task.stop();\n                }\n            }\n        }\n\n        public pause(): void {\n            if (this._actionList && this._actionList.length) {\n                for ( let i: number = 0, len: number = this._actionList.length; i < len; i++) {\n                    const task = this._actionList[i];\n                    task.pause();\n                }\n            }\n        }\n\n        public resume(): void {\n            if (this._actionList && this._actionList.length) {\n                for ( let i: number = 0, len: number = this._actionList.length; i < len; i++) {\n                    const task = this._actionList[i];\n                    task.resume();\n                }\n            }\n        }\n\n        private parseData(): void {\n            if (this.data) {\n                if (Array.isArray(this.data)) {\n                    this.parseAST(this.data);\n                }\n            } \n        }\n\n        private addGlobalVariable(action: IActionDefineVariable): void {\n            if (this.component && this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                variableManager.addVariableDataToGlobal(action.varId, action.variableType, action.value);\n            }\n        }\n        private parseAST(actions: IAction[]): void {\n            if (actions) {\n                for (let i: number = 0, len: number = actions.length; i < len; i++) {\n                    const task = this.parseAction(actions[i]);\n                    if (task) {\n                        this._actionList.push(task);\n                    }\n                }\n            }\n        }\n        private parseAction(data: IAction): BaseTask | undefined {\n\n            let task: BaseTask | undefined;\n            switch (data.type) {\n                case ActionType.Add:\n                    task = this.parseAddToStageBefore(data);\n                    break;\n                case ActionType.Added:\n                    task = this.parseAddToStage(data);\n                    break;\n                case ActionType.SetProperty:\n                    task = this.parseSetProperty(data as any);\n                    break;\n                case ActionType.Click:\n                    task = this.parseClick(data);\n                    break;\n                case ActionType.Express:\n                    task = this.parseExpress(data as any);\n                    break;\n                case ActionType.IfGroup:\n                    task = this.parseIf(data);\n                    break;\n                case ActionType.DefineFunction:\n                    task = this.parseDefineFunction(data as any);\n                    break;\n                case ActionType.CallFunction:\n                    task = this.parseCallFunction(data as any);\n                    break;\n                case ActionType.Print:\n                    task = this.parsePrint(data as any);\n                    break;\n                case ActionType.AddEventListener:\n                    task = this.parseAddEventListener(data as any);\n                    break;\n                case ActionType.RemoveEventListener:\n                    task = this.parseRemoveEventListener(data as any);\n                    break;\n                case ActionType.EmitEvent:\n                    task = this.parseEmitEvent(data as IActionEmitEvent);\n                    break;\n                case ActionType.PlaySound:\n                    task = this.parsePlaySound(data);\n                    break;\n                case ActionType.PauseSound:\n                    task = this.parsePauseSound(data);\n                    break;\n                case ActionType.ResumeSound:\n                    task = this.parseResumeSound(data);\n                    break;\n                case ActionType.PlayAnimation:\n                    task = this.parsePlayAnimation(data as any);\n                    break;\n                case ActionType.JumpToNextScene:\n                    task = this.parseJumpToNextScene(data);\n                    break;\n                case ActionType.JumpToPrevScene:\n                    task = this.parseJumpToPrevScene(data);\n                    break;\n                case ActionType.JumpToScene:\n                    task = this.parseJumpToScene(data);\n                    break;\n                case ActionType.ArrayInit:\n                    task = new ArrayInitTask(this.component, data);\n                    break;\n                case ActionType.ArrayPop:\n                    task = new ArrayPopTask(this.component, data);\n                    break;\n                case ActionType.ArrayPush:\n                    task = new ArrayPushTask(this.component, data);\n                    break;\n                case ActionType.ArraySplice:\n                    task = new ArraySpliceTask(this.component, data as IActionArraySplice);\n                    break;\n                case ActionType.ArrayRandom:\n                    task = new ArrayRandomTask(this.component, data);\n                    break;\n                case ActionType.ArrayConcat:\n                    task = new ArrayConcatTask(this.component, data as IActionArrayConcat);\n                    break;\n                case ActionType.ArrayShift:\n                    task = new ArrayShiftTask(this.component, data);\n                    break;\n                case ActionType.ArrayUnshift:\n                    task = new ArrayUnshiftTask(this.component, data);\n                    break;\n                case ActionType.AddEventListenerCall:\n                    task = this.parseAddEventListenerCall(data as IActionAddEventListener);\n                    break;\n                case ActionType.DefineVariable:\n                    task = new DefineVariableTask(this.component, data as IActionDefineVariable);\n                    break;\n                case ActionType.CallProtoFunction:\n                    task = new CallProtoFunctionTask(this.component, data as IActionCallFunction);\n                    break;\n                case ActionType.GotoPlay:\n                    const gotoData0 = data as IActionGoto;\n                    const gotoPlayData: IActionCallFunction = {\n                        type: ActionType.CallProtoFunction,\n                        target: gotoData0.target,\n                        name: 'gotoPlay',\n                    };\n                    gotoPlayData.params = [];\n                    if (Array.isArray(gotoData0.name)) {\n                        gotoPlayData.params.push(gotoData0.name);\n                    } else {\n                        gotoPlayData.params.push([0, gotoData0.name]);\n                    }\n                    if (Array.isArray(gotoData0.frame)) {\n                        gotoPlayData.params.push(gotoData0.frame);\n                    } else {\n                        gotoPlayData.params.push([0, gotoData0.frame]);\n                    }\n                    if (Array.isArray(gotoData0.times)) {\n                        gotoPlayData.params.push(gotoData0.times);\n                    } else {\n                        gotoPlayData.params.push([0, gotoData0.times]);\n                    }\n                    task = new CallProtoFunctionTask(this.component, gotoPlayData);\n                    break;\n                case ActionType.GotoStop:\n                    const gotoData1 = data as IActionGoto;\n                    const gotoStopData: IActionCallFunction = {\n                        type: ActionType.CallProtoFunction,\n                        target: gotoData1.target,\n                        name: 'gotoStop',\n                    };\n                    gotoStopData.params = [];\n                    if (Array.isArray(gotoData1.name)) {\n                        gotoStopData.params.push(gotoData1.name);\n                    } else {\n                        gotoStopData.params.push([0, gotoData1.name]);\n                    }\n                    if (Array.isArray(gotoData1.frame)) {\n                        gotoStopData.params.push(gotoData1.frame);\n                    } else {\n                        gotoStopData.params.push([0, gotoData1.frame]);\n                    }\n                    task = new CallProtoFunctionTask(this.component, gotoStopData);\n                    break;\n                case ActionType.For:\n                    task = this.parseFor(data as IActionFor);\n                    break;\n                case ActionType.Break:\n                    task = new BreakTask();\n                    break;\n                case ActionType.Wait:\n                    task = new WaitTask(this.component, data);\n                    break;\n                case ActionType.SetTimeout:\n                    task = this.parseSetTimeout(data);\n                    break;\n                case ActionType.SetInterval:\n                    task = this.parseSetInterval(data);\n                    break;\n                case ActionType.EnterFrame:\n                    task = this.parseEnterFrame(data);\n                    break;\n                default:\n                    break;\n            }\n            return task;\n        }\n\n        private parseSubTask(task: ContainerTask, data: IAction): void {\n            if (data.execute) {\n                for (let i: number = 0, len: number = data.execute.length; i < len; i++) {\n                    const taskData = data.execute[i];\n                    const subTask = this.parseAction(taskData);\n                    if (subTask) {\n                        task.addSubTask(subTask);\n                    }\n                }\n            }\n        }\n\n        private parseAddToStageBefore(data: IAction): AddListenerTask {\n            const addAction: IActionAddEventListener = {\n                type: ActionType.AddEventListener,\n                event: ComponentEvent.Add,\n                target: [],\n            };\n            const task: AddListenerTask = new AddListenerTask(this.component, addAction);\n            this.parseSubTask(task, data);\n            return task;\n        }\n        private parseAddToStage(data: IAction): AddListenerTask {\n            const addedAction: IActionAddEventListener = {\n                type: ActionType.AddEventListener,\n                event: ComponentEvent.Added,\n                target: [],\n            };\n            const task: AddListenerTask = new AddListenerTask(this.component, addedAction);\n            this.parseSubTask(task, data);\n            return task;\n        }\n\n        private parseSetProperty(data: IActionSetProperty): SetPropertyTask {\n            const task: SetPropertyTask = new SetPropertyTask(this.component, data);\n            return task;\n        }\n\n        private parseClick(data: IAction): AddListenerTask | undefined {\n\n            const addlistenerAction: IActionAddEventListener = {\n                event: ComponentEvent.Click,\n                type: ActionType.AddEventListener,\n                target: data.target,\n            };\n            const task: AddListenerTask = new AddListenerTask(this.component, addlistenerAction);\n            this.parseSubTask(task, data);\n            return task;\n        }\n        \n        private parseExpress(data: IActionExpress): ExpressTask {\n            const task: ExpressTask = new ExpressTask(this.component, data);\n            return task;\n        }\n\n        private parseIf(data: IAction): IfTask {\n            const task: IfTask = new IfTask(this.component);\n            if (data.execute) {\n                for (let i: number = 0, len: number = data.execute.length; i < len; i++) {\n                    const ifPart = data.execute[i];\n                    if (ifPart.type === ActionType.If ||\n                        ifPart.type === ActionType.ElseIf || \n                        ifPart.type === ActionType.Else) {\n                        const condition = (ifPart as IActionIFPart).condition;\n                        const conditionQue = new QueueTask();\n                        if (ifPart.execute) {\n                            for (let j: number = 0, jlen: number = ifPart.execute.length; j < jlen; j++) {\n                                const subTask = this.parseAction(ifPart.execute[j]);\n                                if (subTask) {\n                                    conditionQue.addTask(subTask);\n                                }\n                            }\n                        }\n                        task.addCondition(condition, conditionQue);\n                    }\n                }\n            }\n            return task;\n        }\n\n        private parseDefineFunction(data: IActionFunction): DefineFunctionTask {\n            const funTask: FunctionTask = new FunctionTask(this.component, data.name);\n            this.parseSubTask(funTask, data);\n            const task: DefineFunctionTask = new DefineFunctionTask(this.component, data.name, data, funTask);\n            return task;\n        }\n\n        private parseCallFunction(data: IActionFunction): CallFunctionTask | undefined {\n            const task: CallFunctionTask = new CallFunctionTask(this.component, data.name, data);\n            return task;\n        }\n\n        private parsePrint(data: IAction): PrintTask {\n            const task: PrintTask = new PrintTask(this.component, data);\n            return task;\n        }\n\n        private parseAddEventListener(data: IActionAddEventListener): AddListenerTask | undefined {\n            const task: AddListenerTask = new AddListenerTask(this.component, data);\n            this.parseSubTask(task, data);\n            return task;\n        }\n\n        private parseRemoveEventListener(data: IActionAddEventListener): RemoveListenerTask | undefined {\n\n            const task: RemoveListenerTask = new RemoveListenerTask(this.component, data);\n            return task;\n        }\n\n        private parseEmitEvent(data: IActionEmitEvent): EmitEventTask | undefined {\n            const task: EmitEventTask = new EmitEventTask(this.component, data);\n            return task;\n        }\n        private parseAddEventListenerCall(data: IActionAddEventListener): AddListenerCallTask | undefined {\n            if (data.funName) {\n                const task: AddListenerCallTask = \n                    new AddListenerCallTask(this.component, data);\n                return task;\n            }\n        }\n        private parsePlaySound(data: IActionPlaySound): PlaySoundTask {\n            const task: PlaySoundTask = new PlaySoundTask(this.component, data.value, data.trackId, data);\n            return task;\n        }\n        private parsePauseSound(data: IActionPlaySound): PauseSoundTask {\n            const task: PauseSoundTask = new PauseSoundTask(this.component, data.value, data.trackId, data);\n            return task;\n        }\n        private parseResumeSound(data: IActionPlaySound): ResumeSoundTask {\n            const task: ResumeSoundTask = new ResumeSoundTask(this.component, data.value, data.trackId, data);\n            return task;\n        }\n        private parsePlayAnimation(data: IActionPlayAnimation): PlayAnimationTask | undefined {\n            const task: PlayAnimationTask = new PlayAnimationTask(this.component, data);\n            return task;\n        }\n        private parseJumpToNextScene(data: IActionJump): JumpToNextSceneTask {\n            const task: JumpToNextSceneTask = new JumpToNextSceneTask(this.component, data.transition);\n            return task;\n        }\n        private parseJumpToPrevScene(data: IActionJump): JumpToPrevSceneTask {\n            const task: JumpToPrevSceneTask = new JumpToPrevSceneTask(this.component, data.transition);\n            return task;\n        }\n        private parseJumpToScene(data: IActionJump): JumpToSceneTask {\n            const task: JumpToSceneTask = new JumpToSceneTask(this.component, data.value, data.transition);\n            return task;\n        }\n\n        private parseFor(data: IActionFor): ForTask {\n            const task = new ForTask(this.component, data);\n            this.parseSubTask(task, data);\n            return task;\n        }  \n        private parseSetTimeout(data: IAction): SetTimeoutTask {\n            const task: SetTimeoutTask = new SetTimeoutTask(this.component, data);\n            this.parseSubTask(task, data);\n            return task;\n        }\n\n        private parseSetInterval(data: IAction): SetIntervalTask {\n            const task: SetIntervalTask = new SetIntervalTask(this.component, data);\n            this.parseSubTask(task, data);\n            return task;\n        }\n        private parseEnterFrame(data: IAction): EnterFrameTask {\n            const task: EnterFrameTask = new EnterFrameTask(this.component, data);\n            this.parseSubTask(task, data);\n            return task;\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { FunctionTask } from './FunctionTask';\nimport { IAction } from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class DefineFunctionTask extends BaseTask {\n\n        public funName: string;\n        protected component: VFComponent;\n        protected fun: FunctionTask;\n        protected data: IAction;\n        protected funId: string = '';\n\n        constructor(compontent: VFComponent, funName: string, data: IAction, fun: FunctionTask) {\n            super();\n            this.component = compontent;\n            this.funName = funName;\n            this.fun = fun;\n            this.data = data;\n        }\n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                let funId = this.funName;\n                const subComponent = getTargetComponent(this.component, this.data.target);\n                if (subComponent) {\n                    funId = (subComponent as VFComponent).hashCode + this.funName;\n                }\n                variableManager.setFunctionTask(funId, this.fun);\n                this.complete();\n            } else {\n                this.complete();\n            }\n            \n        }\n        public stop(): void {\n            super.stop();\n        }\n    }\n\n","import { ContainerTask } from './core/ContainerTask';\nimport { TaskEvent, BaseTask } from './core/BaseTask';\nimport { ExpressTask } from './ExpressTask';\nimport { ExpressItemType, ExpressType, ExpressItem } from '../model/IVFData';\nimport { IfTask } from './IfTask';\nimport { QueueTask } from './core/QueueTask';\nimport { SetPropertyTask } from './SetPropertyTask';\nimport { PlayAnimationTask } from './PlayAnimationTask';\nimport { PlaySoundTask } from './PlaySoundTask';\nimport { CallFunctionTask } from './CallFunctionTask';\nimport { PrintTask } from './PrintTask';\nimport { injectParamsToQueueTask } from './core/ActionListUtils';\n\n\nexport class FunctionTask extends ContainerTask {\n        public funName: string;\n\n        protected _component: vf.gui.DisplayObject;\n        protected _loopComplete: boolean;\n        protected callTargets: number[] = [];\n\n        constructor(compontent: vf.gui.DisplayObject, funName: string) {\n            super();\n            this._loopComplete = false;\n            this._component = compontent;\n            this.funName = funName;\n        }\n    \n        public injectParams(paramIds: string[]): void {\n            if (this.loopTask) {\n                injectParamsToQueueTask(this.loopTask, paramIds);\n            }\n        }\n\n        \n        public runWithId(id: number): void {\n            if (!this._isRunning) {\n                this.callTargets.push(id);\n                this.run();\n            }\n        }\n\n        public stopWithId(id: number): void {\n            const index = this.callTargets.indexOf(id);\n            if (index >= 0) {\n                if (index > 0) {\n                    this.callTargets.splice(index, 1);\n                } else {\n                    this.callTargets.splice(index, 1);\n                    if (this._isRunning) {\n                        this.loopTask.stop();\n                    }\n                }\n            }\n        }\n\n        public breakWithId(id: number): void {\n            const index = this.callTargets.indexOf(id);\n            if (index >= 0) {\n                if (index > 0) {\n                    this.callTargets.splice(index, 1);\n                } else {\n                    this.callTargets.splice(index, 1);\n                    if (this._isRunning) {\n                        this.loopTask.break();\n                    }\n                }\n            }\n        }\n        public run() {\n            super.run();\n            this._loopComplete = true;\n            if (this.loopTask) {\n                this.loopTask.on(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n                this.loopTask.on(TaskEvent.EVENT_BREAK, this.onBreak, this);\n            }\n            if (this.callTargets.length > 0) {\n                this.loopTask.run();\n            } else {\n                this.complete();\n            }\n        }\n\n    \n        public stop() {\n            this.complete();\n            super.stop();\n        }\n        public break() {\n            this.complete();\n            super.break();\n        }\n    \n        public complete() {\n            this.callTargets.length = 0;\n            this.loopTask.off(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n            this.loopTask.off(TaskEvent.EVENT_BREAK, this.onBreak, this);\n            super.complete();\n        }\n        protected onLoopComplete() {\n            if (this.callTargets.length > 0) {\n                const callId = this.callTargets[0];\n                this.callTargets.shift();\n                this._isRunning = false;\n                this.emit(TaskEvent.FUNCTION_RUN_COMPLETE, callId);\n            }\n            if (this.callTargets.length > 0) {\n                this.loopTask.run();\n            } else {\n                this.complete();\n            }\n        }\n   \n    }\n\n","import getTimer from './getTimer';\nexport default function trace(...args: any[]) {\n    const title = '[VF LOG]';\n    switch (args.length) {\n        // tslint:disable-next-line: no-console\n        case 1: return console.log(title, args[0]);\n        // tslint:disable-next-line: no-console\n        case 2: return console.log(title, args[0], args[1]);\n        // tslint:disable-next-line: no-console\n        case 3: return console.log(title, args[0], args[1], args[2]);\n        // tslint:disable-next-line: no-console\n        case 4: return console.log(title, args[0], args[1], args[2], args[3]);\n        // tslint:disable-next-line: no-console\n        case 5: return console.log(title, args[0], args[1], args[2], args[3], args[4]);\n        // tslint:disable-next-line: no-console\n        case 6: return console.log(title, args[0], args[1], args[2], args[3], args[4], args[5]);\n    }\n}\n//\n// export default class Trace {\n//     public static NAME\t\t    :string = 'Trace';\n//     public static VERSION\t\t:string = '1.0.0';\n//\n//     // public static ignoreStatus\t\t:boolean = true;\n//     // public static secure\t\t\t:boolean = false;\n//     // public static secureDomain\t\t:string  = '*';\n//     // public static allowLog\t\t\t:boolean = true;\n//     // public static allowAdvancedTrace:boolean = true;\n//     //\n//     // public static DEFAULT_COLOR\t:number\t= 6710886;\n//     // public static RED\t\t\t:number = 0xE40D0D;\n//     // public static ORANGE\t\t:number = 0xFF6600;\n//     // public static GREEN\t\t\t:number = 0x4FE10F;\n//     // public static BLUE\t\t\t:number = 0x118EE6;\n//     // public static PINK\t\t\t:number = 0xE40DE4;\n//     // public static YELLOW\t\t:number = 0xE9E610;\n//     // public static LIGHT_BLUE\t:number = 0x15E0DE;\n//     // public static START_TIME    :number = Date.now();\n//\n//     public static logAdvancedTrace  :boolean = false;\n//\n//     /**\n//      * 可以通过属性设置功能开关：\n//      *\n//      * - 输出堆栈调用跟踪日志（Trace.logAdvancedTrace = true;）\n//      *\n//      * 使用示例：\n//      * trace(\"year={}, month={}, day={}\", 2014, 9, 5); // [VF LOG] year=2014 month=9 day=5\n//      * trace(Object); // [VF LOG] {\"a\":\"aa\", \"b\":\"bb\", ...}\n//      * trace(Array); // [VF LOG] [0, 1, 2, ...]\n//      * trace(\"test message\", 0xFF6600, \"LOGO\"); // [LOGO LOG] test message\n//      * trace(\"test1\", \"test2\", 0xFF6600, \"test3\", \"CORE\"); // [CORE LOG] test1 test2 test3\n//      */\n//     public static log(any: any, ...args: any[]): void {\n//         let _msg: string = '';\n//         let _color: number = Trace.DEFAULT_COLOR;\n//         let _logo: string = 'VF';\n//\n//         if(typeof any === 'object') {\n//             try {\n//                 _msg = JSON.stringify(any);\n//                if(_msg === '{}') {\n//                    _msg = JSON.stringify((<any>Object).fromEntries(any.entries()));\n//                }\n//             }\n//             catch (err) {\n//                  return console.log(err);\n//             }\n//         }\n//         else {\n//             _msg = String(any);\n//         }\n//\n//         if(args.length) {\n//             let placeholder: string = '{}';\n//             let pIndex: number = 0;\n//             let arg: string = '';\n//             let i: number = 0;\n//\n//             while ((pIndex = _msg.indexOf(placeholder, pIndex)) != -1)\n//             {\n//                 arg = String(args.shift());\n//                 _msg = _msg.substring(0, pIndex) + arg + _msg.substring(pIndex + 2);\n//                 pIndex += arg.length;\n//             }\n//\n//             while (i<args.length)\n//             {\n//                 let _type: string = typeof args[i];\n//                 if (_type === \"number\" && args[i].toString(16).length == 6)\n//                 {\n//                     _color = args[i];\n//                     i++;\n//                     continue;\n//                 }\n//\n//                 if (_type === \"string\" && args[i].length<=5)\n//                 {\n//                     var re: RegExp = /^[A-Z]+[A-Z0-9]*$/;\n//                     if (re.test(args[i]))\n//                     {\n//                         _logo = args[i];\n//                         i++;\n//                         continue;\n//                     }\n//                 }\n//                 _msg += \" \" + String(args[i]);\n//                 i++;\n//             }\n//\n//         }\n//\n//         if(_logo || Trace.logAdvancedTrace) {\n//             _msg = `[${(_logo ? (_logo + ' LOG') : '')}${Trace.logAdvancedTrace?Trace.wrapMessage():''}] ` + _msg;\n//         }\n//         /* mark：颜色看需求再加...\n//         let style = [\n//             'background: linear-gradient(#D33106, #571402)'\n//             , 'border: 1px solid #3E0E02'\n//             , 'color: white'\n//             , 'display: block'\n//             , 'text-shadow: 0 1px 0 rgba(0, 0, 0, 0.3)'\n//             , 'box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4) inset, 0 5px 3px -5px rgba(0, 0, 0, 0.5), 0 -13px 5px -10px rgba(255, 255, 255, 0.4) inset'\n//             , 'line-height: 40px'\n//             , 'text-align: center'\n//             , 'font-weight: bold'\n//         ].join(';');\n//         // console.log('%c test message!', style); */\n//         Trace.logAdvancedTrace?console.trace(_msg):console.log(_msg);\n//     }\n//\n//     private static wrapMessage(allowAdvancedTrace: boolean = true): string {\n//         let date: Date = new Date();\n//         let time: string = String('00' + date.getHours()).substr(-2) + ':' +\n//             String('00' + date.getMinutes()).substr(-2) + ':' +\n//             String('00' + date.getSeconds()).substr(-2) + '.' +\n//             String('000' + date.getUTCMilliseconds()).substr(-3);\n//         let str: string = '->' + getTimer(Trace.START_TIME) + ' ' + time;\n//\n//         // ...\n//\n//         return str;\n//     }\n// }\n//(<any>window).trace = trace;","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { ITransitionData } from '../model/IVFData';\n\nexport class JumpToNextSceneTask extends BaseTask {\n        \n        public component: VFComponent;\n        public transition?: ITransitionData;\n\n        constructor(compontent: VFComponent, transition?: ITransitionData) {\n            super();\n            this.component = compontent;\n            this.transition = transition;\n        }   \n\n        public run(): void {\n            super.run();\n            const vfStage = this.component.vfStage;\n            if (vfStage) {\n                vfStage.switchToNextScene(this.transition);\n                this.complete();\n            } else {\n                this.complete();\n            }\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { ITransitionData } from '../model/IVFData';\n\nexport class JumpToPrevSceneTask extends BaseTask {\n        \n        public component: VFComponent;\n        public transition?: ITransitionData;\n\n        constructor(compontent: VFComponent, transition?: ITransitionData) {\n            super();\n            this.component = compontent;\n            this.transition = transition;\n        }   \n\n        public run(): void {\n            super.run();\n            const vfStage = this.component.vfStage;\n            if (vfStage) {\n                vfStage.switchToPrevScene(this.transition);\n                this.complete();\n            } else {\n                this.complete();\n            }\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { ITransitionData } from '../model/IVFData';\n\nexport class JumpToSceneTask extends BaseTask {\n        \n        public component: VFComponent;\n        public sceneId: string;\n        public transition?: ITransitionData;\n\n        constructor(compontent: VFComponent, sceneId: string, transition?: ITransitionData) {\n            super();\n            this.component = compontent;\n            this.sceneId = sceneId;\n            this.transition = transition;\n        }   \n\n        public run(): void {\n            super.run();\n            const vfStage = this.component.vfStage;\n            if (vfStage) {\n                vfStage.switchToSceneId(this.sceneId, this.transition);\n                this.complete();\n            } else {\n                this.complete();\n            }\n            \n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\n\nexport class ArrayPopTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n\n        constructor(compontent: VFComponent, data: IAction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    arrItem.value.pop();\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\n\nexport class ArrayPushTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n\n        constructor(compontent: VFComponent, data: IAction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    const arr = arrItem.value;\n                    arr.push(this.data.value);\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionArraySplice } from '../model/IVFData';\n\nexport class ArraySpliceTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionArraySplice;\n\n        constructor(compontent: VFComponent, data: IActionArraySplice) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    const value = this.data.value;\n                    if (value !== undefined) {\n                        arrItem.value.splice(this.data.start, this.data.deleteCount || 0, value);\n                    } else {\n                        arrItem.value.splice(this.data.start, this.data.deleteCount || 0);\n                    }\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\n\nexport class ArrayRandomTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n\n        constructor(compontent: VFComponent, data: IAction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    const arr = arrItem.value;\n                    variableManager.shuffle(arr);\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\n\nexport class ArrayInitTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n\n        constructor(compontent: VFComponent, data: IAction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    arrItem.value = this.data.value;\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionArraySplice, IActionArrayConcat } from '../model/IVFData';\n\nexport class ArrayConcatTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionArrayConcat;\n\n        constructor(compontent: VFComponent, data: IActionArrayConcat) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                const concatItem = variableManager.getVariableByData(this.component, this.data.concatArr);\n                if (arrItem && concatItem) {\n                    if (this.data.value) {\n                        arrItem.value = concatItem.value.concat(this.data.value);\n                    } else {\n                        arrItem.value = concatItem.value.concat();\n                    }\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\n\nexport class ArrayShiftTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n\n        constructor(compontent: VFComponent, data: IAction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    arrItem.value.shift();\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\n\nexport class ArrayUnshiftTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n\n        constructor(compontent: VFComponent, data: IAction) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage && this.data.target) {\n                const variableManager = this.component.vfStage.variableManager;\n                const arrItem = variableManager.getVariableByData(this.component, this.data.target);\n                if (arrItem) {\n                    const arr = arrItem.value;\n                    arr.unshift(this.data.value);\n                }\n            }\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionDefineVariable} from '../model/IVFData';\nimport { getTargetComponent } from '../../utils/VFUtil';\n\nexport class DefineVariableTask extends BaseTask {\n        \n        public component: VFComponent;\n        public data: IActionDefineVariable;\n\n        constructor(compontent: VFComponent, data: IActionDefineVariable) {\n            super();\n            this.component = compontent;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component && this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                const targetComponent: VFComponent = getTargetComponent(this.component, \n                                                                        this.data.target) as VFComponent;\n                if (targetComponent) {\n                    variableManager.addVariableDataToComponent(targetComponent, \n                                                               this.data.varId, \n                                                               this.data.variableType,\n                                                               this.data.value);\n                } else {\n                    variableManager.addVariableDataToGlobal( \n                                                            this.data.varId, \n                                                            this.data.variableType,\n                                                            this.data.value);\n                }\n            }\n            \n\n            this.complete();\n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionPlaySound } from '../model/IVFData';\n\nexport class PauseSoundTask extends BaseTask {\n        \n        public component: VFComponent;\n        public soundId: number | any[];\n        public trackId: string = '-1';\n        private data: IActionPlaySound;\n\n        constructor(compontent: VFComponent, soundId: number | any[], trackId?: string, data ?: any) {\n            super();\n            this.component = compontent;\n            this.soundId = soundId;\n            this.data = data;\n            if (trackId) {\n                this.trackId = trackId;\n            }\n            \n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage) {\n                const soundManager = this.component.vfStage.soundManager;\n                const variableManager = this.component.vfStage.variableManager;\n                let soundId: number = 0;\n                if (Array.isArray(this.soundId)) {\n                    const soundIdVar = variableManager.getExpressItemValue(this.component, this.soundId);\n                    if (soundIdVar && soundIdVar.value) {\n                        soundId = soundIdVar.value;\n                    } else {\n                        soundId = soundIdVar;\n                    }\n                } else {\n                    soundId = this.soundId;\n                }\n                \n                soundManager.pauseSound(soundId, this.trackId, this.data);\n                this.complete();\n            } else {\n                this.complete();\n            }\n            \n        }\n    }\n\n","import { BaseTask } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IActionPlaySound } from '../model/IVFData';\n\nexport class ResumeSoundTask extends BaseTask {\n        \n        public component: VFComponent;\n        public soundId: number | any[];\n        public trackId: string = '-1';\n        private data: IActionPlaySound;\n\n        constructor(compontent: VFComponent, soundId: number | any[], trackId?: string, data ?: any) {\n            super();\n            this.component = compontent;\n            this.soundId = soundId;\n            this.data = data;\n            if (trackId) {\n                this.trackId = trackId;\n            }\n            \n        }   \n\n        public run(): void {\n            super.run();\n            if (this.component.vfStage) {\n                const soundManager = this.component.vfStage.soundManager;\n                const variableManager = this.component.vfStage.variableManager;\n                let soundId: number = 0;\n                if (Array.isArray(this.soundId)) {\n                    const soundIdVar = variableManager.getExpressItemValue(this.component, this.soundId);\n                    if (soundIdVar && soundIdVar.value) {\n                        soundId = soundIdVar.value;\n                    } else {\n                        soundId = soundIdVar;\n                    }\n                } else {\n                    soundId = this.soundId;\n                }\n\n                soundManager.resumeSound(soundId, this.trackId, this.data);\n                this.complete();\n            } else {\n                this.complete();\n            }\n            \n        }\n    }\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\n\nexport class BreakTask extends BaseTask {\n        \n\n        constructor() {\n            super();\n        }   \n\n        public run(): void {\n            super.run();\n            this.break();\n            this.complete();\n        }\n    }\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\nimport { isNumber } from '../../utils/VFUtil';\n\nexport class WaitTask extends BaseTask {\n        \n    public component: VFComponent;\n    public data: IAction;\n    private timeoutHandler?: vf.gui.Scheduler;\n\n    constructor(component: VFComponent, data: IAction) {\n        super();\n        this.component = component;\n        this.data = data;\n    }   \n\n    private get timeout(): number {\n        let time: number = 0;\n        if (Array.isArray(this.data.value)) {\n            if (this.component && this.component.vfStage) {\n                const variableManager = this.component.vfStage.variableManager;\n                time = variableManager.getExpressItemValue(this.component, this.data.value);\n            }\n            \n        } else {\n            time = this.data.value;\n        }\n        if (!isNumber(time)) {\n            time = 1;\n        }\n        return time;\n    }\n\n    public run(): void {\n        super.run();\n        const timeout = this.timeout;\n        this.timeoutHandler = vf.gui.Scheduler.setTimeout(timeout, () => {\n            if (this.timeoutHandler) {\n                this.timeoutHandler.stop();\n                this.timeoutHandler = undefined;\n            }\n            \n            this.complete();\n        });\n    }\n}\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\nimport { isNumber } from '../../utils/VFUtil';\nimport { ContainerTask } from './core/ContainerTask';\n\nexport class SetTimeoutTask extends ContainerTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n        private timeoutHandler?: vf.gui.Scheduler;\n\n        constructor(component: VFComponent, data: IAction) {\n            super();\n            this.component = component;\n            this.data = data;\n        }   \n\n        private get timeout(): number {\n            let time: number = 0;\n            if (Array.isArray(this.data.value)) {\n                if (this.component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    time = variableManager.getExpressItemValue(this.component, this.data.value);\n                }\n                \n            } else {\n                time = this.data.value;\n            }\n            if (!isNumber(time)) {\n                time = 1;\n            }\n            return time;\n        }\n\n        public run(): void {\n            super.run();\n            const timeout = this.timeout;\n            this.timeoutHandler = vf.gui.Scheduler.setTimeout(timeout, () => {\n                if (this.timeoutHandler) {\n                    this.timeoutHandler.stop();\n                    this.timeoutHandler = undefined;\n                }\n                if (this.loopTask) {\n                    this.loopTask.run();\n                }   \n            });\n\n            this.complete();\n        }\n    }\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction, IActionInterval } from '../model/IVFData';\nimport { isNumber } from '../../utils/VFUtil';\nimport { ContainerTask } from './core/ContainerTask';\n\nexport class SetIntervalTask extends ContainerTask {\n        \n        public component: VFComponent;\n        public data: IActionInterval;\n        private timeoutHandler?: vf.gui.Scheduler;\n        private lastTimes: number = 0;\n        private loopTaskComplete: boolean = true;\n        private intervalComplete: boolean = true;\n        private _timeout: number = 0;\n        private _times: number = 1;\n        constructor(component: VFComponent, data: IActionInterval) {\n            super();\n            this.component = component;\n            this.data = data;\n        }   \n\n        private get timeout(): number {\n            let time: number = 0;\n            if (Array.isArray(this.data.value)) {\n                if (this.component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    time = variableManager.getExpressItemValue(this.component, this.data.value);\n                }\n            } else {\n                time = this.data.value;\n            }\n            if (!isNumber(time)) {\n                time = 1;\n            }\n            return time;\n        }\n\n        private get times(): number {\n            let times: number = 0;\n            if (Array.isArray(this.data.times)) {\n                if (this.component && this.component.vfStage) {\n                    const variableManager = this.component.vfStage.variableManager;\n                    times = variableManager.getExpressItemValue(this.component, this.data.times);\n                }\n                \n            } else {\n                if (this.data.times === undefined) {\n                    times = 0;\n                } else {\n                    times = this.data.times;\n                }\n                \n            }\n            if (!isNumber(times)) {\n                times = 0;\n            }\n            return times;\n        }\n\n        public run(): void {\n            super.run();\n            this._timeout = this.timeout;\n            this._times = this.times;\n            this.lastTimes = this._times;\n            if (this.loopTask) {\n                this.loopTask.addListener(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n            }\n            \n            this.runOnce(this._timeout, this._times);\n        }\n\n        public complete(): void {\n            \n            super.complete();\n            if (this.timeoutHandler) {\n                this.timeoutHandler.stop();\n                this.timeoutHandler = undefined;\n            }\n            if (this.loopTask) {\n                this.loopTask.removeListener(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n            }\n        }\n\n        public stop(): void {\n            super.stop();\n            this.complete();\n        }\n\n        public resume(): void {\n            if (this._isPaused) {\n                if (this.loopTaskComplete && this.intervalComplete) {\n                    this.checkComplete(this._timeout, this._times);\n                }\n            }\n            super.resume();\n        }\n        private onLoopComplete(): void {\n            this.loopTaskComplete = true;\n            if (this.intervalComplete) {\n                this.checkComplete(this._timeout, this._times);\n            }\n        }\n\n        private runOnce(timeout: number, times: number): void {  \n            this.intervalComplete = false;\n            if (this.timeoutHandler === undefined) {\n                this.timeoutHandler = vf.gui.Scheduler.setTimeout(timeout, () => {\n                    this.intervalComplete = true;\n                    if (this.timeoutHandler) {\n                        this.timeoutHandler.stop();\n                    }\n    \n                    if (this.loopTaskComplete && this.intervalComplete) {\n                        this.checkComplete(timeout, times);\n                    }\n                });\n            } else {\n                this.timeoutHandler.restart();\n            }\n            \n            \n        }\n\n        private checkComplete(timeout: number, times: number): void {\n            if (this._isPaused || this._isCompleted) {\n                return;\n            }\n            let isComplete: boolean = false;\n            if (times > 0) {\n                if (this.lastTimes > 0) {\n                    isComplete =  false;\n                } else {\n                    isComplete =  true;\n                }\n            } else {\n                isComplete =  false;\n            }\n\n            if (isComplete) {\n                this.complete();\n            } else {\n                this.lastTimes--;\n                if (this.loopTask) {\n                    this.loopTaskComplete = false;\n                    this.runOnce(timeout, times);\n                    this.loopTask.run();\n                    \n                } else {\n                    this.complete();\n                }\n            }\n        }\n    }\n\n","import { BaseTask, TaskEvent } from './core/BaseTask';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAction } from '../model/IVFData';\nimport { isNumber } from '../../utils/VFUtil';\nimport { ContainerTask } from './core/ContainerTask';\n\nexport class EnterFrameTask extends ContainerTask {\n        \n        public component: VFComponent;\n        public data: IAction;\n        private loopTaskComplete: boolean = true;\n\n        constructor(component: VFComponent, data: IAction) {\n            super();\n            this.component = component;\n            this.data = data;\n        }   \n\n        public run(): void {\n            super.run();\n\n            if (this.component) {\n                const vfStage = this.component.vfStage;\n                if (vfStage && vfStage.app) {\n                    if (this.loopTask) {\n                        this.loopTask.addListener(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n                    }\n                    vfStage.app.ticker.add(this.tick, this);\n                } else {\n                    this.complete();\n                }\n            } else {\n                this.complete();\n            }\n        }\n\n        public complete(): void {\n            super.complete();\n            if (this.loopTask) {\n                this.loopTask.removeListener(TaskEvent.EVENT_COMPLETE, this.onLoopComplete, this);\n            }\n            if (this.component) {\n                const vfStage = this.component.vfStage;\n                if (vfStage && vfStage.app) {\n                    vfStage.app.ticker.remove(this.tick, this);\n                }\n            }\n        }\n        public stop(): void {\n            super.stop();\n            this.complete();\n        }\n\n        public pause(): void {\n            super.pause();\n            if (this.component) {\n                const vfStage = this.component.vfStage;\n                if (vfStage && vfStage.app) {\n                    vfStage.app.ticker.remove(this.tick, this);\n                }\n            }\n        }\n\n        public resume(): void {\n            if (this._isPaused) {\n                if (this.component) {\n                    const vfStage = this.component.vfStage;\n                    if (vfStage && vfStage.app) {\n                        vfStage.app.ticker.add(this.tick, this);\n                    }\n                }\n            }\n            super.resume();\n        }\n\n        private onLoopComplete(): void {\n            this.loopTaskComplete = true;\n        }\n        private tick(): void {\n            if (this.loopTaskComplete) {\n                if (this.loopTask) {\n                    this.loopTask.run();\n                }\n            }\n        }\n    }\n\n","import { AnimationClip } from './AnimationClip';\nimport { VFComponent } from '../../display/VFComponent';\nimport { IAnimation, ITimeline, TimelineType, IFrame, ISubAnimation, AnimationEvent, AnimationStatus } from '../model/IVFData';\nimport { Timeline } from './Timeline';\nimport { NumberFrame } from './NumberFrame';\nimport { BooleanFrame } from './BooleanFrame';\nimport { StringFrame } from './StringFrame';\nimport { ColorFrame } from './ColorFrame';\nimport { Frame } from './Frame';\nimport { EventTimeline } from './EventTimeline';\nimport { EventFrame } from './EventFrame';\n\nexport class Animation {\n\n        private animationMap: {[name: string]: AnimationClip[]} = {};\n        private animationConfig: {[name: string]: {loop?: boolean, totalTime: number, autoPlay?: boolean}} = {};\n\n        private status: number = AnimationStatus.STOP;\n        private curAnimationClips: AnimationClip[] = [];\n\n        private realFPS: boolean = false;\n        private curTime: number = 0;\n        private lastTime: number = 0;\n        private curPlayTime: number = 0;\n        private startTime: number = 0;\n        private passedTime: number = 0;\n        private component: VFComponent;\n        private data: IAnimation[];\n        private minDeltaT: number = 33;\n        private deltaT: number = 0;\n        private fps: number = 30;\n        private curAnimatinName: string = '';\n        private curAnimatinDuration: number = 0;\n        private curAnimatinDurationTime: number = 0;\n        private curAnimationTimes: number = 0;\n        private curAnimationTotalTime: number = 0;\n        private _curPlayTimes: number = 0;\n\n        constructor(component: VFComponent, data: IAnimation[], fps: number = 30) {\n            this.component = component;\n            this.data = data;\n            if (fps > 0) {\n                this.fps = fps;\n            }\n            this.minDeltaT = Math.ceil(1000 / this.fps);\n            this.deltaT = 0;\n            this.parseData();\n        }\n\n        public addAnimationClip(clip: AnimationClip): void {\n            const name = clip.name;\n            let animations = this.animationMap[name];\n            if (animations == null) {\n                animations = [];\n                this.animationMap[name] = animations;\n            }\n            animations.push(clip);\n        }\n\n        public getPauseData(): {animation: string, frame: number, times: number} | undefined {\n            if (this.status === AnimationStatus.PLAYING) {\n                return {\n                    animation: this.curAnimatinName,\n                    frame: Math.round(this.curPlayTime * this.fps / 1000),\n                    times: this.curAnimationTimes <= 0 ? \n                                this.curAnimationTimes : \n                                (this.curAnimationTimes - this._curPlayTimes),\n                };\n            }\n            return undefined;\n        }\n        public playDefaultAnimation(): void {\n            if (this.status === AnimationStatus.PLAYING) {\n                return;\n            }\n            for ( const name in this.animationConfig) {\n                if (this.animationConfig[name]) {\n                    const config = this.animationConfig[name];\n                    if (config.autoPlay) {\n                        this.play(name, config.loop ? -1 : 1);\n                        break;\n                    }\n                }\n            }\n        }\n\n        public gotoPlay(name: string, frameIndex: number, times: number = 1): void  {\n            if (this.status === AnimationStatus.PLAYING) {\n                this.stop();\n            }\n            const config = this.animationConfig[name];\n            if (config) {\n                this.curAnimatinDuration = config.totalTime;\n            } else {\n                // tslint:disable-next-line: no-console\n                console.warn('can not find animation:', name);\n                return;\n            }\n            this.curAnimatinName = name;\n            this.curAnimationClips = this.animationMap[name];\n            this.curAnimationTimes = times;\n            this.curAnimationTotalTime = Math.round(this.curAnimatinDuration * \n                                                    this.curAnimationTimes * (1000 / this.fps));\n            this.curAnimatinDurationTime = Math.round(this.curAnimatinDuration * 1000 / this.fps);\n            this.curPlayTime = frameIndex * (1000 / this.fps);\n            this.deltaT = 0;\n            this.setCurTime(this.curPlayTime);\n            this.status = AnimationStatus.PLAYING;\n            this.startTime = new Date().getTime();\n            this.curTime = this.startTime;\n            this.lastTime = this.startTime;\n            this.startTime -= this.curPlayTime;\n            this._curPlayTimes = 0;\n            vf.Ticker.shared.add(this.tick, this);\n        }\n        public gotoStop(name: string, frameIndex: number): void {\n            if (this.status === AnimationStatus.PLAYING) {\n                this.stop();\n            }\n            const config = this.animationConfig[name];\n            if (config) {\n                this.curAnimatinDuration = config.totalTime;\n            } else {\n                // tslint:disable-next-line: no-console\n                console.warn('can not find animation:', name);\n                return;\n            }\n\n            this.curAnimationClips = this.animationMap[name];\n            this.curAnimationTimes = 1;\n            this.curAnimationTotalTime = Math.round(this.curAnimatinDuration * \n                                                    this.curAnimationTimes * (1000 / this.fps));\n            this.curAnimatinDurationTime = Math.round(this.curAnimatinDuration * 1000 / this.fps);\n            this.curPlayTime = frameIndex * (1000 / this.fps);\n            this.deltaT = 0;\n            this.setCurTime(this.curPlayTime);\n            this.status = AnimationStatus.STOP;\n            this.startTime = new Date().getTime();\n            this.curTime = this.startTime;\n            this.lastTime = this.startTime;\n            this.startTime -= this.curPlayTime;\n            this._curPlayTimes = 0;\n            this.tick();\n        }\n\n        public play(name: string, times: number = 1): void {\n           this.gotoPlay(name, 0, times);\n        }\n\n        public stop(): void {\n            vf.Ticker.shared.remove(this.tick, this);\n            this.status = AnimationStatus.STOP;\n            this.skipNextEvent();\n        }\n\n        protected set curPlayTimes(v: number) {\n            if (v !== this._curPlayTimes) {\n                this._curPlayTimes = v;\n                if (this.component) {\n                    this.component.emit(AnimationEvent.AnimationLoopComplete, v);\n                    if (this.curAnimationTimes > 0 && this._curPlayTimes >= this.curAnimationTimes) {\n                        this.component.emit(AnimationEvent.AnimationComplete);\n                    }\n                }\n            }\n        }\n        protected tick(): void {\n            const curTime = new Date().getTime();\n            this.curTime = curTime;\n            const dt = this.curTime - this.lastTime;\n            this.curPlayTime += dt;\n            if (this.realFPS) {\n                this.deltaT += dt;\n                if (this.deltaT < this.minDeltaT) {\n                    this.lastTime = this.curTime;\n                    this.passedTime = this.curTime - this.startTime;\n\n                    if (this.curAnimationTimes > 0 && \n                        this.passedTime > this.curAnimationTotalTime) {\n                        this.stop();\n                    }\n                    this.curPlayTimes = Math.floor(this.passedTime / this.curAnimatinDurationTime);\n                    return;\n                }\n                while (this.deltaT > this.minDeltaT) {\n                    this.deltaT -= this.minDeltaT;\n                }\n            }\n            if (this.curPlayTime > this.curAnimatinDurationTime) {\n                if (this.curAnimationTimes < 0 || // 循环播放\n                    this.curAnimationTimes > 1 && this._curPlayTimes < this.curAnimationTimes - 1) { // 非最后一次播放\n                    this.curPlayTime = this.curPlayTime % this.curAnimatinDurationTime;\n                }\n            }\n            this.setCurTime(this.curPlayTime);\n\n            this.lastTime = this.curTime;\n            this.passedTime = this.curTime - this.startTime;\n\n            if (this.curAnimationTimes > 0 && \n                this.passedTime > this.curAnimationTotalTime) {\n                this.stop();\n            }\n            this.curPlayTimes = Math.floor(this.passedTime / this.curAnimatinDurationTime);\n            \n        }\n\n        protected setCurTime(curTime: number): void { \n            if (this.curAnimationClips) {\n                for (let i: number = 0, len: number = this.curAnimationClips.length; i < len; i++) {\n                    const clip = this.curAnimationClips[i];\n                    clip.curTime = curTime;\n                }\n            }\n        }\n\n        protected skipNextEvent(): void {\n            if (this.curAnimationClips) {\n                for (let i: number = 0, len: number = this.curAnimationClips.length; i < len; i++) {\n                    const clip = this.curAnimationClips[i];\n                    clip.skipNextEvent();\n                }\n            }\n        }\n        //  parse\n        private parseData(): void {\n            if (this.component && this.data) {\n                for (let i: number = 0, len: number = this.data.length; i < len; i++) {\n                    this.parseAnimation(this.data[i]);\n                }\n            }\n        }\n\n        private parseAnimation(anim: IAnimation): void {\n            const name = anim.name;\n            const totalTime = anim.duration || 0;\n            const loop = anim.loop;\n            const autoPlay = anim.autoPlay;\n\n            const config = {\n                loop,\n                totalTime,\n                autoPlay,\n            };\n            this.animationConfig[name] = config;\n            let duration: number = 0;\n            for (const key in anim.children) {\n                if (anim.children[key]) {\n                    const ac = this.parseAnimationClip( key, name, anim.children[key]);\n                    if (ac && ac.totalTime > duration) {\n                        duration = ac.totalTime;\n                    }\n                }\n            }\n\n            if (!anim.duration || anim.duration <= 0) {\n                anim.duration = duration;\n                config.totalTime = duration;\n            }\n        }\n\n        private parseAnimationClip(componentId: string, animName: string, \n                                   subAnimation: ISubAnimation): AnimationClip | undefined {\n            const childId = componentId;\n            let component: vf.gui.DisplayObject;\n            if (childId === TimelineType.EVENT) {\n                component = this.component;\n            } else {\n                component = this.component.getChildById(childId);\n            }\n            if (component) {\n                const animClip = new AnimationClip(animName);\n                animClip.name = animName;\n                animClip.fps = this.fps;\n                animClip.target = component;\n                animClip.totalTime = subAnimation.duration || 0;\n                animClip.loop = !!subAnimation.loop;\n                let duration: number = 0;\n                for (let i: number = 0, len: number = subAnimation.timelines.length; i < len; i++) {\n                    const timelineData = subAnimation.timelines[i];\n                    const timeline = this.parseTimeline(timelineData, subAnimation.duration);\n                    if (timeline) {\n                        animClip.timelines.push(timeline);\n                        if (timeline.totalTime > duration) {\n                            duration = timeline.totalTime;\n                        }\n                    }\n                }\n                \n                if (!animClip.totalTime || animClip.totalTime <= 0) {\n                    animClip.totalTime = duration;\n                }\n                this.addAnimationClip(animClip);\n                return animClip;\n            }\n        }\n\n        private parseTimeline(data: ITimeline, duration: number = -1): Timeline<any> {\n            let timeline: Timeline<any>;\n\n            switch (data.type) {\n                case TimelineType.X:\n                case TimelineType.Y:\n                case TimelineType.SCALE_X:\n                case TimelineType.SCALE_Y:\n                case TimelineType.ROTATION:\n                case TimelineType.SKEW_X:\n                case TimelineType.SKEW_Y:\n                case TimelineType.ALPHA:\n                case TimelineType.PROGRESS:\n                case TimelineType.ALPHA:\n                case TimelineType.VOLUME:\n                case TimelineType.FITERBLUR:   \n                    timeline = new Timeline<number>();\n                    this.parseFrames(timeline, data.frames, NumberFrame);\n                    break;\n                case TimelineType.VISIBLE:\n                case TimelineType.ENABLED:\n                    timeline = new Timeline<boolean>();\n                    this.parseFrames(timeline, data.frames, BooleanFrame);\n                    break;\n                case TimelineType.TEXT:\n                case TimelineType.PLAY:\n                    timeline = new Timeline<string>();\n                    this.parseFrames(timeline, data.frames, StringFrame);\n                    break;\n                case TimelineType.COLOR:\n                    timeline = new Timeline<number>();\n                    this.parseFrames(timeline, data.frames, ColorFrame);\n                    break;\n                case TimelineType.EVENT:\n                    timeline = new EventTimeline();\n                    this.parseFrames(timeline, data.frames, EventFrame);\n                    break;\n                default:\n                    timeline = new Timeline<number>();\n                    this.parseFrames(timeline, data.frames, NumberFrame);\n                    break;\n            }\n            if (timeline) {\n                timeline.type = data.type;\n                timeline.loop = !!data.loop;\n                if (data.frames && data.frames.length) {\n                    timeline.totalTime = data.frames[data.frames.length - 1].frame;\n                } else {\n                    timeline.totalTime = 0;\n                }\n                \n            }\n            return timeline;\n        }\n        private parseFrames(timeline: Timeline<any>, data: IFrame[], frameClass: new () => Frame<any>): void {\n            for (let i: number = 0, len: number = data.length; i < len; i++) {\n                const frameData = data[i];\n                const frame = new frameClass();\n                frame.time = frameData.frame;\n                frame.curve = frameData.curve;\n                frame.value = frameData.value;\n                timeline.frames.push(frame);\n            }\n        }\n    }\n\n","import { Timeline } from './Timeline';\nimport { TimelineType, IEventData } from '../model/IVFData';\nimport { VFComponent } from '../../display/VFComponent';\nimport { EventTimeline } from './EventTimeline';\n\nexport class AnimationClip {\n\n        private get targetDisplay(): vf.gui.DisplayObject {\n            return this.target as vf.gui.DisplayObject;\n        }\n\n        public set curTime(v: number) {\n            this._curTime = v;\n            this._curFrame = this._curTime * this.fps / 1000;\n            if (this.loop) {\n                this._curFrame = this._curFrame % this.totalTime;\n            }\n            for (let i = 0, len = this.timelines.length; i < len; i++) {\n                this.timelines[i].globalTime = this._curFrame;\n            }\n            this.applyTimeline();\n        }\n\n        public name: string;\n        public timelines: Array<Timeline<any>> = [];\n        public fps: number = 30;\n        public target: any;\n        public totalTime: number = 0;\n        public loop: boolean = false;\n        private _curTime: number = 0;\n        private _curFrame: number = 0;\n        constructor(name: string) {\n            this.name = name;\n        }\n\n        public skipNextEvent(): void {\n            for (let i = 0, len = this.timelines.length; i < len; i++) {\n                const timeline = this.timelines[i];\n                if (timeline instanceof EventTimeline) {\n                    timeline.skipNextEmit();\n                }\n            }\n        }\n        private applyTimeline(): void {\n            if (this.target == null) {\n                return;\n            }\n            for (let i: number = 0, len: number = this.timelines.length; i < len; i++) {\n                const timeline = this.timelines[i];\n                const targetDisplay = this.targetDisplay;\n                const curValue = timeline.curValue;\n                switch (timeline.type) {\n                    case TimelineType.X:\n                        targetDisplay.x = curValue;\n                        break;\n                    case TimelineType.Y:\n                        targetDisplay.y = curValue;\n                        break;\n                    case TimelineType.SCALE_X:\n                        targetDisplay.scaleX = curValue;\n                        break;\n                    case TimelineType.SCALE_Y:\n                        targetDisplay.scaleY = curValue;\n                        break;\n                    case TimelineType.ROTATION:\n                        targetDisplay.rotation = curValue;\n                        break; \n                    case TimelineType.VISIBLE:\n                        targetDisplay.visible = curValue;\n                        break;\n                    case TimelineType.ALPHA:\n                        targetDisplay.alpha = curValue;\n                        break;\n                    case TimelineType.TEXT:\n                        (targetDisplay as vf.gui.Label).text = curValue;\n                        break;\n                    case TimelineType.ENABLED:\n                        targetDisplay.enabled = curValue;\n                        break;\n                    case TimelineType.FITERBLUR:\n                        targetDisplay.filterBlur = curValue;\n                        break;\n                    case TimelineType.EVENT:\n                        const events = curValue as IEventData[];\n                        if (events) {\n                            for (let j: number = 0, jlen: number = events.length; j < jlen; j++) {\n                                const event = events[j];\n                                (targetDisplay as VFComponent).emit(event.type, event.data);\n                            }\n                        }\n                        break;\n                    default:\n                        if (timeline.type.indexOf('filter') === 0) {\n                            this.applyFilter(targetDisplay, timeline.type, curValue);\n                        } else {\n                            (targetDisplay as any)[timeline.type] = curValue;\n                        }\n                        break;\n                    \n                }\n            }\n        }\n        private applyFilter(display: vf.gui.DisplayObject, filterKey: string, value: any): void {\n            const filterKeys = filterKey.split('.');\n            let target = display as any;\n            for (let i: number = 0, len: number = filterKeys.length; i < len - 1 ; i++) {\n                const curkey = filterKeys[i];\n                if (target && target[curkey]) {\n                    target = target[curkey];\n                }\n            }\n            if (target) {\n                target[filterKeys[filterKeys.length - 1]] = value;\n            }\n            \n        }\n    }\n\n","import { Frame } from './Frame';\n\nexport class NumberFrame extends Frame<number> {\n\n        constructor() {\n            super();\n        }\n\n        public getValue(progress: number, value: number): number {\n            return this.value + (value - this.value) * progress;\n        }\n    }\n","import { Frame } from './Frame';\n\nexport class BooleanFrame extends Frame<boolean> {\n\n        constructor() {\n            super();\n        }\n\n        public getValue(progress: number, value: boolean): boolean {\n            return this.value;\n        }\n    }\n\n","import { Frame } from './Frame';\n\nexport class StringFrame extends Frame<string> {\n\n        constructor() {\n            super();\n        }\n\n        public getValue(progress: number, value: string): string {\n            return this.value;\n        }\n    }\n\n","import { Frame } from './Frame';\n\nexport class ColorFrame extends Frame<number> {\n\n        constructor() {\n            super();\n        }\n\n        public getValue(progress: number, value: number): number {\n            const rgbData = this.changeColor2RGB(this.value);\n            const rgbValue = this.changeColor2RGB(value);\n            const resultArr = [\n                rgbData[0] + (rgbValue[0] - rgbValue[0]) * progress,\n                rgbData[1] + (rgbValue[1] - rgbValue[1]) * progress,\n                rgbData[2] + (rgbValue[2] - rgbValue[2]) * progress,\n            ];\n            return this.changeRGB2Color(resultArr);\n        }\n\n        protected changeColor2RGB(color: number): number[] {\n            // tslint:disable-next-line: no-bitwise\n            const r = (color >> 16) & 0xFF;\n            // tslint:disable-next-line: no-bitwise\n            const g = (color >> 8) & 0xFF;\n            // tslint:disable-next-line: no-bitwise\n            const b = (color >> 0) & 0xFF;\n            return [r, g, b];\n        }\n        protected changeRGB2Color(rgb: number[]): number {\n            return rgb[0] * 0x10000 + rgb[1] * 0x100 + rgb[2];\n        } \n    }\n\n","import { Frame } from './Frame';\nimport { IEventData } from '../model/IVFData';\n\nexport class EventFrame extends Frame<IEventData[]> {\n\n        constructor() {\n            super();\n        }\n\n        public getValue(progress: number, value: IEventData[]): IEventData[] {\n            return this.value;\n        }\n    }\n\n","/**\n * 获取加载文件的扩展名\n */\nexport function getFileExtension(url: string){\n    const isDataUrl = url.indexOf('data:') === 0;\n    let ext = '';\n\n    if (isDataUrl){\n        const slashIndex = url.indexOf('/');\n\n        ext = url.substring(slashIndex + 1, url.indexOf(';', slashIndex));\n    }else{\n        const queryStart = url.indexOf('?');\n        const hashStart = url.indexOf('#');\n        const index = Math.min(\n            queryStart > -1 ? queryStart : url.length,\n            hashStart > -1 ? hashStart : url.length\n        );\n\n        url = url.substring(0, index);\n        ext = url.substring(url.lastIndexOf('.') + 1);\n    }\n\n    return ext.toLowerCase();\n}","export  { BoardDrawPlug } from './BoardDrawPlug';\nexport  { SliderEditorPlug } from './SliderEditorPlug';\n\n\nexport class PlugIndex {\n    constructor() {\n        //\n    }\n}\n\n","import { VFStage } from '../VFStage';\nimport {Plug } from './Plug';\nimport { EventLevel } from '../../event/EventLevel';\nimport { EventType } from '../../event/EventType';\n\n/** \n * 画板插件 \n * @author yangxiao \n */\nexport class BoardDrawPlug extends Plug {\n\n    private followLine?: vf.gui.FollowLine;\n\n    constructor(className: string, parent: VFStage) {\n        super(className, parent);\n    }\n\n    public onLoad(data: any) {\n        const { parent } = this;\n        this.followLine = new vf.gui.FollowLine(parent as any);\n        const followLine = this.followLine;\n        followLine.role =  data.role === 1 ? \n        vf.gui.Enum.FollowLineEnum.Role.teacher : \n        vf.gui.Enum.FollowLineEnum.Role.student;\n        followLine.width = parent.width;\n        followLine.height = parent.height;\n        parent.addChild(followLine);\n\n        followLine.on(vf.gui.Interaction.ComponentEvent.COMPLETE, this.onComplete, this);\n\n        parent.config.systemEvent.on(EventType.MESSAGE, this.onReceipt, this);\n        return  this;\n    }\n\n    public onRelease() {\n        this.parent.config.systemEvent.off(EventType.MESSAGE, this.onReceipt, this);\n        this.followLine?.off(vf.gui.Interaction.ComponentEvent.COMPLETE, this.onComplete, this);\n        this.followLine?.offAll();\n        this.followLine?.release(); \n    }\n\n    private onComplete(display: vf.gui.FollowLine, data: string) {\n        this.parent.config.systemEvent.emit(EventType.MESSAGE, \n            { \n                type: 'sendSignal', \n                code: 'sendSignal', \n                level : EventLevel.COMMAND , \n                data: {name: 'boardDraw', val: data},\n            });\n    }\n\n    private onReceipt(msg: {type: string, code: string, data: {name: string, val: any}}) {\n        if (msg.data && msg.code === 'sendSignal' &&  this.followLine) {\n            const followLine = this.followLine;\n            if (msg.data.name === 'boardDraw') {\n                followLine.setData(msg.data.val);\n            } else if (msg.data.name === 'boardRestore') { // 重置\n                followLine.reset();\n            } else if (msg.data.name === 'boardErase') { // 橡皮檫\n                followLine.isErasing = msg.data.val;\n            } else if (msg.data.name === 'boardLineColor') { // 线段颜色\n                followLine.lineColor = msg.data.val;\n            }\n            \n        }\n    }\n\n\n}\n","// eslint-disable-next-line no-unused-vars\nimport { VFStage } from '../VFStage';\nimport { Plug } from './Plug';\nimport { EventLevel } from '../../event/EventLevel';\n/** \n * 基于互动课件slider业务的特殊插件，用于解决穿透，鼠标事件等问题\n * @author yangxiao\n */\nexport class SliderEditorPlug extends Plug {\n\n    private dom?: HTMLElement | null;\n    private observer?: MutationObserver;\n\n    constructor(className: string, parent: VFStage) {\n        super(className, parent);\n    }\n\n    protected onLoad(data: any) {\n        \n        let element = document.getElementById('drawCanvas');\n        if(element == null){\n            const canvasContainer = document.getElementsByClassName('canvas-container')[0];\n            if (canvasContainer && canvasContainer.children[1]) {\n                element = canvasContainer.children[1] as HTMLElement;\n            }\n        }\n        if (element == null) {\n            // 无法找到画线，可能是回放模式\n            this.parent.systemEvent.emitError('E0002', ['drawCanvas|canvas-container'], EventLevel.WARNING);\n            return;\n        }\n        this.dom = element;\n        const { parent } = this;\n\n        \n        // tslint:disable-next-line: max-line-length  \n        const MutationObserver = window.MutationObserver || (window as any).WebKitMutationObserver || (window as any).MozMutationObserver;\n        this.observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.type === 'attributes') {\n\n                    const node = mutation.target as any;\n                    const currentCursorMode = parent.app?.renderer.plugins.interaction.currentCursorMode;\n                    if (node.dataset.cursor !== node.style.cursor) {\n                        if (currentCursorMode === 'pointer') {\n                            node.style.cursor = 'pointer';\n                            node.dataset.cursor = node.style.cursor;\n                            return;\n                        }\n                        node.dataset.cursor = node.style.cursor;\n                    }\n                }\n            });\n        });\n        this.observer.observe(element, {\n            attributes: true,  // configure it to listen to attribute changes,\n            attributeFilter: ['style'],\n        });\n\n\n        const defaultCursor = element.style.cursor;\n        parent.app?.renderer.plugins.interaction.setTargetElement(element, parent.app?.renderer.resolution);\n        const cursorStyles: any = parent.app?.renderer.plugins.interaction?.cursorStyles;\n        cursorStyles.default = defaultCursor;\n\n        element.style.display = 'none';\n\n        setTimeout(() => {\n            // BUG 边检检查\n            if(element){element.style.display = ''};\n        }, 60);\n        return this;\n    }\n\n    protected onRelease() {\n\n        this.observer?.disconnect();\n        this.dom = null;\n    }\n\n}\n","import { ScaleMode } from '../core/model/IVFData';\nimport { VFStage } from '../display/VFStage';\n\n/**\n * @private\n * \n * 更新播放器视口尺寸\n * \n * noScale 不对内容进行任何缩放，保持原始的1:1比例。如果播放器窗口比内容小，则可能进行一些裁切。\n * \n * showAll 非溢出居中，显示全部内容。水平或垂直“两侧”可能会不够宽而留有黑边。\n * \n * contain 非溢出，显示全部内容，水平或垂直“一侧”方向有黑边。\n * \n * cover 溢出居中，某些部分也许无法显示在播放器视口。\n */\n// tslint:disable-next-line: max-line-length\nexport default function calculateUpdatePlayerSize(canvas: HTMLCanvasElement, stage: VFStage, scaleMode: ScaleMode, appParentDivName = '', canvasScaleFactor = 1, isWebGl = true) {\n    const top = 0;\n\n    let parentWidth = window.innerWidth;\n    let parentHeight = window.innerHeight;\n\n    if (canvas.parentNode != null) {\n        parentWidth = (canvas.parentNode as HTMLElement).offsetWidth;\n        parentHeight = (canvas.parentNode as HTMLElement).offsetHeight;\n    }\n\n    if (appParentDivName !== '') {\n        if (document.getElementById(appParentDivName) == null) {\n            throw new Error(`Error No find appParentDivName(${appParentDivName})`);\n        }\n        parentWidth = (document.getElementById(appParentDivName) as HTMLElement).offsetWidth;\n        parentHeight = (document.getElementById(appParentDivName) as HTMLElement).offsetHeight;\n    }\n\n    const boundingClientWidth = parentWidth;\n    const boundingClientHeight = parentHeight;\n\n    const screenWidth = boundingClientWidth;\n    const screenHeight = boundingClientHeight;\n\n    const stageSize = calculateStageSize(scaleMode, screenWidth, screenHeight, canvas.width, canvas.height);\n\n    const stageWidth = stageSize.stageWidth;\n    const stageHeight = stageSize.stageHeight;\n    const displayWidth = stageSize.displayWidth;\n    const displayHeight = stageSize.displayHeight;\n\n    canvas.style.transformOrigin = '0% 0% 0px';\n\n    if (canvas.width !== stageWidth) {\n        canvas.width = stageWidth;\n    }\n    if (canvas.height !== stageHeight) {\n        canvas.height = stageHeight;\n    }\n\n    const rotation = 0;\n    canvas.style.top = top + (boundingClientHeight - displayHeight) / 2 + 'px';\n    canvas.style.left = (boundingClientWidth - displayWidth) / 2 + 'px';\n\n    const scalex = displayWidth / stageWidth;\n    const scaley = displayHeight / stageHeight;\n\n    let canvasScaleX = scalex * canvasScaleFactor;\n    let canvasScaleY = scaley * canvasScaleFactor;\n\n    if (!isWebGl) {\n        canvasScaleX = Math.ceil(canvasScaleX);\n        canvasScaleY = Math.ceil(canvasScaleY);\n    }\n\n    const m = new vf.Matrix();\n    m.identity();\n    m.scale(scalex / canvasScaleX, scaley / canvasScaleY);\n    m.rotate(rotation * Math.PI / 180);\n\n    canvas.style.position = 'absolute';\n    canvas.style.transform = `matrix(${m.a},${m.b},${m.c},${m.d},${m.tx},${m.ty})`;\n    canvas.width = stageWidth * canvasScaleX;\n    canvas.height = stageHeight * canvasScaleY;\n\n    stage.scaleX = canvasScaleX;\n    stage.scaleY = canvasScaleY;\n\n    return { width: canvas.width, height: canvas.height, scaleX: canvasScaleX, scaleY: canvasScaleY };\n}\n\n/**\n * @private\n * 计算舞台显示尺寸\n * @param scaleMode 当前的缩放模式\n * @param screenWidth 播放器视口宽度\n * @param screenHeight 播放器视口高度\n * @param contentWidth 初始化内容宽度\n * @param contentHeight 初始化内容高度\n */\nfunction calculateStageSize(\n    scaleMode: ScaleMode,\n    screenWidth: number,\n    screenHeight: number,\n    contentWidth: number,\n    contentHeight: number) {\n\n    let displayWidth = screenWidth;\n    let displayHeight = screenHeight;\n    let stageWidth = contentWidth;\n    let stageHeight = contentHeight;\n    const scaleX = (screenWidth / stageWidth) || 0;\n    const scaleY = (screenHeight / stageHeight) || 0;\n\n    switch (scaleMode) {\n        case 'showAll':\n            if (scaleX > scaleY) {\n                displayWidth = Math.round(stageWidth * scaleY);\n            } else {\n                displayHeight = Math.round(stageHeight * scaleX);\n            }\n            break;\n        case 'cover':\n            if (scaleX > scaleY) {\n                displayHeight = Math.round(stageHeight * scaleX);\n            } else {\n                displayWidth = Math.round(stageWidth * scaleY);\n            }\n            break;\n        case 'contain':\n            if (scaleX > scaleY) {\n                stageWidth = Math.round(screenWidth / scaleY);\n            } else {\n                stageHeight = Math.round(screenHeight / scaleX);\n            }\n            break;\n        default:\n            stageWidth = screenWidth;\n            stageHeight = screenHeight;\n            break;\n    }\n    // 宽高不是2的整数倍会导致图片绘制出现问题\n    if (stageWidth % 2 !== 0) {\n        stageWidth += 1;\n    }\n    if (stageHeight % 2 !== 0) {\n        stageHeight += 1;\n    }\n    if (displayWidth % 2 !== 0) {\n        displayWidth += 1;\n    }\n    if (displayHeight % 2 !== 0) {\n        displayHeight += 1;\n    }\n    return {\n        stageWidth,\n        stageHeight,\n        displayWidth,\n        displayHeight,\n    };\n}\n","/**\n * 外部配置信息\n * - TODO:\n * 封装功能相关信息、参数配置 并提供默认值\n * 当有元素变化时 抛出事件\n * 当有元素异常时 抛出异常\n * - NOTE:\n * 初始化时虽然会抛出属性变化事件，但是vf并没初始化完成，不会受影响\n * 如需抛出更改之前的属性值，需要将事件改为先发 并带上老属性值和设置的value.\n * @author 8088\n */\nimport BaseInfo from './BaseInfo';\nimport {CDN, ScaleMode} from './model/IVFData';\nimport {IVFOptions} from '../IVFEngine';\nimport {Player} from '../Player';\nimport I18N from './I18N';\n\nexport default class Config extends BaseInfo {\n\n    private _container: HTMLElement;\n\n    private _id: string;\n\n    private _src?: string;\n\n    private _play: boolean;\n\n    private _loop: boolean;\n\n    private _menu: boolean;\n\n    private _scaleMode?: ScaleMode;\n\n    private _align: string;\n\n    private _wmode: string;\n\n    private _bgcolor?: string;\n\n    private _vfvars: any = {};\n    \n    private _plugs: any[] = [];\n\n    private _frameRate: number;\n\n    private _width: number;\n\n    private _height: number;\n\n    private _orientation: string;\n\n    private _maxTouches: number;\n\n    private _showFPS: boolean;\n\n    private _showLog: boolean;\n\n    private _logAdvancedTrace: boolean;\n\n    private _conversionData: any;\n\n    private _debug: boolean;\n\n    private _language: string;\n\n    private _i18n: I18N;\n\n    public cdns: CDN;\n\n    constructor(options: IVFOptions) {\n        super();\n        this._container = options.container;\n        this._id = options.id || this.createRandomId();\n        this._src = options.src || undefined;\n        this._play = options.play === undefined ? true : Boolean(options.play);\n        this._loop = options.loop === undefined ? false : Boolean(options.loop);\n        this._menu = options.menu === undefined ? true : Boolean(options.menu);\n        this._scaleMode = options.scaleMode || undefined;\n        this._align = options.align || 'tl';\n        this._wmode = options.wmode || 'transparent';\n        this._bgcolor = options.bgcolor;\n        this._vfvars = options.vfvars || {};\n        this._frameRate = options.frameRate || 30;\n        this._width = options.width || 320;\n        this._height = options.height || 240;\n        this._orientation = options.orientation || 'auto';\n        this._maxTouches = options.maxTouches || 2;\n        this._showFPS = options.showFPS === undefined ? true : Boolean(options.showFPS);\n        this._showLog = options.showLog === undefined ? true : Boolean(options.showLog);\n        this._conversionData = options.conversionData;\n        this._debug = options.debug || false; \n        this._plugs = options.plugs || this._plugs;\n        this._logAdvancedTrace = options.logAdvancedTrace || false;\n        this.cdns = Array.isArray(options.vfvars.cdns) ? {default:options.vfvars.cdns} : options.vfvars.cdns;\n        if(this.cdns.image === undefined){\n            this.cdns.image = this.cdns.default.concat();\n        }\n        if(this.cdns.media === undefined){\n            this.cdns.media = this.cdns.default.concat();\n        }\n        if(this.cdns.wx === undefined){\n            this.cdns.wx = this.cdns.default.concat();\n        }\n        this._language = options.language || Player.system.language;\n        this._i18n = new I18N(this._language);\n        this.output('Config Info：', this.info);\n    }\n\n    public get container(): HTMLElement {\n        return this._container;\n    }\n\n    public set container(value: HTMLElement) {\n        if (this._container === value) { return; }\n        this._container = value;\n        this.propertyChange('container');\n    }\n\n    public get id(): string {\n        return this._id;\n    }\n\n    public set id(value: string) {\n        if (this._id === value) { return; }\n        this._id = value;\n        this.propertyChange('id');\n    }\n\n    public get src() {\n        return this._src;\n    }\n\n    public set src(value) {\n        if (this._src === value) { return; }\n        this._src = value;\n        this.propertyChange('src');\n    }\n\n    public get play(): boolean {\n        return this._play;\n    }\n\n    public set play(value: boolean) {\n        if (this._play === value) { return; }\n        this._play = value;\n        this.propertyChange('play');\n    }\n\n    public get loop(): boolean {\n        return this._loop;\n    }\n\n    public set loop(value: boolean) {\n        if (this._loop === value) { return; }\n        this._loop = value;\n        this.propertyChange('loop');\n    }\n\n    public get menu(): boolean {\n        return this._menu;\n    }\n\n    public set menu(value: boolean) {\n        if (this._menu === value) { return; }\n        this._menu = value;\n        this.propertyChange('menu');\n    }\n\n    public get scaleMode() {\n        return this._scaleMode;\n    }\n\n    public set scaleMode(value) {\n        if (this._scaleMode === value) { return; }\n        this._scaleMode = value\n        this.propertyChange('scaleMode');\n    }\n\n    public get align(): string {\n        return this._align;\n    }\n\n    public set align(value: string) {\n        if (this._align === value) { return; }\n        this._align = value;\n        this.propertyChange('align');\n    }\n\n    public get wmode(): string {\n        return this._wmode;\n    }\n\n    public set wmode(value: string) {\n        if (this._wmode === value) { return; }\n        this._wmode = value;\n        this.propertyChange('wmode');\n    }\n\n    public get bgcolor() {\n        return this._bgcolor;\n    }\n\n    public set bgcolor(value) {\n        if (this._bgcolor === value) { return; }\n        this._bgcolor = value;\n        this.propertyChange('bgcolor');\n    }\n\n    /**\n     * useNativeAudio : boolean\n     * cdns: string[]\n     */\n    public get vfvars() {\n        return this._vfvars;\n    }\n\n    public set vfvars(value) {\n        // if (_.isEmpty(value)) { return; }\n        // if (_.isEqual(this._vfvars, value)) { return; }\n        if(this._vfvars === value) { return; }\n        this._vfvars = value;\n        this.propertyChange('vfvars');\n    }\n\n    public get plugs() {\n        return this._plugs;\n    }\n    public set plugs(value) {\n        this._plugs = value;\n    }\n\n    public get frameRate(): number {\n        return this._frameRate;\n    }\n\n    public set frameRate(value: number) {\n        if (this._frameRate === value) { return; }\n        this._frameRate = value;\n        this.propertyChange('frameRate');\n    }\n\n    public get width(): number {\n        return this._width;\n    }\n\n    public set width(value: number) {\n        if (this._width === value) { return; }\n        this._width = value;\n        this.propertyChange('width');\n    }\n\n    public get height(): number {\n        return this._height;\n    }\n\n    public set height(value: number) {\n        if (this._height === value) { return; }\n        this._height = value;\n        this.propertyChange('height');\n    }\n\n    public get orientation(): string {\n        return this._orientation;\n    }\n\n    public set orientation(value: string) {\n        if (this._orientation === value) { return; }\n        this._orientation = value;\n        this.propertyChange('orientation');\n    }\n\n    public get maxTouches(): number {\n        return this._maxTouches;\n    }\n\n    public set maxTouches(value: number) {\n        if (this._maxTouches === value) { return; }\n        this._maxTouches = value;\n        this.propertyChange('maxTouches');\n    }\n\n    public get showFPS(): boolean {\n        return this._showFPS;\n    }\n\n    public set showFPS(value: boolean) {\n        if (this._showFPS === value) { return; }\n        this._showFPS = value;\n        this.propertyChange('showFPS');\n    }\n\n    public get showLog(): boolean {\n        return this._showLog;\n    }\n\n    public set showLog(value: boolean) {\n        if (this._showLog === value) { return; }\n        this._showLog = value;\n        this.propertyChange('showLog');\n    }\n\n    public set conversionData(value: string) {\n        if (this._conversionData === value) { return; }\n        this._conversionData = value;\n        this.propertyChange('conversionData');\n    }\n    \n    public get conversionData() {\n        return this._conversionData;\n    }\n\n    public set debug(value: boolean) {\n        if (this._debug === value) { return; }\n        this._debug = value;\n        this.propertyChange('debug');\n    }\n\n    public get debug() {\n        return this._debug;\n    }\n\n    public set logAdvancedTrace(value: boolean) {\n        if (this._logAdvancedTrace === value) { return; }\n        this._logAdvancedTrace = value;\n        this.propertyChange('logAdvancedTrace');\n    }\n\n    public get logAdvancedTrace() {\n        return this._logAdvancedTrace;\n    }\n\n    public get language(): string {\n        return this._language;\n    }\n\n    public set language(value: string) {\n        if (this._language === value) { return; }\n        this._language = value;\n        this.propertyChange('language');\n    }\n\n    public get i18n(): I18N {\n        return this._i18n;\n    }\n\n    public get info(): object {\n        return {\n            container: this.container,\n            id: this.id,\n            src: this.src,\n            play: this.play,\n            loop: this.loop,\n            menu: this.menu,\n            scaleMode: this.scaleMode,\n            align: this.align,\n            wmode: this.wmode,\n            bgcolor: this.bgcolor,\n            vfvars: this.vfvars,\n            plugs: this.plugs,\n            frameRate: this.frameRate,\n            width: this.width,\n            height: this.height,\n            orientation: this.orientation,\n            maxTouches: this.maxTouches,\n            showFPS: this.showFPS,\n            showLog: this.showLog,\n            logAdvancedTrace: this.logAdvancedTrace,\n            conversionData: this.conversionData,\n            debug: this.debug,\n            language: this.language,\n            i18n: this.i18n.info,\n        };\n    }\n}\n","import {EventEmitter} from 'eventemitter3';\nimport IEvent from './IEvent';\nimport IEventObserver from './IEventObserver';\nimport { EventLevel } from './EventLevel';\nimport { EventType } from './EventType';\nimport { VFStateCode } from '../core/model/IVFData';\n\nexport default class StateEvent extends EventEmitter {\n\n    private _observers: IEventObserver[];\n\n    public constructor() {\n        super();\n        this._observers = [];\n    }\n\n    public emit(type: string, event: IEvent): boolean {\n        if (type === undefined) {\n            throw new Error(`emitEvent ==> ${type} is undefined`);\n        }\n        if (event.code === undefined) {\n            throw new Error(`emitEvent ==> ${type} args.code is undefined`);\n        }\n        if (event.level === undefined) {\n            throw new Error(`emitEvent ==> ${type} args.level is undefined`);\n        }\n        const result = super.emit(type, event);\n        return result;\n    }\n\n    /**\n     * 扩展的发送，事件名与数据\n     * @param event 事件名 event = code \n     * @param _data \n     * @param _target \n     */\n    public emitExt(event: string,  _data: any, _target?: any) {\n        this.emit(event, { code: event, level: EventLevel.COMMAND, data: _data, target: _target } );\n    }\n\n    /**\n     * 抛出错误信息\n     * @param errorCode 错误码，指定packages.i18n中的文件\n     * @param data 需要解析的变量\n     */\n    public emitError(errorCode: string, data?: any[], level = EventLevel.ERROR , target?: any) {\n        this.error({code: errorCode, level, data, message: errorCode, target,});\n    }\n\n    public error(msg:IEvent){\n        this.emit(EventType.STATUS, msg);\n    }\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * 国际化\n * - TODO:\n * 1、根据配置/默认载入对应语言数据并初始化\n * 2、外部统一通过i18n实例接口 通过 key 取信息, 支持批量取\n * 3、支持语言切换\n * @author 8088\n */\nimport BaseInfo from './BaseInfo';\nimport { readFileSyncExt } from '../utils/readFileSync';\nimport IEvent from '../event/IEvent';\nimport { VFStateCode } from './model/IVFData';\nimport { stringFormat } from '../utils/VFUtil';\nexport default class I18N extends BaseInfo {\n    private readonly lang: string = '';\n\n    private _data: any;\n\n    private _readyState: VFStateCode = VFStateCode.INIT;\n\n    constructor(language: string) {\n        super();\n        this.lang = language.toLocaleLowerCase();\n        if (this.lang.indexOf('en') !== -1) {\n            this.lang = 'en-us';\n        }\n        else {\n            this.lang = 'zh-cn';\n        }\n    }\n\n    public get readyState(): VFStateCode {\n        return this._readyState;\n    }\n    public set readyState(value) {\n        this._readyState = value;\n    }\n\n    public get info(): object {\n        return ['zh-CN', 'en-US'];\n    }\n\n    public t(key: string, param?: string[]): string {\n        const data = this._data;\n\n        if (data && data[key]) {\n            return stringFormat(data[key].message.toString(), param);\n        }\n\n        return `This message code[${key}] is not defined. \\n JSON = ${JSON.stringify(param)}`;\n    }\n\n    public async load(cdns: string[], onError: (err: any) => void): Promise<boolean> {\n        if (this.lang && this._readyState !== VFStateCode.READY) {\n            let url = '';\n\n            if (process.env.NODE_ENV === 'production') {\n                url = `vf/engine/i18n/${this.lang}.json?v=2`;\n            }\n            else {\n                url = `packages/i18n/${this.lang}.json`;\n            }\n            this._data = await readFileSyncExt(url, cdns, { responseType: 'json' }).catch((value: IEvent) => {\n                onError(value);\n            });\n            if (this._data) {\n                this._readyState = VFStateCode.READY;\n\n                return true;\n            }\n        }\n\n        return false;\n    }\n}\n","/**\n * 承载VF的（运行）系统环境\n *\n * @author 8088\n */\nimport BaseInfo from \"./BaseInfo\";\nexport default class System extends BaseInfo {\n\n    private _pageUrl: string = '';\n\n    private _pageReferrer: string = '';\n\n    private _language: string = '';\n\n    private _resolution: string = '';\n\n    private _ua: string = '';\n\n    private _device: any = {};\n\n    private _os: any = {};\n\n    private _browser: any = {};\n\n    private static instance: System;\n\n    constructor(lock?: ConstructorLock) {\n        super();\n        if (lock !== ConstructorLock)\n        {\n            throw new SyntaxError(\"禁止实例化 System !\");\n        }\n        this.initialize();\n    }\n\n    public static getInstance(): System\n    {\n        if (!System.instance) {\n            System.instance = new System(ConstructorLock);\n        }\n        return System.instance;\n    }\n\n    /**\n     * userAgent\n     * @returns {string}\n     */\n    public get ua(): string{\n        return this._ua;\n    }\n\n    /**\n     * 设备\n     * @returns {Object}\n     */\n    public get device(): object{\n        return this._device;\n    }\n\n    /**\n     * 系统\n     * @returns {Object}\n     */\n    public get os(): object{\n        return this._os;\n    }\n\n    /**\n     * 浏览器\n     * @returns {Object}\n     */\n    public get browser(): object{\n        return this._browser;\n    }\n\n    /**\n     * 承载VF的页面地址\n     * @returns {string}\n     */\n    public get pageUrl(): string\n    {\n        return this._pageUrl;\n    }\n\n    public set pageUrl(value: string)\n    {\n        if (value && this._pageUrl != value)\n        {\n            this._pageUrl = decodeURIComponent(value);\n\n            this.propertyChange('pageUrl');\n        }\n    }\n\n    /**\n     * 载入当前页面的URL\n     * @returns {string}\n     */\n    public get pageReferrer(): string\n    {\n        return this._pageReferrer;\n    }\n\n    public set pageReferrer(value: string)\n    {\n        if (value && this._pageReferrer != value)\n        {\n            this._pageReferrer = decodeURIComponent(value);\n\n            this.propertyChange('pageReferrer');\n        }\n    }\n\n    /**\n     * 获取屏幕分辨率\n     * @returns {string}\n     */\n    public get resolution(): string\n    {\n        return this._resolution;\n    }\n\n    /**\n     * 获取系统语言\n     * @returns {string}\n     */\n    public get language(): string{\n        return this._language;\n    }\n\n    public get info(): object {\n        return {\n            pageUrl: this.pageUrl,\n            pageReferrer: this.pageReferrer,\n            language: this.language,\n            resolution: this.resolution,\n            ua: this.ua,\n            device: this.device,\n            os: this.os,\n            browser: this.browser,\n        };\n    }\n\n\n    // Internals..\n    //\n\n    private initialize() {\n        if(screen) {\n            this._resolution = screen.width + 'x' + screen.height;\n        }\n        if(navigator) {\n            this._ua = navigator.userAgent;\n            this._language = navigator.language;\n        }\n        if(this._ua) {\n            this.checkDevice();\n            this.checkBrowser();\n        }\n        this.pageUrl = document.location.href;\n        this.pageReferrer = document.referrer;\n\n        this.output('System Environment：', this.info);\n    }\n\n    private checkDevice(){\n        this._os.name = navigator.platform;\n        if (this._ua.match('Unix')) this._os.name = 'Unix';\n        if (this._ua.match('Linux')) this._os.name = 'Linux';\n        let match;\n        // Apple\n        if (this._ua.match('iPhone( Simulator)?;') || this._ua.match('iPad;') || this._ua.match('iPod;') || this._ua.match(/iPhone\\s*\\d*s?[cp]?;/i)) {\n            this._os.name = 'iOS';\n            if (match = /OS (.*) like Mac OS X/.exec(this._ua)) {\n                this._os.version = match[1].replace(/_/g, '.');\n            }\n            if (this._ua.match('iPhone Simulator;')) {\n                this._device.name = 'iPhone';\n                this._device.type = 'emulator';\n            } else if (this._ua.match('iPod;')) {\n                this._device.name = 'iPod Touch';\n                this._device.type = 'media';\n            } else if (this._ua.match('iPhone;') || this._ua.match(/iPhone\\s*\\d*s?[cp]?;/i)) {\n                this._device.name = 'iPhone';\n                this._device.type = 'mobile';\n            } else {\n                this._device.name = 'iPad';\n                this._device.type = 'tablet';\n            }\n        }\n        else if (this._ua.match('Mac OS X')) {\n            this._os.name = 'Mac OS X';\n            if (match = /Mac OS X (10[0-9\\._]*)/.exec(this._ua)) {\n                this._os.version = match[1].replace(/_/g, '.');\n            }\n            this._device.name = 'Apple Computer';\n            this._device.type = 'pc';\n        }\n        // Microsoft\n        if (this._ua.match('Windows')) {\n            this._os.name = 'Windows';\n            if (match = /Windows NT ([0-9]\\.[0-9])/.exec(this._ua)) {\n                this._os.version = match[1];\n                switch (match[1]) {\n                    case '6.2':\n                        this._os.version = '8';\n                        break;\n                    case '6.1':\n                        this._os.version = '7';\n                        break;\n                    case '6.0':\n                        this._os.version = 'Vista';\n                        break;\n                    case '5.2':\n                        this._os.version = 'Server 2003';\n                        break;\n                    case '5.1':\n                        this._os.version = 'XP';\n                        break;\n                    case '5.0':\n                        this._os.version = '2000';\n                        break;\n                    default:\n                        this._os.version = 'NT ' + this._os.version;\n                }\n            }\n            this._device.name = 'Windows Computer';\n            this._device.type = 'pc';\n            if (this._ua.match('WindowsMobile') || this._ua.match('Windows Phone')) {\n                this._device.name = 'Windows Phone';\n                this._device.type = 'mobile';\n                this._os.name = 'Windows Mobile';\n                this._os.version = 'x';\n            }\n            //...\n        }\n        // Google\n        if (this._ua.match('Android')) {\n            this._os.name = 'Android';\n            if (match = /Android(?: )?(?:AllPhone_|CyanogenMod_)?(?:\\/)?v?([0-9.]+)/.exec(this._ua.replace('-update', '.'))) {\n                this._os.version = match[1];\n            }\n            this._device.name = 'Android Device';\n            this._device.type = 'mobile';\n            if (this._os.version >= 3) this._device.type = 'tablet';\n            if (this._os.version >= 4 && this._ua.match('Mobile')) this._device.type = 'mobile';\n            //...\n        }\n        // ..ignore others..\n    }\n\n    private checkBrowser(){\n        let match;\n        if (match = /WebKit\\/([0-9.]*)/i.exec(this._ua)) {\n            this._browser.name = 'Webkit';\n            this._browser.version = match[1];\n        }\n\n        if (match = /Browser\\/AppleWebKit([0-9.]*)/i.exec(this._ua)) {\n            this._browser.name = 'Webkit';\n            this._browser.version = match[1];\n        }\n        if (this._ua.match('Safari')) {\n            this._browser.name = 'Safari';\n            if (match = /Version\\/([0-9\\.]+)/.exec(this._ua)) {\n                this._browser.version = match[1];\n            }\n        }\n        if (this._ua.match('MSIE')) {\n            this._browser.name = 'Internet Explorer';\n            if (match = /MSIE ([0-9.]*)/.exec(this._ua)) {\n                this._browser.version = match[1];\n            }\n        }\n        if (this._ua.match('Edge')) {\n            this._browser.name = 'Edge';\n            this._browser.version = 'x';\n        }\n        if (this._ua.match(/Opera/i)) {\n            this._browser.name = 'Opera';\n            if (match = /Opera[\\/| ]([0-9.]*)/.exec(this._ua)) {\n                this._browser.version = match[1];\n            }\n        }\n        if (this._ua.match('Firefox')) {\n            this._browser.name = 'Firefox';\n            if (match = /Firefox\\/([0-9ab.]*)/.exec(this._ua)) {\n                this._browser.version = match[1];\n            }\n        }\n        if (match = /(?:Chrome|CrMo|CriOS)\\/([0-9.]*)/.exec(this._ua)) {\n            this._browser.name = 'Chrome';\n            this._browser.version = match[1];\n        }\n        if (this._ua.match('Chromium')) {\n            this._browser.name = 'Chromium';\n            if (match = /Chromium\\/([0-9.]*)/.exec(this._ua)) {\n                this._browser.version = match[1];\n            }\n        }\n        if (this._ua.match('UCWEB')) {\n            this._browser.name = 'UC';\n            if (match = /UCWEB([0-9]*[.][0-9]*)/.exec(this._ua)) {\n                this._browser.version = match[1];\n            }\n        }\n        if (match = /UCBrowser\\/([0-9.]*)/.exec(this._ua)) {\n            this._browser.name = 'UC';\n            this._browser.version = match[1];\n        }\n        if (match = /(M?QQBrowser)\\/([0-9.]*)/.exec(this._ua)) {\n            this._browser.name = 'QQ';\n            let version = match[2];\n            if (version.match(/^[0-9][0-9]$/)) version = version[0] + '.' + version[1];\n            this._browser.version = version;\n            /*if (!this._os.name && match[1] === 'QQBrowser') {\n                this._os.name = 'Windows';\n            }*/\n        }\n        // ..ignore others..\n    }\n}\nclass ConstructorLock {};\n","import Config from '../core/Config';\nimport {EventType} from '../event/EventType';\n/**\n * 显示错误信息\n * TODO:\n *  1、仅处理影响运行/使用的Error。\n *  2、支持国际化显示Error信息。\n *  3、可配置不使用内置Error，外部可根据API抛出的异常自定义显示Error信息。\n */\nexport default class ErrorDisplay {\n    private _config: Config;\n    private _errPanel: HTMLElement;\n    private _showCode: string;\n    constructor(config:Config){\n        this._config = config;\n        this._showCode = '';\n        this._errPanel = document.createElement(\"div\");\n        this._errPanel.style.background = 'rgba(0,0,0,0.8)';\n        this._errPanel.style.position = 'absolute';\n        this._errPanel.style.width = '100%';\n        this._errPanel.style.height = '100%';\n        this._errPanel.style.zIndex = '8088';\n        this._errPanel.style.display = 'none';\n        let _span = document.createElement(\"span\");\n        _span.style.display = 'table-cell';\n        _span.style.verticalAlign = 'middle';\n        _span.style.textAlign = 'center';\n        _span.style.color = '#eee';\n        this._errPanel.appendChild(_span);\n        this._config.container.appendChild(this._errPanel);\n        this._config.i18n.addListener(EventType.STATE, this.onChange, this);\n    }\n\n    public setMessage(code: string, data?: string[]): void {\n        // mark: need check code is supported\n        if(code) {\n            this._showCode = code;\n            this._errPanel.style.display = 'table';\n            let _span = this._errPanel.children[0];\n            if(_span.hasChildNodes()){\n                _span.removeChild(_span.childNodes[0]);\n            }\n            let _text = document.createTextNode(this.getText(code, data));\n            _span.appendChild(_text);\n        }\n    }\n\n    public getText(code: string, data?: string[]) {\n        \n        return this._config.i18n.t(code,data) + ' #' + code;\n    }\n\n    public close() {\n        this._showCode = '';\n        this._errPanel.style.display = 'none';\n    }\n\n\n    private onChange(evt: any) {\n        if(this._showCode && evt.code === 'I18N.Property.Changed') {\n            this.setMessage(this._showCode);\n        }\n    }\n}"],"sourceRoot":""}